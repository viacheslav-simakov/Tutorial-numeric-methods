%\input{../../../preamble}
%\begin{document}
% **************************************************
%
%	НЕОДНОРОДНЫЙ СТЕРЖЕНЬ
%
% **************************************************
\begin{figure}
\begin{center}
%\setlength{\tabcolsep}{12pt}
\begin{tabular}{c c}
%
%	ОДНОРОДНЫЙ ТЕПЛООБМЕН
%
\begin{tikzpicture}[framed]
\pgfplotsset{set layers=standard}
\def\xbreak{4}
\def\ka{5.5}
\def\kb{7.5}
\def\ra{2}
\def\rb{4}
% последовательность графических слоев
\pgfsetlayers{background,axis grid,main,axis ticks, axis lines, axis tick labels,axis descriptions,axis foreground}
\begin{pgfonlayer}{main}
\begin{axis}
[	width=7cm,
	my graph style,
	const plot,
	axis y line*=left,
	xlabel = {$x$},		% подпись оси x
	ylabel = {$k(x)$},	% подпись оси y
	xmin=-1, xmax=10, xtick={0,\xbreak,9}, xticklabels={0,$c$,$\ell$},
	ymin=-1, ymax=10, ytick={\ka,\kb}, yticklabels={\empty},
	\axisYcolor{blue}
	% определение новой функции
	declare function={ myfunc(\x,\a)=\a; },
]
\addplot[draw=none,fill=blue!5] coordinates {(0,\ka) (\xbreak,\ka) (\xbreak,\kb) (9,\kb)}\closedcycle;
\draw[very thick,draw=blue] (axis cs: 0,\ka) -- (axis cs: \xbreak,\ka) node[midway,above,blue] {$k_1$};
\draw[very thick,draw=blue] (axis cs: \xbreak,\kb) -- (axis cs: 9,\kb) node[midway,above,blue] {$k_2$};
\end{axis}
\begin{axis}
[	width=7cm,
	my graph style,
	const plot,
	axis y line*=right,
	ylabel = {$r(x)$},	% подпись оси y
	axis x line=none,
	xmin=-1, xmax=10, xtick={\empty},
	ymin=-1, ymax=10, ytick={\ra,\rb}, yticklabels={\empty},
	\axisYcolor{red}
]
\addplot[draw=none,fill=orange!20] coordinates {(0,\ra) (\xbreak,\ra) (\xbreak,\rb) (9,\rb)}\closedcycle;
\draw[very thick,draw=red] (axis cs: 0,\ra) -- (axis cs: \xbreak,\ra) node[midway,above,red] {$r_1$};
\draw[very thick,draw=red] (axis cs: \xbreak,\rb) -- (axis cs: 9,\rb) node[midway,above,red] {$r_2$};
\end{axis}
\end{pgfonlayer}{main}
\end{tikzpicture}
&
%
%	ТЕПЛОИЗОЛИРОВАННАЯ КОНТАКТНАЯ ОБЛАСТЬ
%
\begin{tikzpicture}[framed]
\pgfplotsset{set layers=standard}
\def\xa{3}
\def\xc{5}
\def\xb{7}
\def\ka{5.5}
\def\kb{7.5}
\def\ra{2}
\def\rb{4}
% последовательность графических слоев
\pgfsetlayers{background,axis grid,main,axis ticks, axis lines, axis tick labels,axis descriptions,axis foreground}
\begin{pgfonlayer}{main}
\begin{axis}
[	width=7cm,
	my graph style,
	const plot,
	axis y line*=left,
	xlabel = {$x$},		% подпись оси x
	ylabel = {$k(x)$},	% подпись оси y
	xmin=-1, xmax=10, xtick={0,\xa,\xc,\xb,9}, xticklabels={0,$a$,$c$,$b$,$\ell$},
	ymin=-1, ymax=10, ytick={\ka,\kb}, yticklabels={\empty},
	\axisYcolor{blue}
	% определение новой функции
	declare function={ myfunc(\x,\a)=\a; },
]
\addplot[draw=none,fill=blue!5] coordinates {(0,\ka) (\xc,\ka) (\xc,\kb) (9,\kb)}\closedcycle;
\draw[very thick,draw=blue] (axis cs: 0,\ka) -- (axis cs: \xc,\ka) node[midway,above,blue] {$k_1$};
\draw[very thick,draw=blue] (axis cs: \xc,\kb) -- (axis cs: 9,\kb) node[midway,above,blue] {$k_2$};
\end{axis}
\begin{axis}
[	width=7cm,
	my graph style,
	const plot,
	axis y line*=right,
	ylabel = {$r(x)$},	% подпись оси y
	axis x line=none,
	xmin=-1, xmax=10, xtick={\empty},
	ymin=-1, ymax=10, ytick={\ra,\rb}, yticklabels={\empty},
	\axisYcolor{red}
]
\addplot[draw=none,fill=orange!20] coordinates {
(0,\ra) (\xa,\ra) (\xa,0) (\xb,0) (\xb,\rb) (9,\rb)
}\closedcycle;
\draw[very thick,draw=red] (axis cs: 0,\ra) -- (axis cs: \xa,\ra) node[midway,above,red] {$r_1$};
\draw[very thick,draw=red] (axis cs: \xb,\rb) -- (axis cs: 9,\rb) node[midway,above,red] {$r_2$};
\draw[very thick,draw=red] (axis cs: \xa,0) -- (axis cs: \xb,0) node[midway,above,red] {$r\equiv0$};
\end{axis}
\end{pgfonlayer}{main}
\end{tikzpicture}
\\
a)&b)\\
\end{tabular}
\caption{
Примеры краевых задач с разрывными коэффициентами $k(x)$ и $r(x)$
дифференциального уравнения установившегося распределения температуры 
в неоднородном стержне длиной $\ell$:\\
(a) -- свободный теплообмен стержня с окружающей средой;\\
(b) -- теплоизолированный участок боковой поверхности стержня
}
\label{fig:ODE_BC(hetero_material)}
\end{center}
\end{figure}
% ******* end figure *******
%\end{document}
