%\input{../../../preamble}
%\begin{document}

% ********************************************
%
%	√рафик сетки
%
% ********************************************
\begin{figure}
\begin{center}
\begin{tikzpicture}[framed]
\def\ymax{10}
\def\dy{\ymax/2}
\def\dx{0.2}
\def\xs{-9.5}
\def\xss{-7}
\def\xxs{(\xs+\xss)/2}
\def\xa{-4}
\def\xb{-1}
\def\xc{3}
\def\xxab{(\xa+\xb)/2}
\def\xxbc{(\xb+\xc)/2}
\def\xee{6}
\def\xe{9}
\def\xxe{(\xe+\xee)/2}
% точки разрыва оси OX
\def\xsbreak{\xss+1.3}
\def\xxssbreak{\xsbreak+\dx}
\def\xxeebreak{\xee-1.5}
\def\xebreak{\xxeebreak+\dx}
\begin{axis}
[	width=18cm, height=7cm,
	axis lines = none,
	xmin=-10, xmax=10,
	ymin=-\ymax, ymax=\ymax,
]
% узлы сетки
\addplot [
	only marks, mark=*, mark size=4pt, mark options={fill=lime,draw=black,solid,thick},
	nodes near coords,
	point meta=explicit symbolic,
	node near coord style={below,yshift=-1ex},
]
coordinates {
(\xs,0) [$0$] (\xss,0) [$x_1$]
(\xa,0) [$x_{i-1}$] (\xb,0) [$x_{i}$] (\xc,0) [$x_{i+1}$]
(\xee,0) [$x_{N-1}$] (\xe,0) [$\ell$]
};
% вспомогательные узлы
\addplot [
	only marks, mark=otimes*, mark size=3pt, mark options={fill=white,draw=red,solid},
	nodes near coords,	
	point meta=explicit symbolic,
	node near coord style={above,yshift=0.5ex,color=red},
]
coordinates { 
(\xxs,0) [$x_{\onehalf}$] 
(\xxab,0) [$x_{i-\onehalf}$] (\xxbc,0) [$x_{i+\onehalf}$] 
(\xxe,0) [$x_{N-\onehalf}$]
};
% шаг сетки
% i=0
\addplot[const plot,fill=black!5,draw=black!50,
	nodes near coords,	 point meta=explicit symbolic,
	node near coord style={above,color=black},
] 
coordinates { 
(\xs,0) (\xs,\dy) ((\xs+\xss)/2,\dy) [$h_{1}$] (\xss,\dy) (\xss,0)
}\closedcycle;
% i
\addplot[const plot,fill=black!5,draw=black!50,
	nodes near coords,	 point meta=explicit symbolic,
	node near coord style={above,color=black},
] 
coordinates { 
(\xa,0) (\xa,\dy) ((\xa+\xb)/2,\dy) [$h_i$] (\xb,\dy) (\xb,0)
}\closedcycle;
% i+1
\addplot[const plot,fill=black!10,draw=black!50,
	nodes near coords,	 point meta=explicit symbolic,
	node near coord style={above,color=black},
] 
coordinates { 
(\xb,0) (\xb,\dy) ((\xb+\xc)/2,\dy) [$h_{i+1}$] (\xc,\dy) (\xc,0)
}\closedcycle;
% i=N
\addplot[const plot,fill=black!5,draw=black!50,
	nodes near coords,	 point meta=explicit symbolic,
	node near coord style={above,color=black},
] 
coordinates { 
(\xee,0) (\xee,\dy) ((\xee+\xe)/2,\dy) [$h_{N}$] (\xe,\dy) (\xe,0)
}\closedcycle;
% шаг вспомогательной сетки
\addplot[const plot,fill=red!5,draw=red!50,
	nodes near coords,	 point meta=explicit symbolic,
	node near coord style={below,color=red},
] 
coordinates { 
(\xxab,0) (\xxab,-\dy) ((\xxab+\xxbc)/2,-\dy) [$\overline{h}_{i}$] (\xxbc,-\dy) (\xxbc,0)
}\closedcycle;
% ось OX
\addplot[->,thick,black,
	nodes near coords,
	point meta=explicit symbolic,
	node near coord style={below,yshift=-1ex},
]
coordinates {(\xebreak,0) (10,0) [$x$]};
\addplot[thick,black] coordinates {(\xs,0) (\xsbreak,0)};
\addplot[thick,black] coordinates {(\xxssbreak,0) (\xxeebreak,0)};
% разрыв оси OX
\addplot[thick,black,domain={\xsbreak-0.5*\dx}:{\xsbreak+0.5*\dx},samples=2]
{-7*(\xsbreak-\x)};
\addplot[thick,black,domain={\xxssbreak-0.5*\dx}:{\xxssbreak+0.5*\dx},samples=2]
{-7*(\xxssbreak-\x)};
% разрыв оси OX
\addplot[thick,black,domain={\xxeebreak-0.5*\dx}:{\xxeebreak+0.5*\dx},samples=2]
{-7*(\xxeebreak-\x)};
\addplot[thick,black,domain={\xebreak-0.5*\dx}:{\xebreak+0.5*\dx},samples=2]
{-7*(\xebreak-\x)};
\end{axis}
\end{tikzpicture}
\caption{—хематическое изображение узлов расчетной сетки}
\label{fig:ODE_BC(mesh)}
\end{center}
\end{figure}
% ********************************************

%\end{document}
