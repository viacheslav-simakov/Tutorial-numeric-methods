\pgfdeclarelayer{pre main}
\pgfdeclarelayer{background}
\pgfdeclarelayer{foreground}
\pgfsetlayers{background,pre main,main,foreground} 
% Декорация линий
\tikzset{
	% стрелки
	FARROW/.style={
%		line width=3mm, 
%		arrows={-Latex[angle=40:2.5mm]}
		arrows={-Straight Barb[angle=45:1.5mm 1]	},
		shorten >= 0pt,
	},
	% декорация линий
	curve line/.style={
		decoration={
			snake,
			amplitude=1.5mm,%0.75mm,
			segment length=7.5mm,
			post length=0mm,
			pre length=0mm,
		},
	},
	pointnode/.style={
		join=by -,
		circle,
		fill=red,
		minimum size=3pt,
		inner sep=0pt,
	},
	circlenode/.style={
		draw,thick,fill=blue!10,line width=0.25mm,
		shape=circle,
		inner sep=4pt,
	},
	rectnode/.style={
		draw,line width=0.25mm,
		shape=rectangle,
%		rounded corners=2pt, 
		inner sep=8pt,
	},
	rrectnode/.style={
		draw,line width=0.25mm,
		shape=rounded rectangle,
%		rounded corners=2pt, 
		inner sep=8pt,
	},
	datanode/.style={
		draw,line width=0.25mm,
		shape=	trapezium,
		trapezium left angle=70,
		trapezium right angle=110, 
		text centered,
		inner sep=8pt,
	},
	ifthenelsenode/.style={
		draw,line width=0.25mm,
		shape=diamond,
		aspect=2,
%		trapezium left angle=70,
%		trapezium right angle=110, 
		text centered,
		inner sep=4pt,
	},
	startloopnode/.style={
		draw,text width=4cm,align=center,line width=0.25mm,
		shape=chamfered rectangle,
		chamfered rectangle corners={north west,north east},
		minimum height=3em,minimum width=5cm,
	},
	endloopnode/.style={
		draw,text width=4cm,align=center,line width=0.25mm,
		shape=chamfered rectangle,
		chamfered rectangle corners={south west,south east},
		minimum height=3em,minimum width=5cm,
	},
	signalnode/.style={
		draw,line width=0.25mm,
		shape=chamfered rectangle,
		chamfered rectangle angle=45,
		chamfered rectangle xsep=1cm,
		inner sep=8pt,
	},
}

\newpage

\section{Методы локальной оптимизации}

Оптимизация -- это задача нахождения экстремума 
(минимума или максимума) целевой функции в некоторой области 
конечномерного векторного пространства, ограниченной 
набором линейных и/или нелинейных равенств и/или неравенств.

Во многих практически важных случаях для целевой функции 
многих переменных $f(\vect{x})$ 
задача оптимизации может быть сформулирована в виде:
\begin{gather*}
f(\vect{x})\to\min,
\end{gather*}
где $\vect{x}=(x_1,x_2,\ldots,x_n)$ --
вектор неизвестных (управляющих параметров);\linebreak
$\min$ -- минимальное значение функции в ограниченной 
или неограниченной области изменения неизвестных.

Для нахождения абсолютного минимума целевой функции $f(\vect{x})$
существует только один способ: 
найти все локальные минимумы этой функции, 
сравнить их и выбрать из них тот,
в котором функция принимает наименьшее значение.

% Минимум функции одного переменного 
% http://www.machinelearning.ru/wiki/index.php?title=%D0%9C%D0%B5%D1%82%D0%BE%D0%B4_%D0%B7%D0%BE%D0%BB%D0%BE%D1%82%D0%BE%D0%B3%D0%BE_%D1%81%D0%B5%D1%87%D0%B5%D0%BD%D0%B8%D1%8F._%D0%A1%D0%B8%D0%BC%D0%BC%D0%B5%D1%82%D1%80%D0%B8%D1%87%D0%BD%D1%8B%D0%B5_%D0%BC%D0%B5%D1%82%D0%BE%D0%B4%D1%8B
\emptyline
\subsection{Минимум функции одного переменного}
Для функции одной переменной $f(x)$, задача нахождения минимума
эквивалента задачи нахождения корней уравнения:
\begin{equation}\label{eq:GD:f(x)=min}
\diff{f(x)}{x}=0
\end{equation}

Эта одномерная задача нередко возникает в практических 
приложениях. Кроме того, большинство методов решения 
многомерных задач сводится к поиску одномерного минимума. 

Предположим, что $f(x)$ задана и кусочно-непрерывна на отрезке 
$x\in[a,b]$, и имеет на этом отрезке (включая его концы) 
только один локальный минимум. 
Построим итерационный процесс, сходящийся к этому минимуму. 

Вычислим значение функции на концах отрезка $x=a$ и $x=b$, 
а также в двух внутренних точках $x_1<x_2$.
Так так функция $f(x)$ имеет минимум на отрезке $x\in[a,b]$, 
то справедливо утверждение:
\begin{equation*}
f(a)\geqslant f(x_1),\quad f(x_2)\leqslant f(b)
\end{equation*}

Сравним все четыре значения функции между собой 
$f(a)$, $f(x_1)$, $f(x_2)$ и $f(b)$ и выберем среди них наименьшее.

%
%	График функций
%
\begin{figure}[H]\centering
\begin{tikzpicture}
\begin{axis}
[
xlabel={\empty},	% подпись оси x
ylabel={$f(x)$},	% подпись оси y
enlargelimits=true,
xmin=0, xmax=3, xtick={0,0.75,2.25,3}, xticklabels={$a$,$x_1$,$x_2$,$b$},
ymin=0, ymax=2, ytick={1,{0.25^2},{1+ln(2.25-0.75)},{1+ln(3-0.75)}}, yticklabels={},
%ytick={\empty}
]
\path[name path=O] (axis cs:0,0) -- (axis cs:2.25,0);
% функция f(x)
\addplot[name path=A1,thick,color=darkred,domain=0:1.5, samples=50] {(x-1)^2};
\addplot[name path=A2,thick,color=darkred,domain=1.5:3, samples=50] {1+ln(x-0.75)};
% область
\addplot [orange!15] fill between [of=A1 and O, soft clip={domain=0:1.5}];
\addplot [orange!15] fill between [of=A2 and O, soft clip={domain=1.5:2.25}];
% маркеры
\addplot[only marks,ball darkred] coordinates{(0,1)}
node[above]{$f(a)$};
\addplot[only marks,ball darkred] coordinates{(3,{1+ln(3-0.75)})}
node[above]{$f(b)$};
\addplot[only marks,ball darkblue] coordinates{(0.75,{0.25^2})}
node[above right]{$f(x_1)$};
\addplot[only marks,ball darkblue] coordinates{(2.25,{1+ln(2.25-0.75)})}
node[below right]{$f(x_2)$};
\end{axis}
\end{tikzpicture}
\caption{График кусочно-непрерывной функции $y=f(x)$,\linebreak
имеющей минимум на отрезке $x\in[a,b]$}
\label{fig:GD:f(x)=min}
\end{figure}

Из рисунка \ref{fig:GD:f(x)=min} видно, что наименьшее значение
функция достигает в точке $x=x_1$:
\begin{equation*}
f(x_1)<f(a)<f(x_2)<f(b)
\end{equation*}

Очевидно, что минимум функции $f(x)$ расположен в одном 
из прилегающих к точке $x=x_1$ отрезков, то есть минимум 
находится либо в пределах отрезка $[a,x_1]$, либо в $[x_1,x_2]$
(рисунок \ref{fig:GD:f(x)=min}, выделенная область).

Поэтому на первом шаге итерационного процесса 
отбрасывается отрезок $[x_2,b]$, и для поиска 
минимума функции $f(x)$ рассматривается отрезок $[a,x_2]$,
при этом область поиска минимума функции сужается:
\begin{equation*}
\abs{a-x_2}<\abs{a-b},\quad\text{так как}\quad x_2<b.
\end{equation*} 

Полагая $b=x_2$, на новом отрезке $[a, b]$ вновь необходимо 
выбрать две внутренние точки, вычислить в них и 
на концах отрезка значения функции $f(x)$, 
и сделать следующий шаг итерационного процесса.

Критерием остановки итерационного процесса является условие выполнения
неравенства, которое гарантирует малость размера области поиска
минимума по сравнению с заранее заданной погрешность метода:
\begin{equation*}
(b-a)\leqslant\epsilon,
\end{equation*}
где $\epsilon$ -- погрешность метода.

\emph{Симметричный метод} поиска минимума функции 
одной переменной $f(x)$ основан на выборе внутренних точек 
$x_1$ и $x_2$ отрезка $[a,b]$, 
которые равноудалены от концов этого отрезка.
Например, если точки $x_1$ и $x_2$ делят отрезок $[a,b]$
на три равные части (рисунок \ref{fig:GD:ab}), 
то координаты этих точек могут быть 
определены из соотношений:
\begin{equation*}
x_1=a+\dfrac{b-a}{3}=\dfrac{2a+b}{3},
\quad
x_2=b-\dfrac{b-a}{3}=\dfrac{a+2b}{3}.
\end{equation*}

\begin{figure}[H]\centering
\begin{tikzpicture}
[>={Straight Barb[angle=45:2mm 1]},shorten >=1pt,font=\small]% стрелка
% начало отсчета
\coordinate (O) at (0mm,0mm);
% ось OX
\draw[->,line width=0.25mm] ([xshift=-20mm]O) -- (80mm,0mm)
node[pos=1,yshift=-1em]{$x$};
% сетка
\coordinate (p) at (O);
\foreach \x [count=\n from 0] in {0,20,20,20}{
\path (p) -- ++(\x mm,0mm) coordinate(p);
\draw[fill=black] (p) circle[radius=0.8mm] coordinate(p\n);
}
% подписи
\draw (p0) node[above]{$a$};
\draw (p1) node[above]{$x_1$};
\draw (p2) node[above]{$x_2$};
\draw (p3) node[above]{$b$};
% штриховка
\begin{scope}[on background layer]
\pattern[pattern=north east lines,pattern color=gray,opacity=0.75]
(p0) -- ([yshift=-2mm]p0) -- ([yshift=-2mm]p3) -- (p3) -- cycle;
\end{scope}
\end{tikzpicture}
\caption{Схематическое изображение точек деления отрезка $[a,b]$}
\label{fig:GD:ab}
\end{figure}

Оценка длины отрезка после первого итерационного шага составит:
\begin{equation*}
\ell_1=(b-a) - \dfrac{b-a}{3}=\dfrac{2}{3}\cdot(b-a),
\end{equation*}
после второго шага:
\begin{equation*}
\ell_2=\ell_1-\dfrac{\ell_1}{3}=\dfrac{2}{3}\cdot\ell_1=
\left(\dfrac{2}{3}\right)^2\cdot(b-a),
\end{equation*}
а после $k$-ого итерационного шага:
\begin{equation*}
\ell_k=\left(\dfrac{2}{3}\right)^k\cdot(b-a).
\end{equation*}

Таким образом, чтобы погрешность вычисления 
$\ell_k$ была менее $\epsilon$, для числа итераций $k$ 
справедлива оценка:
\begin{equation*}
\left(\dfrac{2}{3}\right)^k\cdot(b-a)\leqslant\epsilon
\quad\to\quad
k=\left\lceil\dfrac{\ln(b-a)-\ln(\epsilon)}{\ln(3)-\ln(2)}\right\rceil
\end{equation*}

Симметричный метод поиска минимума функции является 
аналогом метода дихотомии для нахождения корня уравнения $f(x)=0$. 
Метод применим к недифференцируемым функциям и всегда 
сходится. 
Следует отметить, что если на отрезке $[a,b]$
функция $f(x)$ имеет несколько локальных минимумов, 
то итерационный процесс сойдется к одному из этих минимумов, 
но не обязательно к наименьшему. 

% *** Алгоритм поиска минимума функции одной переменной
% https://tex.stackexchange.com/questions/370704/drawing-a-scheme
\begin{figure}[H]\centering
\begin{tikzpicture}[
font=\small,
start chain=going below,node distance=10mm,every join/.style=->,%
>={Straight Barb[angle=45:1.5mm 1]},shorten >=0.5pt,%
]
% соединитель
\node[rrectnode,on chain,join]{старт};
% данные
\node[datanode,on chain,join]
{$a, b, \epsilon$};
% x1, x2
\node[rectnode,on chain,join](x1x2)
{$x_1=\dfrac{2a+b}{3},\;x_2=\dfrac{a+2b}{3}$};
% f(x1) < f(x2)
\node[ifthenelsenode,on chain,join](compare)
{$f(x_1)>f(x_2)$};
% да
\begin{scope}[start branch=a,node distance=15mm]
\node[rectnode,on chain=going left,join](a)
{$a=x_1$};
\draw(compare.west) node[above left]{да};
\end{scope}
% нет
\begin{scope}[start branch=b,node distance=15mm]
\node[rectnode,on chain=going right,join](b)
{$b=x_2$};
\draw(compare.east) node[above right]{нет};
\end{scope}
% ошибка
\node[rectnode,on chain](error)
{$\Delta=b-a$};
% связи
\draw[->] (a.south) |- (error.west);
\draw[->] (b.south) |- (error.east);
% выход?
\node[ifthenelsenode,on chain,join](exit)
{$\Delta<\epsilon$};
\draw (exit.east) node[above right]{нет};
\draw[->,thick] (exit.east) -- ([xshift=5cm]exit.east) |- (x1x2.east);
% соединитель
\draw (exit.south) node[below left]{да};
\begin{scope}[node distance=12mm]
\node[rrectnode,on chain,join]{стоп};
\end{scope}
\end{tikzpicture}
% *******************************************
\caption{Блок-схема алгоритма нахождения минимума\linebreak 
функции $f(x)$ одного переменного}
\label{fig:GD:scheme f(x)->min}
\end{figure}

%
% Минимум функции многих переменных
%
\emptyline
\subsection{Минимизация функций многих переменных}

Задача безусловной минимизации (оптимизации) 
состоит в нахождении минимума или максимума функции $f(\vect{x})$
в отсутствие каких-либо ограничений на область изменения
переменных задачи $\vect{x}\in(-\infty,+\infty)$.

Большинство практических задач оптимизации 
содержит ограничения, которые обусловлены 
технико-экономическим смыслом решаемой задачи,
однако многие алгоритмы решения задач с ограничениями 
предполагают сведение ее к последовательности задач 
безусловной оптимизации.

% Спуск по координатам
\emptyline
\subsubsection{Спуск по координатам}
Идея метода по координатного спуска заключается в том, что
задача поиска минимума функции $f(x_1,x_2,\ldots,x_n)\to\min$
разделяется на серию задач \alert{одномерной минимизации} 
этой функции вдоль направления одной из координатных осей:
\begin{equation*}
\begin{matrix}
f(\textcolor{darkred}{x_1},x_2=\const,\ldots,x_n=\const)\to\min\\
f(x_1=\const,\textcolor{darkred}{x_2},\ldots,x_n=\const)\to\min\\
\hdotsfor{1}\\
f(x_1=\const,x_2=\const,\ldots,\textcolor{darkred}{x_n})\to\min\\
\end{matrix}
\end{equation*}

\begin{enumerate}
\item
Выбирают нулевое приближение 
$\vect{x}_0=(x_{10},x_{20},\ldots,x_{n0})$.
\item
Фиксируют (считают постоянными)  значения всех 
координат кроме $x_1$. Тогда функция $f(\vect{x})$
будет зависеть только от одной переменной $x_1$:
\begin{equation*}
\phi_1(x_1)=f(x_1,x_{20}=\const,\ldots,x_{n0}=\const)
\end{equation*}
\item
Используя метод одномерной минимизации, находится 
минимум функции одной переменной $\phi_1(x_1)\to\min$, 
который можно обозначить через $m_1$.
\item
Сделан переход из начальной точки $\vect{x}_0$ в точку
``частного`` минимума по направлению, параллельному оси $x_1$:
\begin{equation*}
(x_{10},x_{20},\ldots,x_{n0})\to(m_1,x_{20},\ldots,x_{n0}),
\end{equation*}
и значение функции уменьшается:
\begin{equation*}
f(x_{10},x_{20},\ldots,x_{n0})>f(m_1,x_{20},\ldots,x_{n0})
\end{equation*}
\item
Затем из новой точки $(m_1,x_{20},\ldots,x_{n0})$
осуществляется спуск по направлению, параллельному оси $x_2$,
то есть находится минимум функции: 
\begin{equation*}
\phi_2(x_2)=f(m_1=\const,x_2,\ldots,x_n=\const),
\end{equation*}
который обозначим $m_2$.
\item
Таким образом, сделан переход во вторую точку
``частного`` минимума по направлению, параллельному оси $x_2$:
\begin{equation*}
(m_1,x_{20},\ldots,x_{n0})\to(m_1,m_2,\ldots,x_{n0}),
\end{equation*}
и значение функции уменьшается:
\begin{equation*}
f(m_1,x_{20},\ldots,x_{n0})>f(m_1,m_2,\ldots,x_{n0})
\end{equation*}
\item
Процесс спуска по координатам повторяется для всех переменных
задачи $x_3,x_4,\ldots,x_n$, а приход в точку 
$\vect{x}_m=(m_1,m_2,\ldots,m_n)$ завершает цикл спусков.
\item
Конечную точку цикла спусков можно принять за нулевое 
приближение\linebreak $\vect{x}_0=\vect{x}_m$ 
и повторить цикл спусков по координатам $x_1,x_2,\ldots,x_n$
до тех пока, не выполнено условие останова 
итерационного процесса.
\end{enumerate}

\emptyline
Практически можно задать некоторое число $\epsilon > 0$, 
связанное с выбранной точностью вычислений, и 
проводить итерации до тех пор, пока на $k$-ой итерации
не будут выполнены одно или несколько неравенств вида:
\begin{equation}
\norma{\vect{x}_k - \vect{x}_{k-1}} < \epsilon_1,
\quad
\norma{f(\vect{x}_k)-f(\vect{x}_{k-1})} < \epsilon_2
\end{equation}

% Метод градиентного спуска
\emptyline
\subsubsection{Метод градиентного спуска}
Градиентный спуск -- метод нахождения локального экстремума 
(минимума или максимума) функции многих переменных 
$f(x_1,x_2,\ldots,x_n)$
с помощью движения вдоль градиента этой функции. 
Это наиболее простой в реализации из всех методов локальной оптимизации, но имеет
относительно малую (линейную) скорость сходимости.

Градиент $\nabla$ это вектор, указывающий направление 
наибольшего возрастания некоторой функции
$f$, значение которой меняется от одной точки 
пространства к другой (скалярного поля), 
а по величине (модулю) равный скорости роста этой величины 
в этом направлении.
Компонентами вектора градиента являются частные производные 
$f$ по всем её аргументам:
\begin{equation}\label{eq:GD:nabla}
\nabla{f}=\left(\pdiff{f}{x_1},\pdiff{f}{x_2},\ldots,\pdiff{f}{x_n}\right)
\end{equation}

Для случая трёхмерного пространства градиентом 
скалярной функции\linebreak
$f(x,y,z)$ называется векторная функция:
\begin{gather*}
\mathrm{grad}\,f=\nabla{f},
\end{gather*}
где $\nabla$ -- векторный дифференциальный оператор набла,
компоненты которого являются частными производными 
по координатам:
\begin{gather*}
\nabla=\left(\pdiff{}{x}, \pdiff{}{y}, \pdiff{}{z}\right)
\end{gather*}

Следует отметить, что оператор набла не принадлежит тому же 
пространству, что и обычные векторы, а говоря точнее, 
скалярное и векторное произведение для него 
определено с некоторыми отличиями. 
Оператор $\nabla$ действует на те скалярные поля, 
что стоят от него справа, и не действует на стоящие от него слева.
Поэтому скалярное и векторное произведение с участием 
$\nabla$ \emph{не коммутативны} и не антикоммутативны, 
как это свойственно для таких произведений обычных векторов.

Минимизация целевой функции $f(\vect{x})$ 
сводится к итерационному процессу 
последовательного выбора нового 
вектора неизвестных $\vect{x}_{k+1}$, такого чтобы
значение функции в новой точки было меньше чем в предыдущих:
\begin{equation*}
f(\vect{x}_0)>f(\vect{x}_1)>\ldots>f(\vect{x}_k)>f(\vect{x}_{k+1})>\ldots
\end{equation*}

Предполагая, что новый вектор неизвестных мало отличается 
от предыдущего ($\vect{x}_{k+1}-\vect{x}_k\approx\vect{0}$),
можно воспользоваться линейным приближением
для разложения в ряд Тейлора целевой функции:
\begin{equation}\label{eq:GD:Taylor}
f(\vect{x}_{k+1}) = f(\vect{x}_k)
+\left(\nabla{f}(\vect{x}_k),\vect{x}_{k+1}-\vect{x}_k\right),
\end{equation}
где $k$ -- номер итерационного шага процесса;
$\vect{x}_k$ -- значение неизвестных на $k$-ой итерации.

Если в качестве нового вектора неизвестных выбрать:
\begin{equation}\label{eq:GD:x(k+1)}
\vect{x}_{k+1}=\vect{x}_k - \lambda\cdot\nabla{f(\vect{x}_k)},
\end{equation}
то из \eqref{eq:GD:Taylor} получим:
\begin{equation}
f(\vect{x}_{k+1}) = f(\vect{x}_k)
-\lambda\cdot\norma{\nabla{f}(\vect{x}_k)}^2
\quad\to\quad
f(\vect{x}_{k+1}) \leqslant f(\vect{x}_k)
\end{equation}
где $\lambda>0$ -- малое положительное число (параметр метода), 
имеющий смысл скорости градиентного спуска;
$\norma{\nabla{f}(\vect{x}_k)}\geqslant0$ -- 
норма вектора градиента (неотрицательное число):
\begin{equation*}
\norma{\nabla{f}}=\sqrt{\left(\nabla{f},\nabla{f}\right)}
\end{equation*}

Таким образом, выбор нового вектора неизвестных $\vect{x}_{k+1}$
в соответствии с выражением \eqref{eq:GD:x(k+1)}, гарантирует
монотонное убывание целевой функции $f(\vect{x})$ в каждой итерации.
Поэтому основная идея метода градиентного спуска заключается в том, 
чтобы последовательно идти в направлении наибольшего
уменьшения целевой функции, которое задаётся антиградиентом 
$-\nabla{f}(\vect{x})$.

% Алгоритм метода градиентного спуска
%\textbf{Алгоритм метода градиентного спуска}
%\begin{enumerate}
%\item 
%Задают начальное приближение ${(x_0,y_0)}$, 
%скорость градиентного спуска $\lambda$, 
%а также точность расчёта $\varepsilon$.
%\item
%Рассчитывают градиент целевой функции
%в текущей точке $\nabla_0=\nabla f(x_0,y_0)$.
%\item
%Определяют новый вектор неизвестных 
%в соответствии с соотношением \eqref{eq:GD:x(k+1)}:
%\begin{gather*}
%\left\{\begin{matrix}
%x_1&=&x_0 - \lambda\cdot{\nabla_0}_x\\
%y_1&=&y_0 - \lambda\cdot{\nabla_0}_y\\
%\end{matrix}\right.,
%\end{gather*}
%где ${\nabla_0}_x$ и ${\nabla_0}_y$ --
%компоненты вектора градиента в выбранной системе координат.
%\item
%Рассчитывают величину расстояния между двумя точками:
%\begin{gather*}
%r=\sqrt{(x_0-x_1)^2+(y_0-y_1)^2}
%\end{gather*}
%\item
%Проверяют условие остановки итерационного процесса:
%если $r<\varepsilon$, то итерационный процесс останавливается;
%иначе текущую точку считают начальной 
%$x_0=x_1$ и $y_0=y_1$ и переходят к шагу (2) 
%итерационного процесса.
%\end{enumerate}


% *** Алгоритм поиска минимума функции одной переменной
% https://tex.stackexchange.com/questions/370704/drawing-a-scheme
\begin{figure}[H]\centering
\begin{tikzpicture}[
font=\small,
start chain=going below,node distance=10mm,every join/.style=->,%
>={Straight Barb[angle=45:1.5mm 1]},shorten >=0.5pt,%
]
% соединитель
\node[rrectnode,on chain,join]{старт};
% данные
\node[datanode,on chain,join]
{$\vect{x}_0, \lambda, \varepsilon_1$};
% grad(f)
\node[rectnode,on chain,join](grad0)
{$\nabla_0=\nabla{f(\vect{x}_0})$};
% x1
\node[rectnode,on chain,join](x1)
{$\vect{x}_1=\vect{x}_0-\lambda\cdot\nabla_0$};
% сравнение
\node[ifthenelsenode,on chain,join](compare)
{$\norma{\vect{x}_1-\vect{x}_0}\leqslant\varepsilon_1$};
% нет
\begin{scope}[start branch=b,node distance=15mm]
\node[rectnode,on chain=going right,join](no)
{$\vect{x}_0=\vect{x}_1$};
\draw(compare.east) node[above right]{нет};
\draw[->,thick] (no.north) |- (grad0.east);
\end{scope}
% выход
\draw (compare.south) node[below left]{да};
\begin{scope}[node distance=12mm]
\node[rrectnode,on chain,join]{стоп};
\end{scope}
\end{tikzpicture}
% *******************************************
\caption{Блок-схема алгоритма нахождения минимума\linebreak 
функции $f(\vect{x})$ многих переменных 
методом градиентного спуска}
\label{fig:GD:scheme gradf(x)->min}
\end{figure}

% Метод тяжелого шара
\emptyline
\subsubsection{Метод тяжелого шара}
Поиск минимума функции многих переменных $f(\vect{x})$
методом ``тяжелого шара`` основан на аналогии 
движения материальной частицы массой $m$ 
в консервативном силовом поле $\vect{F}(\vect{x})$
в вязкой среде.

В соответствии с принципом минимальной энергии
тело смещается в положение, которое минимизирует общую 
потенциальную энергию системы\linebreak
$f(\vect{x})\to\min$.
Поэтому если предположить, что функция $f(\vect{x})$ 
является потенциальной энергией частицы 
в консервативном силовом поле 
$\vect{F}(\vect{x})=-\nabla{f(\vect{x})}$,
и частица перемещается в пространстве $\vect{x}$ 
минимизируя свою энергию, то уравнение движения 
этой частицы можно записать в виде:
\begin{equation}
\left\{
\begin{matrix}[rcl]
\diff{\vect{x}}{t}&=&\vect{v}\\[1em]
m\,\diff{\vect{v}}{t}&=&\vect{F} - \alpha\cdot\vect{v}
\end{matrix}
\right.
\end{equation}
где 
$\vect{x}$ -- положение частицы в выбранной системе координат;
$\vect{v}$ и $\alpha$ -- 
скорость и коэффициент вязкого трения частицы в среде,
соответственно.

Этот метод используется в методе стохастического градиентного спуска 
и в качестве расширения алгоритмов обратного распространения ошибок
для обучения искусственных нейронных сетей.

Поиск минимума данным методом начинается 
с задания начальных условий, которые, как правило,
формулируются в виде:
\begin{equation}
\begin{cases}
\vect{x}(0)=&\vect{x}_0\\
\vect{v}(0)=&\vect{v}_0\\
\end{cases},
\end{equation}
где $\vect{x}_0$ -- начальное приближения для поиска
минимума функции;
$\vect{v}_0$ -- ``начальная скорость`` в пространстве неизвестных.

Масса частицы $m$ и коэффициент вязкого трения $\alpha$
являются эвристическими параметрами метода и выбираются
произвольным образом, отражающим специфику решаемой задачи.

%
%	Пример
%
\emptyline
\subsection{Численная оптимизация местоположения
склада торговой сети}
Рассмотрим задачу нахождения координат 
расположения склада готовой продукции (распределительного центра),
таких чтобы суммарное расстояние от склада до потребителей продукции
(магазинов торговой сети) было минимальным. 

\subsubsection{Метод по координатного спуска}
Будем полагать, что магазины торговой сети находятся в городах,
которые имеют определенные местоположения
заданные их географическими координатами.

Географические координаты определяют местоположение 
точки на поверхности Земли, и строятся по принципу 
сферических координат. Центр системы географических координат
помещается в центр Земли, а положение точки в пространстве
определяется расстоянием $r$ от центра Земли, широтой $\phi$ и 
долготой $\lambda$ (рисунок \ref{fig:GCS}):
\begin{enumerate}
\item
широта $\phi$ -- угол между местным направлением зенита и 
плоскостью экватора, отсчитываемый в обе стороны от экватора.
\item
долгота $\lambda$ -- двугранный угол между плоскостью меридиана, 
проходящего через данную точку, и плоскостью начального 
нулевого меридиана.
\end{enumerate}

Радиус-вектор $\vect{r}$ точки $A$, находящейся 
на поверхности Земли, имеет в декартовой системе 
координат компоненты:
\begin{equation*}
\vect{r}=(r_x,r_y,r_z),
\end{equation*}
где $r_{x,y,z}$ -- компоненты вектора $\vect{r}$, 
то есть проекции этого вектора на оси декартовой системы координат:
\begin{equation*}
\left\{\begin{matrix}[lcl]
r_x&=&\mathcal{R}\cdot\cos(\phi)\cdot\cos(\lambda)\\
r_y&=&\mathcal{R}\cdot\cos(\phi)\cdot\sin(\lambda)\\
r_z&=&\mathcal{R}\cdot\sin(\phi)\\
\end{matrix}\right.,
\end{equation*}
$\mathcal{R}$ -- радиус планеты Земля.

Таким образом, для определения местоположения
\emph{на поверхности Земли}, достаточно 
задать широту $\phi$ и долготу $\lambda$
географического объекта. 
%
% 3D-МОДЕЛЬ географических координат
%
% географическая система координат
\newcommand\GScoordinate[4]{
\coordinate (#1) at ({#2*cos(#3)*cos(#4)},{#2*cos(#3)*sin(#4)},{#2*sin(#3)});
\coordinate (#1x) at ({#2*cos(#3)*cos(#4)},0,0);
\coordinate (#1y) at (0,{#2*cos(#3)*sin(#4)},0);
\coordinate (#1z) at (0,0,{#2*sin(#3)});
\coordinate (#1xy) at ({#2*cos(#3)*cos(#4)},{#2*cos(#3)*sin(#4)},0);
}
% 3D-вид 
\tdplotsetmaincoords{60}{120}
\begin{figure}[H]\centering
\begin{tikzpicture}[tdplot_main_coords,scale=4.5,
>={Straight Barb[angle=45:1.5mm 1]},shorten >=2pt]
% радиус Земли
\def\radiusX{1.1}
% центр Земли
\coordinate (O) at (0,0,0);
% Земля
\shadedraw[color=darkblue,thick,ball color=blue!25!white,opacity=0.5,rotate=30] 
(O)  circle({\radiusX cm});
% экватор
\fill[color=blue!25,opacity=0.25] 
(0,0) circle({\radiusX});
\tdplotsetrotatedcoords{-60}{0}{0};
\draw[tdplot_rotated_coords,darkblue,thick]
(\radiusX,0) arc (0:180:{\radiusX})
node[sloped,pos=0.5,below,font=\small]{экватор};
\draw[tdplot_rotated_coords,dashed,darkblue,opacity=0.5]
(\radiusX,0) arc (360:180:{\radiusX});

% система координат
%\tdplotsetrotatedcoords{0}{0}{0};
\begin{scope}[font=\footnotesize,color=gray]
\draw[->] (O) -- (0.8,0,0) node[above left] {$x$};
\draw[->] (O) -- (0,0.9,0) node[above right] {$y$};
\draw[->] (O) -- (0,0,1.1) node[left] {$z$};
\end{scope}
% точка на поверхности Земли
\def\radius{1.25}\def\longitude{60}\def\latitude{45}
% xyz-координаты
\GScoordinate{A}{\radius}{\latitude}{\longitude};
% прорисовка проекций
\draw[fill=orange!25,opacity=0.25] (O) -- (Az) -- (A) -- (Axy) -- (O);
% углы
\path (O) -- (Ax) node[pos=1](AX){};
\path (O) -- (Axy) node[pos=0.5](AXY){};
\path (O) -- (A) node[pos=0.5](AR){};
% прорисовка углов
\begin{scope}[font=\small]
% широта
\draw[->,thick,color=blue]  (AX.center) 
to [bend right=30]node[sloped,pos=0.5,below]{$\lambda$}
(AXY.center);
% долгота
\draw[->,thick,color=red]  (AXY.center) 
to [bend right=30]node[pos=0.5,right]{$\phi$}
(AR.center);
\end{scope}
%\begin{scope}[shift={(0,0,{\Pz})}]
%\tdplotsetrotatedcoords{-49}{0}{0};
%\def\radiusY{\radius*cos(\latitude)}
%\draw[tdplot_rotated_coords,thin,blue,opacity=0.5] 
%({\radiusY},0) arc(0:160:{\radiusY});
%\end{scope}
% радиус-вектор
\draw[->,thick,black]
(O) -- (A) node[sloped,pos=0.5,above]{$\vect{r}$};
\draw[thick,fill=white]
(A) circle(0.5pt) node[below right]{$A$};
\end{tikzpicture}
\caption{
\href{https://en.wikipedia.org/wiki/Geographic_coordinate_system\#Latitude_and_longitude}
{Географическая система координат} на поверхности Земли}
\label{fig:GCS}
\end{figure}

Кратчайшее расстояние между двумя точками $A$ и $B$
находящимися на сферической поверхности Земли
равно длине дуги большого круга.
Если известны географические координатами точек
$A(\phi_a,\lambda_a)$ и $B(\phi_b,\lambda_b)$, то
расстояние на поверхности Земли между этими точками
составляет (рисунок \ref{fig:GCS:creat circle distance}):
\begin{equation}\label{eq:GCS:sphere distance}
d_{AB}=\mathcal{R}\cdot\alpha,
\end{equation}
где $\alpha$ -- центральный угол между радиус-векторами
$\vect{a}$ и $\vect{b}$ 
точек $A$ и $B$, лежащих на поверхности Земли.

%
% График: длина дуги большого круга
%
\tdplotsetmaincoords{60}{120}
\begin{figure}[H]\centering
\begin{tikzpicture}[tdplot_main_coords,scale=4.5,
>={Straight Barb[angle=45:1.5mm 1]},shorten >=2pt]
% радиус Земли
\def\radiusX{1.1}
% центр Земли
\coordinate (O) at (0,0,0);
% Земля
\shadedraw[color=darkblue,thick,ball color=blue!25!white,opacity=0.5,rotate=30] 
(O)  circle({\radiusX cm});
% экватор
\fill[color=blue!25,opacity=0.25] 
(0,0) circle({\radiusX});
\tdplotsetrotatedcoords{-60}{0}{0};
\draw[tdplot_rotated_coords,darkblue,thick]
(\radiusX,0) arc (0:180:{\radiusX})
node[sloped,pos=0.5,below,font=\small]{экватор};
\draw[tdplot_rotated_coords,dashed,darkblue,opacity=0.5]
(\radiusX,0) arc (360:180:{\radiusX});

% система координат
%\tdplotsetrotatedcoords{0}{0}{0};
\begin{scope}[font=\footnotesize,color=gray]
\draw[->] (O) -- (0.8,0,0) node[above left] {$x$};
\draw[->] (O) -- (0,0.9,0) node[above right] {$y$};
\draw[->] (O) -- (0,0,1.1) node[left] {$z$};
\end{scope}
 
% центр сферы
\tdplotsetcoord{O}{0}{0}{0};
% координат точек
\GScoordinate{A}{1}{40}{70};
\GScoordinate{B}{1}{60}{-30};
% плоскость
\filldraw[color=gray,fill=orange!20,opacity=0.5]
(O) -- (A) to [bend right=50] (B) -- (O);
% дуга
\draw[black,thick,tdplot_main_coords]
(A) to [bend right=50]node[sloped,pos=0.5,above]{$d_{AB}$} (B);
% точки на сфере 
\draw[fill=red] (A) circle (0.5pt) node[below right,color=red]{$A$};
\draw[fill=blue] (B) circle (0.5pt) node[above left,color=blue]{$B$};
% радиус-вектор
\draw[->,red,thick] (0,0,0) -- (A)
node[sloped,pos=0.5,below]{$\vect{a}$};
\draw[->,blue,thick] (0,0,0) -- (B)
node[sloped,pos=0.5,above]{$\vect{b}$};
% угол
\path (O) -- (A) node[pos=0.35](AA){};
\path (O) -- (B) node[pos=0.35](AB){};
\draw[<->] (AA.center) to [bend right=40]
node[pos=0.25,above]{$\alpha$} (AB.center);
\end{tikzpicture}
\caption{Расстояние $d_{AB}$ (длина дуги) на поверхности сферы
между точками $A$ и $B$}
\label{fig:GCS:creat circle distance}
\end{figure}

Косинус угла $\alpha$ между векторами $\vect{a}$ и $\vect{b}$
можно определить, воспользовавшись геометрическим свойством
скалярного произведения этих векторов:
\begin{equation}\label{eq:GD:cos(a,b)}
(\vect{a},\vect{b}) = \norma{\vect{a}}\cdot\norma{\vect{b}}
\cdot\cos(\alpha)
\quad\to\quad
\cos(\alpha)=
\dfrac{(\vect{a},\vect{b})}{\norma{\vect{a}}\cdot\norma{\vect{b}}},
\end{equation}
где $\norma{\vect{a}}=\norma{\vect{b}}=\mathcal{R}$ --
длины радиус-векторов, с учетом постоянства радиуса Земли.

С алгебраической точки зрения, 
\emph{скалярное произведение векторов} -- это операция 
над двумя векторами $\vect{a}$ и $\vect{b}$, 
результатом которой является число (скаляр), 
значение которого не зависит от выбранной системы координат,
то есть скалярное произведение является \emph{инвариантом}:
\begin{equation}\label{eq:vector scalar product}
(\vect{a},\vect{b})=a_{x}\cdot b_{x} + a_y\cdot b_y + a_z\cdot b_z,
\end{equation}
где $a_{x,y,z}$ и $b_{x,y,z}$ -- компоненты векторов
в декартовой системе координат:
% a
\begin{equation}\label{eq:GD:vector a}
\vect{a}=\left\{\begin{matrix}[rcl]
a_x&=&\mathcal{R}\cdot\cos(\phi_a)\cdot\cos(\lambda_a)\\
a_y&=&\mathcal{R}\cdot\cos(\phi_a)\cdot\sin(\lambda_a)\\
a_z&=&\mathcal{R}\cdot\sin(\phi_a)\\
\end{matrix}\right.
\end{equation}
% b
\begin{equation}\label{eq:GD:vector b}
\vect{b}=\left\{\begin{matrix}[rcl]
b_x&=&\mathcal{R}\cdot\cos(\phi_b)\cdot\cos(\lambda_b)\\
b_y&=&\mathcal{R}\cdot\cos(\phi_b)\cdot\sin(\lambda_b)\\
b_z&=&\mathcal{R}\cdot\sin(\phi_b)\\
\end{matrix}\right.
\end{equation}

Косинус угла \eqref{eq:GD:cos(a,b)} между векторами 
$\vect{a}$ и $\vect{b}$ с учетом 
\eqref{eq:GD:vector a} и \eqref{eq:GD:vector b}:
\begin{equation*}
\begin{split}
\cos(\alpha)=\;
&\cos(\phi_a)\cos(\lambda_a)\cdot\cos(\phi_b)\cos(\lambda_b)\;+\\
&\cos(\phi_a)\sin(\lambda_a)\cdot\cos(\phi_b)\sin(\lambda_b)\;+\\
&\sin(\phi_a)\cdot\sin(\phi_b)
\end{split}
\end{equation*}
или
\begin{equation*}
\begin{split}
\cos(\alpha)=\cos(\phi_a)\cos(\phi_b)\cdot
\begin{pmatrix}[l]
\cos(\lambda_a)\cdot\cos(\lambda_b)\;+\\
+\sin(\lambda_a)\cdot\sin(\lambda_b)
\end{pmatrix}+
\sin(\phi_a)\sin(\phi_b)
\end{split}
\end{equation*}

Воспользовавшись формулой для разности углов 
тригонометрических функций (косинуса):
\begin{equation*}
\cos(\lambda_a)\cdot\cos(\lambda_b)+
\sin(\lambda_a)\cdot\sin(\lambda_b)=
\cos(\lambda_a - \lambda_b)
\end{equation*}
окончательно получим:
\begin{equation*}
\cos(\alpha)=
\cos(\phi_a)\cos(\phi_b)\cdot\cos(\Delta\lambda) +
\sin(\phi_a)\sin(\phi_b),
\end{equation*}
где $\Delta\lambda=\lambda_a-\lambda_b$ --
разность долготы географических координат точек $A$ и $B$,
соответственно.

Таким образом, кратчайшее расстояние на поверхности Земли
между двумя точками \eqref{eq:GCS:sphere distance}
может быть найдено из соотношения:
\begin{equation}\label{eq:GCS:distance}
d_{AB}=\mathcal{R}\cdot\arccos\left(
\cos(\phi_a)\cos(\phi_b)\cdot\cos(\Delta\lambda) +
\sin(\phi_a)\sin(\phi_b)
\right),
\end{equation}

\begin{enumerate}
\item
С помощью картографических веб сервисов (например, 
\href{https://yandex.ru/maps}{Яндекс.Карты},
\href{https://www.google.ru/maps}{карты Google}, и т.п.).
определим 
\href{https://ru.wikipedia.org/wiki/Географические_координаты}
{географические координаты} всех городов, 
в которых находятся магазины торговой сети 
Полученные данные представим в таблице \ref{tab:cities}.

%
% Таблица: города торговой сети
%
\begin{table}[H]
\caption{Географические координаты магазинов торговой сети}
\label{tab:cities}
\begin{tabular*}{\textwidth}{%
@{\extracolsep{\fill}}p{7cm} p{3cm} p{3cm}}
\toprule
Город&%
\multicolumn{2}{l}{Географические координаты}\\
\cmidrule{2-3}
&широта $\phi$&долгота $\lambda$\\
\midmidrule
Москва&$55.66352$&$37.62964$\\
Саратов&$51.53440$&$46.03121$\\
Воронеж&$56.67071$&$39.16190$\\
\bottomrule
\end{tabular*}
\end{table}

\item
Построим целевую функцию $f(\phi,\lambda)$ -- 
суммарное расстояние вдоль поверхности Земли 
от склада до магазинов в городах Москва, Саратов и Воронеж:
\begin{equation*}\label{eq:r(phi,lambda)}
f(\phi,\lambda)=d_1(\phi,\lambda)+d_2(\phi,\lambda)+d_3(\phi,\lambda),
\end{equation*}
где $\phi$ и $\lambda$ -- географическая широта и долгота 
местоположения склада;
$d_1$, $d_2$ и $d_3$ -- расстояние вдоль поверхности Земли
\eqref{eq:GCS:distance} между складом и городами 
Москва, Саратов и Воронеж, соответственно:
\begin{gather*}
d_1(\phi,\lambda)=\mathcal{R}\cdot\arccos\left(
\cos(\phi)\cos(\phi_1)\cdot\cos(\lambda-\lambda_1) +
\sin(\phi)\sin(\phi_1)
\right)\\
d_2(\phi,\lambda)=\mathcal{R}\cdot\arccos\left(
\cos(\phi)\cos(\phi_2)\cdot\cos(\lambda-\lambda_2) +
\sin(\phi)\sin(\phi_2)
\right)\\
d_3(\phi,\lambda)=\mathcal{R}\cdot\arccos\left(
\cos(\phi)\cos(\phi_3)\cdot\cos(\lambda-\lambda_3) +
\sin(\phi)\sin(\phi_3)
\right)
\end{gather*}
где 
$\phi_1=55.66352$ и $\lambda_1=37.62964$ -- широта и долгота города Москва;\\
$\phi_2=51.53440$ и $\lambda_2=46.03121$ -- широта и долгота города Саратов;\\
$\phi_3=56.67071$ и $\lambda_3=39.16190$ -- широта и долгота города Воронеж
(таблица \ref{tab:cities}).

\item
Для решения задачи оптимизации целевой функции 
\alert{методом по координатного спуска} 
определим область поиска минимума функции $r(\phi,\lambda)$.

Например, в качестве границ области можно выбрать
экстремальные значения широты и долготы городов, 
в которых расположены магазины торговой сети:
\begin{gather*}
\left\{\begin{matrix}[lclcl]
\phi_{\inf}&=&\min(\phi_1,\phi_2,\phi_3) = \phi_2&=&51.53440\\
\phi_{\sup}&=&\max(\phi_1,\phi_2,\phi_3) = \phi_3&=&56.67071\\
\end{matrix}\right.
\\
\left\{\begin{matrix}[lclcl]
\lambda_{\inf}&=&\min(\lambda_1,\lambda_2,\lambda_3)=\lambda_1&=&37.62964\\
\lambda_{\sup}&=&\max(\lambda_1,\lambda_2,\lambda_3)=\lambda_2&=&46.03121\\
\end{matrix}\right.
\end{gather*}

Таким образом, минимум целевой функции будем искать 
в области $\mathcal{D}$:
\begin{equation*}
\mathcal{D}\;=\;
\left\{\begin{matrix}[rcl]
\phi_{\inf}&\leqslant \phi \leqslant&\phi_{\sup}\\
\lambda_{\inf}&\leqslant \lambda \leqslant&\lambda_{\sup}\\
\end{matrix}\right.
\;=\;
\left\{\begin{matrix}[rcl]
51.53440&\leqslant \phi \leqslant&56.67071\\
37.62964&\leqslant \lambda \leqslant&46.03121\\
\end{matrix}\right.
\end{equation*}

\item
Критерием прекращения итерационного поиска
минимума целевой функции считать условие выполнения
одного из неравенств:
\begin{equation}\label{eq:stop condition}
\epsilon_1 \geqslant \xi,
\qquad
f(\phi_k,\lambda_k) \geqslant f(\phi_{k-1},\lambda_{k-1})
\end{equation}
где $\epsilon_1=0.1$ -- заданная точность
определения местоположения склада;\linebreak
$\xi$ -- изменение местоположения склада 
на текущем $k$ шаге итерационного процесса:
\begin{equation}\label{eq:GCS:step error}
\xi=\sqrt{(\phi_k-\phi_{k-1})^2+(\lambda_k-\lambda_{k-1})^2};
\end{equation}
$\phi_k$ и $\lambda_k$ -- значение географических координат
склада на $k$-ом шаге итерационного процесса.

%
% начально положение
%
\def\phiStart{52.0}
\def\lambdaStart{44.0}
% частный минимум phi
\def\phiMin{54.66658}
% частный минимум lambda
\def\lambdaMin{39.49103}
% epsilon
\def\epsilonOne{5.23846}
%
\item
В качестве начального местоположение склада
$(\phi_0,\lambda_0)$ выберем любую произвольную
точку внутри области поиска минимума целевой функции,
например:
\begin{equation*}
\begin{cases}
\phi_0 = \phiStart\\
\lambda_0 = \lambdaStart\\
\end{cases}.
\end{equation*}

\item
Считаем постоянными значения долготы склада 
$\lambda=\lambda_0=\const$
и рассматриваем вспомогательную функцию
только одной переменной $\phi$:
\begin{equation*}
\rho_1(\phi)=f(\phi, \lambda_0)=f(\phi, \lambdaStart)
\end{equation*}

Находим минимум вспомогательной функции 
одной переменной $\rho_1(\phi)$, используя метод 
одномерной минимизации:
\begin{equation*}
\phi_{\min}
=\arg\left(
\min_{\phi_{\inf}\leqslant\phi\leqslant\phi_{\sup}}\rho_1(\phi)
\right)
=\phiMin
\end{equation*}
где $\phi_{\min}$ -- положение ``частного`` минимума
функции $f(\phi, \lambdaStart)$.

Считаем постоянными значения широты склада 
$\phi=\phi_{\min}=\const$ 
и рассматриваем вторую вспомогательную функцию
только одной переменной $\lambda$:
\begin{equation*}
\rho_2(\lambda)=f(\phi_{\min},\lambda)=f(\phiMin,\lambda)
\end{equation*}

Находим минимум функции одной переменной $\rho_2(\lambda)$,
используя метод одномерной минимизации:
\begin{equation*}
\lambda_{\min}
=\arg\left(
\min_{\lambda_{\inf}\leqslant\lambda\leqslant\lambda_{\sup}}\rho_2(\lambda)
\right)
=\lambdaMin
\end{equation*}
где $\lambda_{\min}$ -- положение ``частного`` минимума
функции $f(\phiMin,\lambda)$.

\item
Определяем изменение местоположения склада 
\eqref{eq:GCS:step error} в результате проведенных 
итерационных процессов (рисунок \ref{fig:min1}):
\begin{equation*}
\begin{split}
\xi=\;
&\sqrt{(\phi_{\min}-\phi_0)^2+(\lambda_{\min}-\lambda_0)^2}=\\
=\;&\sqrt{(\phiMin-\phiStart)^2+(\lambdaMin-\lambdaStart)^2}=\\
=\;&\epsilonOne\\
\end{split}
\end{equation*}

Находим значение целевой функции в начальной 
$f(\phi_0,\lambda_0)$ и конечной точки 
$f(\phi_{\min},\lambda_{\min})$ точках 
местоположения склада:
\begin{equation*}
\begin{matrix}[lclcl]
f(\phi_0,\lambda_0)&=&f(\phiStart,\lambdaStart)&=&1338.696\\
f(\phi_{\min},\lambda_{\min})&=&f(\phiMin,\lambdaMin)&=&944.004\\
\end{matrix}
\end{equation*}

Сравниваем величину текущего ``шага`` $\xi$ и 
заданную точность расчетов $\epsilon_1$,
а также значения целевой функции $f(\phi,\lambda)$ в начальной
и конечной точки итерационного процесса:
\begin{equation*}
\begin{matrix}[rcl]
\epsilon_1=0.1&<&\xi=\epsilonOne\\
f(\phi_{\min},\lambda_{\min})=944.004&<&f(\phi_0,\lambda_0)=1338.696\\
\end{matrix}
\end{equation*}

Критерий остановки итерационного процесса 
\eqref{eq:stop condition} не выполняется,
следовательно, \emph{итерационный процесс продолжаем}!

%
% График: траектория поиска минимума
%
\begin{figure}[H]\centering
\begin{tikzpicture}
[>={Straight Barb[angle=45:1.5mm 1]},shorten >=0pt,shorten <=0pt]
\begin{axis}[enlargelimits=0.2,grid=none,
xlabel={широта $\phi$},ylabel={долгота $\lambda$},
xmin=51.25,xmax=56.75,xtick={51,52,53,54,55,56,57},
ymin=36.25,ymax=45.75,ytick={36,38,40,42,44,46},
]
%% изолинии
\addplot[black!100,smooth]coordinates{(55.714,38.150)(55.734,38.145)(55.754,38.149)(55.756,38.150)(55.774,38.158)(55.790,38.170)(55.794,38.173)(55.814,38.190)(55.814,38.190)(55.833,38.210)(55.834,38.211)(55.851,38.230)(55.854,38.233)(55.868,38.250)(55.874,38.258)(55.884,38.270)(55.894,38.284)(55.899,38.290)(55.914,38.310)(55.914,38.310)(55.928,38.330)(55.934,38.339)(55.942,38.350)(55.954,38.368)(55.956,38.370)(55.969,38.390)(55.974,38.398)(55.982,38.410)(55.994,38.429)(55.995,38.430)(56.008,38.450)(56.014,38.461)(56.020,38.470)(56.032,38.490)(56.034,38.493)(56.044,38.510)(56.054,38.527)(56.056,38.530)(56.068,38.550)(56.074,38.561)(56.079,38.570)(56.091,38.590)(56.094,38.596)(56.102,38.610)(56.113,38.630)(56.114,38.633)(56.123,38.650)(56.134,38.670)(56.134,38.671)(56.144,38.690)(56.154,38.710)(56.154,38.710)(56.164,38.730)(56.174,38.750)(56.174,38.751)(56.183,38.770)(56.192,38.790)(56.194,38.795)(56.201,38.810)(56.209,38.830)(56.214,38.843)(56.217,38.850)(56.225,38.870)(56.232,38.890)(56.234,38.896)(56.239,38.910)(56.245,38.930)(56.251,38.950)(56.254,38.963)(56.256,38.970)(56.261,38.990)(56.264,39.010)(56.267,39.030)(56.269,39.050)(56.270,39.070)(56.270,39.090)(56.268,39.110)(56.266,39.130)(56.262,39.150)(56.257,39.170)(56.254,39.177)(56.250,39.190)(56.242,39.210)(56.234,39.225)(56.232,39.230)(56.220,39.250)(56.214,39.258)(56.206,39.270)(56.194,39.285)(56.191,39.290)(56.174,39.308)(56.173,39.310)(56.154,39.327)(56.152,39.330)(56.134,39.344)(56.127,39.350)(56.114,39.358)(56.096,39.370)(56.094,39.371)(56.074,39.381)(56.056,39.390)(56.054,39.390)(56.034,39.397)(56.014,39.403)(55.994,39.407)(55.974,39.410)(55.972,39.410)(55.954,39.410)(55.934,39.410)(55.934,39.410)(55.914,39.407)(55.894,39.403)(55.874,39.397)(55.855,39.390)(55.854,39.389)(55.834,39.380)(55.817,39.370)(55.814,39.368)(55.794,39.354)(55.790,39.350)(55.774,39.337)(55.767,39.330)(55.754,39.317)(55.747,39.310)(55.734,39.295)(55.730,39.290)(55.715,39.270)(55.714,39.268)(55.702,39.250)(55.694,39.237)(55.690,39.230)(55.679,39.210)(55.674,39.201)(55.669,39.190)(55.659,39.170)(55.654,39.158)(55.651,39.150)(55.643,39.130)(55.636,39.110)(55.634,39.106)(55.629,39.090)(55.623,39.070)(55.617,39.050)(55.614,39.039)(55.612,39.030)(55.607,39.010)(55.603,38.990)(55.599,38.970)(55.595,38.950)(55.594,38.945)(55.592,38.930)(55.589,38.910)(55.587,38.890)(55.584,38.870)(55.582,38.850)(55.580,38.830)(55.579,38.810)(55.578,38.790)(55.577,38.770)(55.576,38.750)(55.576,38.730)(55.576,38.710)(55.576,38.690)(55.576,38.670)(55.577,38.650)(55.578,38.630)(55.579,38.610)(55.580,38.590)(55.582,38.570)(55.584,38.550)(55.586,38.530)(55.588,38.510)(55.590,38.490)(55.593,38.470)(55.594,38.461)(55.596,38.450)(55.600,38.430)(55.603,38.410)(55.607,38.390)(55.611,38.370)(55.614,38.356)(55.616,38.350)(55.621,38.330)(55.627,38.310)(55.632,38.290)(55.634,38.282)(55.639,38.270)(55.646,38.250)(55.654,38.230)(55.654,38.228)(55.664,38.210)(55.674,38.190)(55.674,38.189)(55.690,38.170)(55.694,38.164)(55.714,38.150)};
\addplot[black!82,smooth]coordinates{(55.527,37.630)(55.515,37.650)(55.514,37.650)(55.503,37.670)(55.494,37.685)(55.492,37.690)(55.481,37.710)(55.474,37.723)(55.471,37.730)(55.461,37.750)(55.454,37.764)(55.452,37.770)(55.442,37.790)(55.434,37.808)(55.433,37.810)(55.425,37.830)(55.416,37.850)(55.414,37.855)(55.408,37.870)(55.400,37.890)(55.394,37.905)(55.393,37.910)(55.385,37.930)(55.378,37.950)(55.374,37.959)(55.371,37.970)(55.364,37.990)(55.357,38.010)(55.354,38.017)(55.350,38.030)(55.344,38.050)(55.337,38.070)(55.334,38.079)(55.331,38.090)(55.325,38.110)(55.319,38.130)(55.314,38.147)(55.314,38.150)(55.308,38.170)(55.303,38.190)(55.297,38.210)(55.294,38.221)(55.292,38.230)(55.287,38.250)(55.282,38.270)(55.278,38.290)(55.274,38.303)(55.273,38.310)(55.269,38.330)(55.264,38.350)(55.260,38.370)(55.256,38.390)(55.254,38.397)(55.252,38.410)(55.248,38.430)(55.245,38.450)(55.241,38.470)(55.238,38.490)(55.234,38.509)(55.234,38.510)(55.231,38.530)(55.228,38.550)(55.225,38.570)(55.222,38.590)(55.220,38.610)(55.217,38.630)(55.215,38.650)(55.214,38.653)(55.213,38.670)(55.210,38.690)(55.208,38.710)(55.207,38.730)(55.205,38.750)(55.203,38.770)(55.202,38.790)(55.200,38.810)(55.199,38.830)(55.198,38.850)(55.197,38.870)(55.196,38.890)(55.196,38.910)(55.195,38.930)(55.195,38.950)(55.195,38.970)(55.195,38.990)(55.195,39.010)(55.195,39.030)(55.195,39.050)(55.196,39.070)(55.196,39.090)(55.197,39.110)(55.198,39.130)(55.199,39.150)(55.201,39.170)(55.202,39.190)(55.204,39.210)(55.206,39.230)(55.208,39.250)(55.210,39.270)(55.212,39.290)(55.214,39.305)(55.215,39.310)(55.218,39.330)(55.221,39.350)(55.224,39.370)(55.227,39.390)(55.231,39.410)(55.234,39.427)(55.235,39.430)(55.239,39.450)(55.243,39.470)(55.248,39.490)(55.253,39.510)(55.254,39.517)(55.258,39.530)(55.263,39.550)(55.269,39.570)(55.274,39.589)(55.275,39.590)(55.281,39.610)(55.288,39.630)(55.294,39.649)(55.295,39.650)(55.302,39.670)(55.310,39.690)(55.314,39.702)(55.318,39.710)(55.326,39.730)(55.334,39.748)(55.335,39.750)(55.345,39.770)(55.354,39.789)(55.355,39.790)(55.365,39.810)(55.374,39.826)(55.377,39.830)(55.388,39.850)(55.394,39.859)(55.401,39.870)(55.414,39.890)(55.414,39.890)(55.429,39.910)(55.434,39.917)(55.444,39.930)(55.454,39.942)(55.461,39.950)(55.474,39.965)(55.478,39.970)(55.494,39.986)(55.498,39.990)(55.514,40.005)(55.519,40.010)(55.534,40.023)(55.543,40.030)(55.554,40.039)(55.570,40.050)(55.574,40.053)(55.594,40.066)(55.601,40.070)(55.614,40.077)(55.634,40.088)(55.639,40.090)(55.654,40.097)(55.674,40.105)(55.688,40.110)(55.694,40.112)(55.714,40.118)(55.734,40.122)(55.754,40.126)(55.774,40.129)(55.780,40.130)(55.794,40.131)(55.814,40.132)(55.834,40.132)(55.854,40.132)(55.874,40.130)(55.877,40.130)(55.894,40.128)(55.914,40.124)(55.934,40.120)(55.954,40.115)(55.974,40.110)(55.975,40.110)(55.994,40.103)(56.014,40.096)(56.031,40.090)(56.034,40.088)(56.054,40.079)(56.074,40.070)(56.075,40.070)(56.094,40.059)(56.112,40.050)(56.114,40.048)(56.134,40.036)(56.145,40.030)(56.154,40.024)(56.174,40.010)(56.175,40.010)(56.194,39.996)(56.203,39.990)(56.214,39.981)(56.229,39.970)(56.234,39.965)(56.253,39.950)(56.254,39.949)(56.274,39.931)(56.276,39.930)(56.294,39.913)(56.298,39.910)(56.314,39.894)(56.318,39.890)(56.334,39.874)(56.338,39.870)(56.354,39.853)(56.357,39.850)(56.374,39.831)(56.375,39.830)(56.393,39.810)(56.394,39.808)(56.410,39.790)(56.414,39.784)(56.426,39.770)(56.434,39.759)(56.442,39.750)(56.454,39.733)(56.457,39.730)(56.472,39.710)(56.474,39.706)(56.486,39.690)(56.494,39.678)(56.500,39.670)(56.514,39.650)(56.514,39.649)(56.527,39.630)(56.534,39.618)(56.540,39.610)(56.552,39.590)(56.554,39.586)(56.564,39.570)(56.574,39.552)(56.576,39.550)(56.587,39.530)(56.594,39.517)(56.598,39.510)(56.609,39.490)(56.614,39.479)(56.619,39.470)(56.629,39.450)(56.634,39.439)(56.639,39.430)(56.648,39.410)(56.654,39.395)};
\addplot[black!82,smooth]coordinates{(56.654,38.928)(56.647,38.910)(56.638,38.890)(56.634,38.881)(56.629,38.870)(56.620,38.850)(56.614,38.837)(56.611,38.830)(56.602,38.810)(56.594,38.794)(56.592,38.790)(56.582,38.770)(56.574,38.753)(56.573,38.750)(56.563,38.730)(56.554,38.713)(56.553,38.710)(56.542,38.690)(56.534,38.674)(56.532,38.670)(56.522,38.650)(56.514,38.635)(56.511,38.630)(56.501,38.610)(56.494,38.598)(56.490,38.590)(56.479,38.570)(56.474,38.561)(56.468,38.550)(56.458,38.530)(56.454,38.524)(56.446,38.510)(56.435,38.490)(56.434,38.488)(56.424,38.470)(56.414,38.452)(56.413,38.450)(56.402,38.430)(56.394,38.417)(56.390,38.410)(56.379,38.390)(56.374,38.382)(56.367,38.370)(56.355,38.350)(56.354,38.348)(56.343,38.330)(56.334,38.314)(56.332,38.310)(56.320,38.290)(56.314,38.281)(56.308,38.270)(56.296,38.250)(56.294,38.248)(56.283,38.230)(56.274,38.215)(56.271,38.210)(56.259,38.190)(56.254,38.183)(56.246,38.170)(56.234,38.151)(56.233,38.150)(56.221,38.130)(56.214,38.120)(56.208,38.110)(56.195,38.090)(56.194,38.089)(56.182,38.070)(56.174,38.058)(56.169,38.050)(56.156,38.030)(56.154,38.028)(56.142,38.010)(56.134,37.998)(56.129,37.990)(56.115,37.970)(56.114,37.968)(56.101,37.950)(56.094,37.939)(56.088,37.930)(56.074,37.911)(56.074,37.910)(56.059,37.890)(56.054,37.883)(56.045,37.870)(56.034,37.855)(56.031,37.850)(56.016,37.830)(56.014,37.827)(56.001,37.810)(55.994,37.801)(55.986,37.790)(55.974,37.774)(55.971,37.770)(55.955,37.750)(55.954,37.749)(55.939,37.730)(55.934,37.724)(55.923,37.710)(55.914,37.699)(55.907,37.690)(55.894,37.675)(55.890,37.670)(55.874,37.652)(55.872,37.650)(55.854,37.630)(55.854,37.630)};
\addplot[black!64,smooth]coordinates{(55.252,37.630)(55.241,37.650)(55.234,37.661)(55.230,37.670)(55.219,37.690)(55.214,37.698)(55.208,37.710)(55.198,37.730)(55.194,37.736)(55.188,37.750)(55.178,37.770)(55.174,37.777)(55.168,37.790)(55.159,37.810)(55.154,37.820)(55.150,37.830)(55.141,37.850)(55.134,37.864)(55.132,37.870)(55.124,37.890)(55.115,37.910)(55.114,37.911)(55.107,37.930)(55.099,37.950)(55.094,37.961)(55.091,37.970)(55.083,37.990)(55.076,38.010)(55.074,38.013)(55.068,38.030)(55.061,38.050)(55.054,38.069)(55.054,38.070)(55.047,38.090)(55.040,38.110)(55.034,38.127)(55.034,38.130)(55.027,38.150)(55.021,38.170)(55.014,38.190)(55.014,38.190)(55.008,38.210)(55.002,38.230)(54.996,38.250)(54.994,38.256)(54.991,38.270)(54.985,38.290)(54.979,38.310)(54.974,38.328)(54.974,38.330)(54.969,38.350)(54.964,38.370)(54.958,38.390)(54.954,38.406)(54.954,38.410)(54.949,38.430)(54.944,38.450)(54.939,38.470)(54.935,38.490)(54.934,38.492)(54.930,38.510)(54.926,38.530)(54.922,38.550)(54.918,38.570)(54.914,38.587)(54.914,38.590)(54.910,38.610)(54.906,38.630)(54.903,38.650)(54.899,38.670)(54.896,38.690)(54.894,38.698)(54.892,38.710)(54.889,38.730)(54.886,38.750)(54.883,38.770)(54.880,38.790)(54.877,38.810)(54.875,38.830)(54.874,38.831)(54.872,38.850)(54.869,38.870)(54.867,38.890)(54.865,38.910)(54.863,38.930)(54.861,38.950)(54.859,38.970)(54.857,38.990)(54.855,39.010)(54.854,39.015)(54.853,39.030)(54.852,39.050)(54.850,39.070)(54.849,39.090)(54.848,39.110)(54.846,39.130)(54.845,39.150)(54.845,39.170)(54.844,39.190)(54.843,39.210)(54.842,39.230)(54.842,39.250)(54.842,39.270)(54.841,39.290)(54.841,39.310)(54.841,39.330)(54.841,39.350)(54.842,39.370)(54.842,39.390)(54.842,39.410)(54.843,39.430)(54.844,39.450)(54.844,39.470)(54.845,39.490)(54.846,39.510)(54.848,39.530)(54.849,39.550)(54.850,39.570)(54.852,39.590)(54.854,39.610)(54.854,39.616)(54.856,39.630)(54.858,39.650)(54.860,39.670)(54.862,39.690)(54.865,39.710)(54.867,39.730)(54.870,39.750)(54.873,39.770)(54.874,39.779)(54.876,39.790)(54.879,39.810)(54.883,39.830)(54.886,39.850)(54.890,39.870)(54.894,39.890)(54.894,39.892)(54.898,39.910)(54.902,39.930)(54.907,39.950)(54.912,39.970)(54.914,39.981)(54.917,39.990)(54.922,40.010)(54.927,40.030)(54.933,40.050)(54.934,40.056)(54.939,40.070)(54.945,40.090)(54.951,40.110)(54.954,40.121)(54.957,40.130)(54.964,40.150)(54.971,40.170)(54.974,40.178)(54.979,40.190)(54.986,40.210)(54.994,40.230)(55.003,40.250)(55.011,40.270)(55.014,40.276)(55.021,40.290)(55.030,40.310)(55.034,40.319)(55.040,40.330)(55.050,40.350)(55.054,40.358)(55.061,40.370)(55.072,40.390)(55.074,40.394)(55.084,40.410)(55.094,40.427)(55.096,40.430)(55.109,40.450)(55.114,40.458)(55.122,40.470)(55.134,40.487)(55.137,40.490)(55.152,40.510)(55.154,40.513)(55.167,40.530)(55.174,40.538)(55.184,40.550)(55.194,40.561)(55.202,40.570)(55.214,40.583)(55.221,40.590)(55.234,40.603)(55.242,40.610)(55.254,40.621)(55.264,40.630)(55.274,40.639)(55.288,40.650)(55.294,40.655)(55.314,40.670)(55.314,40.670)(55.334,40.684)(55.344,40.690)(55.354,40.697)(55.374,40.708)(55.377,40.710)(55.394,40.719)(55.414,40.729)(55.416,40.730)(55.434,40.738)(55.454,40.746)(55.464,40.750)(55.474,40.753)(55.494,40.760)(55.514,40.766)(55.531,40.770)(55.534,40.770)(55.554,40.775)(55.574,40.778)(55.594,40.781)(55.614,40.783)(55.634,40.784)(55.654,40.785)(55.674,40.785)(55.694,40.784)(55.714,40.782)(55.734,40.780)(55.754,40.778)(55.774,40.775)(55.794,40.771)(55.799,40.770)(55.814,40.766)(55.834,40.761)(55.854,40.755)(55.873,40.750)(55.874,40.749)(55.894,40.742)(55.914,40.735)(55.927,40.730)(55.934,40.727)(55.954,40.718)(55.972,40.710)(55.974,40.709)(55.994,40.699)(56.011,40.690)(56.014,40.688)(56.034,40.677)(56.047,40.670)(56.054,40.665)(56.074,40.653)(56.079,40.650)(56.094,40.640)(56.109,40.630)(56.114,40.626)(56.134,40.612)(56.137,40.610)(56.154,40.597)(56.164,40.590)(56.174,40.581)(56.189,40.570)(56.194,40.565)(56.213,40.550)(56.214,40.548)(56.234,40.531)(56.236,40.530)(56.254,40.512)(56.257,40.510)(56.274,40.493)(56.278,40.490)(56.294,40.474)(56.298,40.470)(56.314,40.453)(56.318,40.450)(56.334,40.432)(56.337,40.430)(56.354,40.410)(56.355,40.410)(56.372,40.390)(56.374,40.387)(56.389,40.370)(56.394,40.364)(56.406,40.350)(56.414,40.339)(56.422,40.330)(56.434,40.314)(56.437,40.310)(56.452,40.290)(56.454,40.287)(56.467,40.270)(56.474,40.260)(56.481,40.250)(56.494,40.231)(56.495,40.230)(56.509,40.210)(56.514,40.202)(56.522,40.190)(56.534,40.171)(56.535,40.170)(56.548,40.150)(56.554,40.139)(56.560,40.130)(56.572,40.110)(56.574,40.106)(56.584,40.090)(56.594,40.071)(56.595,40.070)(56.606,40.050)(56.614,40.035)(56.617,40.030)(56.628,40.010)(56.634,39.997)(56.638,39.990)(56.648,39.970)(56.654,39.957)};
\addplot[black!64,smooth]coordinates{(56.654,38.386)(56.647,38.370)(56.638,38.350)(56.634,38.343)(56.628,38.330)(56.619,38.310)(56.614,38.301)(56.609,38.290)(56.599,38.270)(56.594,38.260)(56.589,38.250)(56.579,38.230)(56.574,38.220)(56.569,38.210)(56.558,38.190)(56.554,38.182)(56.548,38.170)(56.537,38.150)(56.534,38.145)(56.526,38.130)(56.515,38.110)(56.514,38.108)(56.504,38.090)(56.494,38.072)(56.493,38.070)(56.481,38.050)(56.474,38.038)(56.470,38.030)(56.458,38.010)(56.454,38.004)(56.446,37.990)(56.434,37.970)(56.434,37.970)(56.422,37.950)(56.414,37.938)(56.409,37.930)(56.397,37.910)(56.394,37.906)(56.384,37.890)(56.374,37.875)(56.371,37.870)(56.358,37.850)(56.354,37.845)(56.344,37.830)(56.334,37.815)(56.331,37.810)(56.317,37.790)(56.314,37.786)(56.303,37.770)(56.294,37.757)(56.289,37.750)(56.275,37.730)(56.274,37.729)(56.260,37.710)(56.254,37.702)(56.245,37.690)(56.234,37.675)(56.230,37.670)(56.215,37.650)(56.214,37.649)(56.199,37.630)};
\addplot[black!46,smooth]coordinates{(54.749,37.630)(54.738,37.650)(54.734,37.658)(54.728,37.670)(54.719,37.690)(54.714,37.698)(54.709,37.710)(54.699,37.730)(54.694,37.740)(54.690,37.750)(54.680,37.770)(54.674,37.783)(54.671,37.790)(54.662,37.810)(54.654,37.828)(54.653,37.830)(54.645,37.850)(54.636,37.870)(54.634,37.874)(54.628,37.890)(54.619,37.910)(54.614,37.921)(54.611,37.930)(54.603,37.950)(54.595,37.970)(54.594,37.971)(54.587,37.990)(54.579,38.010)(54.574,38.022)(54.571,38.030)(54.564,38.050)(54.556,38.070)(54.554,38.075)(54.549,38.090)(54.542,38.110)(54.535,38.130)(54.534,38.130)(54.528,38.150)(54.521,38.170)(54.514,38.188)(54.514,38.190)(54.507,38.210)(54.500,38.230)(54.494,38.248)(54.494,38.250)(54.487,38.270)(54.481,38.290)(54.475,38.310)(54.474,38.311)(54.468,38.330)(54.462,38.350)(54.456,38.370)(54.454,38.376)(54.450,38.390)(54.445,38.410)(54.439,38.430)(54.434,38.445)(54.433,38.450)(54.428,38.470)(54.422,38.490)(54.417,38.510)(54.414,38.518)(54.411,38.530)(54.406,38.550)(54.401,38.570)(54.396,38.590)(54.394,38.595)(54.391,38.610)(54.386,38.630)(54.381,38.650)(54.376,38.670)(54.374,38.677)(54.372,38.690)(54.367,38.710)(54.362,38.730)(54.358,38.750)(54.354,38.766)(54.354,38.770)(54.349,38.790)(54.345,38.810)(54.341,38.830)(54.337,38.850)(54.334,38.861)(54.333,38.870)(54.329,38.890)(54.325,38.910)(54.321,38.930)(54.317,38.950)(54.314,38.966)(54.314,38.970)(54.310,38.990)(54.307,39.010)(54.303,39.030)(54.300,39.050)(54.297,39.070)(54.294,39.084)(54.294,39.090)(54.290,39.110)(54.287,39.130)(54.284,39.150)(54.282,39.170)(54.279,39.190)(54.276,39.210)(54.274,39.221)(54.273,39.230)(54.271,39.250)(54.268,39.270)(54.266,39.290)(54.263,39.310)(54.261,39.330)(54.259,39.350)(54.257,39.370)(54.254,39.390)(54.254,39.390)(54.252,39.410)(54.251,39.430)(54.249,39.450)(54.247,39.470)(54.245,39.490)(54.243,39.510)(54.242,39.530)(54.240,39.550)(54.239,39.570)(54.238,39.590)(54.236,39.610)(54.235,39.630)(54.234,39.642)(54.234,39.650)(54.233,39.670)(54.232,39.690)(54.231,39.710)(54.230,39.730)(54.230,39.750)(54.229,39.770)(54.228,39.790)(54.228,39.810)(54.227,39.830)(54.227,39.850)(54.227,39.870)(54.227,39.890)(54.226,39.910)(54.226,39.930)(54.227,39.950)(54.227,39.970)(54.227,39.990)(54.227,40.010)(54.228,40.030)(54.228,40.050)(54.229,40.070)(54.229,40.090)(54.230,40.110)(54.231,40.130)(54.232,40.150)(54.233,40.170)(54.234,40.190)(54.234,40.195)(54.235,40.210)(54.237,40.230)(54.238,40.250)(54.240,40.270)(54.241,40.290)(54.243,40.310)(54.245,40.330)(54.247,40.350)(54.249,40.370)(54.251,40.390)(54.253,40.410)(54.254,40.422)(54.255,40.430)(54.258,40.450)(54.260,40.470)(54.263,40.490)(54.266,40.510)(54.269,40.530)(54.272,40.550)(54.274,40.567)(54.275,40.570)(54.278,40.590)(54.281,40.610)(54.285,40.630)(54.289,40.650)(54.292,40.670)(54.294,40.680)(54.296,40.690)(54.300,40.710)(54.305,40.730)(54.309,40.750)(54.313,40.770)(54.314,40.774)(54.318,40.790)(54.323,40.810)(54.328,40.830)(54.333,40.850)(54.334,40.856)(54.338,40.870)(54.343,40.890)(54.349,40.910)(54.354,40.928)(54.355,40.930)(54.361,40.950)(54.367,40.970)(54.373,40.990)(54.374,40.993)(54.380,41.010)(54.386,41.030)(54.393,41.050)(54.394,41.052)(54.401,41.070)(54.408,41.090)(54.414,41.107)(54.416,41.110)(54.423,41.130)(54.431,41.150)(54.434,41.157)(54.440,41.170)(54.448,41.190)(54.454,41.203)(54.457,41.210)(54.466,41.230)(54.474,41.247)(54.476,41.250)(54.486,41.270)(54.494,41.287)(54.496,41.290)(54.506,41.310)(54.514,41.325)(54.517,41.330)(54.528,41.350)(54.534,41.361)(54.540,41.370)(54.552,41.390)(54.554,41.394)(54.564,41.410)(54.574,41.426)(54.577,41.430)(54.590,41.450)(54.594,41.456)(54.604,41.470)(54.614,41.484)(54.618,41.490)(54.633,41.510)(54.634,41.511)(54.649,41.530)(54.654,41.537)(54.665,41.550)(54.674,41.561)(54.682,41.570)(54.694,41.584)(54.700,41.590)(54.714,41.605)(54.719,41.610)(54.734,41.626)(54.738,41.630)(54.754,41.645)(54.759,41.650)(54.774,41.664)(54.781,41.670)(54.794,41.681)(54.804,41.690)(54.814,41.698)(54.829,41.710)(54.834,41.714)(54.854,41.729)(54.856,41.730)(54.874,41.743)(54.885,41.750)(54.894,41.756)(54.914,41.769)(54.916,41.770)(54.934,41.780)(54.951,41.790)(54.954,41.792)(54.974,41.802)(54.990,41.810)(54.994,41.812)(55.014,41.821)(55.034,41.830)(55.035,41.830)(55.054,41.838)(55.074,41.845)(55.088,41.850)(55.094,41.852)(55.114,41.858)(55.134,41.864)(55.154,41.869)(55.158,41.870)(55.174,41.873)(55.194,41.877)(55.214,41.881)(55.234,41.884)(55.254,41.887)(55.274,41.889)(55.284,41.890)(55.294,41.891)(55.314,41.892)(55.334,41.892)(55.354,41.893)(55.374,41.892)(55.394,41.892)(55.414,41.891)(55.429,41.890)(55.434,41.889)(55.454,41.887)(55.474,41.885)(55.494,41.882)(55.514,41.879)(55.534,41.875)(55.554,41.871)(55.561,41.870)(55.574,41.867)(55.594,41.862)(55.614,41.856)(55.634,41.851)(55.638,41.850)(55.654,41.845)(55.674,41.838)(55.694,41.831)(55.698,41.830)(55.714,41.824)(55.734,41.816)(55.750,41.810)(55.754,41.808)(55.774,41.799)(55.794,41.790)(55.795,41.790)(55.814,41.781)(55.834,41.771)(55.837,41.770)(55.854,41.761)(55.874,41.750)(55.875,41.750)(55.894,41.739)(55.910,41.730)(55.914,41.727)(55.934,41.715)(55.943,41.710)(55.954,41.703)(55.974,41.690)(55.975,41.690)(55.994,41.677)(56.005,41.670)(56.014,41.663)(56.033,41.650)(56.034,41.649)(56.054,41.634)(56.060,41.630)(56.074,41.619)(56.087,41.610)(56.094,41.604)(56.112,41.590)(56.114,41.588)(56.134,41.571)(56.136,41.570)(56.154,41.554)(56.160,41.550)(56.174,41.537)(56.182,41.530)(56.194,41.519)(56.204,41.510)(56.214,41.500)(56.226,41.490)(56.234,41.481)(56.247,41.470)(56.254,41.462)(56.267,41.450)(56.274,41.442)(56.286,41.430)(56.294,41.421)(56.306,41.410)(56.314,41.400)(56.324,41.390)(56.334,41.379)(56.342,41.370)(56.354,41.356)(56.360,41.350)(56.374,41.334)(56.378,41.330)(56.394,41.310)(56.395,41.310)(56.411,41.290)(56.414,41.286)(56.428,41.270)(56.434,41.261)(56.444,41.250)(56.454,41.236)(56.459,41.230)(56.474,41.210)(56.475,41.210)(56.489,41.190)(56.494,41.183)(56.504,41.170)(56.514,41.155)(56.519,41.150)(56.533,41.130)(56.534,41.127)(56.547,41.110)(56.554,41.098)(56.560,41.090)(56.574,41.070)(56.574,41.068)(56.587,41.050)(56.594,41.038)(56.599,41.030)(56.612,41.010)(56.614,41.006)(56.624,40.990)(56.634,40.974)(56.637,40.970)(56.649,40.950)(56.654,40.940)};
\addplot[black!28,smooth]coordinates{(54.273,37.630)(54.264,37.650)(54.255,37.670)(54.254,37.670)(54.246,37.690)(54.236,37.710)(54.234,37.714)(54.227,37.730)(54.218,37.750)(54.214,37.759)(54.210,37.770)(54.201,37.790)(54.194,37.805)(54.192,37.810)(54.184,37.830)(54.175,37.850)(54.174,37.852)(54.167,37.870)(54.159,37.890)(54.154,37.900)(54.151,37.910)(54.143,37.930)(54.135,37.950)(54.134,37.950)(54.127,37.970)(54.119,37.990)(54.114,38.001)(54.111,38.010)(54.103,38.030)(54.096,38.050)(54.094,38.054)(54.088,38.070)(54.081,38.090)(54.074,38.108)(54.074,38.110)(54.066,38.130)(54.059,38.150)(54.054,38.163)(54.052,38.170)(54.045,38.190)(54.038,38.210)(54.034,38.221)(54.031,38.230)(54.025,38.250)(54.018,38.270)(54.014,38.280)(54.011,38.290)(54.005,38.310)(53.998,38.330)(53.994,38.342)(53.992,38.350)(53.985,38.370)(53.979,38.390)(53.974,38.405)(53.973,38.410)(53.967,38.430)(53.961,38.450)(53.955,38.470)(53.954,38.471)(53.949,38.490)(53.943,38.510)(53.937,38.530)(53.934,38.539)(53.931,38.550)(53.926,38.570)(53.920,38.590)(53.914,38.610)(53.914,38.610)(53.909,38.630)(53.904,38.650)(53.898,38.670)(53.894,38.684)(53.893,38.690)(53.888,38.710)(53.882,38.730)(53.877,38.750)(53.874,38.761)(53.872,38.770)(53.867,38.790)(53.862,38.810)(53.857,38.830)(53.854,38.842)(53.853,38.850)(53.848,38.870)(53.843,38.890)(53.839,38.910)(53.834,38.928)(53.834,38.930)(53.830,38.950)(53.825,38.970)(53.821,38.990)(53.816,39.010)(53.814,39.018)(53.812,39.030)(53.808,39.050)(53.804,39.070)(53.799,39.090)(53.795,39.110)(53.794,39.115)(53.791,39.130)(53.787,39.150)(53.784,39.170)(53.780,39.190)(53.776,39.210)(53.774,39.218)(53.772,39.230)(53.769,39.250)(53.765,39.270)(53.761,39.290)(53.758,39.310)(53.754,39.330)(53.754,39.330)(53.751,39.350)(53.748,39.370)(53.744,39.390)(53.741,39.410)(53.738,39.430)(53.735,39.450)(53.734,39.453)(53.732,39.470)(53.729,39.490)(53.726,39.510)(53.723,39.530)(53.720,39.550)(53.717,39.570)(53.715,39.590)(53.714,39.592)(53.712,39.610)(53.709,39.630)(53.707,39.650)(53.704,39.670)(53.702,39.690)(53.699,39.710)(53.697,39.730)(53.695,39.750)(53.694,39.753)(53.693,39.770)(53.690,39.790)(53.688,39.810)(53.686,39.830)(53.684,39.850)(53.682,39.870)(53.680,39.890)(53.678,39.910)(53.677,39.930)(53.675,39.950)(53.674,39.955)(53.673,39.970)(53.672,39.990)(53.670,40.010)(53.668,40.030)(53.667,40.050)(53.666,40.070)(53.664,40.090)(53.663,40.110)(53.662,40.130)(53.661,40.150)(53.659,40.170)(53.658,40.190)(53.657,40.210)(53.656,40.230)(53.656,40.250)(53.655,40.270)(53.654,40.278)(53.654,40.290)(53.653,40.310)(53.653,40.330)(53.652,40.350)(53.652,40.370)(53.651,40.390)(53.651,40.410)(53.650,40.430)(53.650,40.450)(53.650,40.470)(53.650,40.490)(53.650,40.510)(53.650,40.530)(53.650,40.550)(53.650,40.570)(53.650,40.590)(53.650,40.610)(53.650,40.630)(53.651,40.650)(53.651,40.670)(53.652,40.690)(53.652,40.710)(53.653,40.730)(53.653,40.750)(53.654,40.770)(53.654,40.773)(53.655,40.790)(53.656,40.810)(53.657,40.830)(53.658,40.850)(53.659,40.870)(53.660,40.890)(53.662,40.910)(53.663,40.930)(53.664,40.950)(53.666,40.970)(53.668,40.990)(53.669,41.010)(53.671,41.030)(53.673,41.050)(53.674,41.067)(53.675,41.070)(53.677,41.090)(53.679,41.110)(53.681,41.130)(53.683,41.150)(53.685,41.170)(53.688,41.190)(53.690,41.210)(53.693,41.230)(53.694,41.240)(53.696,41.250)(53.698,41.270)(53.701,41.290)(53.704,41.310)(53.707,41.330)(53.711,41.350)(53.714,41.370)(53.714,41.373)(53.717,41.390)(53.721,41.410)(53.724,41.430)(53.728,41.450)(53.732,41.470)(53.734,41.482)(53.736,41.490)(53.740,41.510)(53.744,41.530)(53.748,41.550)(53.753,41.570)(53.754,41.577)(53.757,41.590)(53.762,41.610)(53.767,41.630)(53.772,41.650)(53.774,41.661)(53.777,41.670)(53.782,41.690)(53.787,41.710)(53.793,41.730)(53.794,41.736)(53.798,41.750)(53.804,41.770)(53.810,41.790)(53.814,41.804)(53.816,41.810)(53.822,41.830)(53.829,41.850)(53.834,41.867)(53.835,41.870)(53.842,41.890)(53.849,41.910)(53.854,41.924)(53.856,41.930)(53.864,41.950)(53.871,41.970)(53.874,41.978)(53.879,41.990)(53.887,42.010)(53.894,42.028)(53.895,42.030)(53.903,42.050)(53.912,42.070)(53.914,42.075)(53.921,42.090)(53.930,42.110)(53.934,42.119)(53.939,42.130)(53.949,42.150)(53.954,42.161)(53.959,42.170)(53.969,42.190)(53.974,42.200)(53.980,42.210)(53.990,42.230)(53.994,42.237)(54.001,42.250)(54.013,42.270)(54.014,42.272)(54.025,42.290)(54.034,42.306)(54.037,42.310)(54.050,42.330)(54.054,42.337)(54.062,42.350)(54.074,42.368)(54.076,42.370)(54.090,42.390)(54.094,42.396)(54.104,42.410)(54.114,42.424)(54.119,42.430)(54.134,42.450)(54.134,42.450)(54.150,42.470)(54.154,42.475)(54.167,42.490)(54.174,42.499)(54.184,42.510)(54.194,42.522)(54.202,42.530)(54.214,42.543)(54.220,42.550)(54.234,42.564)(54.240,42.570)(54.254,42.584)(54.260,42.590)(54.274,42.603)(54.281,42.610)(54.294,42.621)(54.304,42.630)(54.314,42.639)(54.327,42.650)(54.334,42.656)(54.352,42.670)(54.354,42.672)(54.374,42.687)(54.378,42.690)(54.394,42.702)(54.406,42.710)(54.414,42.716)(54.434,42.729)(54.436,42.730)(54.454,42.742)(54.468,42.750)(54.474,42.754)(54.494,42.765)(54.502,42.770)(54.514,42.776)(54.534,42.787)(54.540,42.790)(54.554,42.797)(54.574,42.806)(54.582,42.810)(54.594,42.815)(54.614,42.824)(54.629,42.830)(54.634,42.832)(54.654,42.839)(54.674,42.846)(54.684,42.850)(54.694,42.853)(54.714,42.859)(54.734,42.865)(54.751,42.870)(54.754,42.871)(54.774,42.876)(54.794,42.880)(54.814,42.884)(54.834,42.888)(54.842,42.890)(54.854,42.892)(54.874,42.895)(54.894,42.898)(54.914,42.900)(54.934,42.902)(54.954,42.904)(54.974,42.905)(54.994,42.906)(55.014,42.907)(55.034,42.907)(55.054,42.907)(55.074,42.907)(55.094,42.906)(55.114,42.905)(55.134,42.904)(55.154,42.902)(55.174,42.900)(55.194,42.898)(55.214,42.895)(55.234,42.893)(55.253,42.890)(55.254,42.889)(55.274,42.886)(55.294,42.882)(55.314,42.878)(55.334,42.874)(55.351,42.870)(55.354,42.869)(55.374,42.864)(55.394,42.859)(55.414,42.853)(55.426,42.850)(55.434,42.847)(55.454,42.841)(55.474,42.834)(55.488,42.830)(55.494,42.828)(55.514,42.820)(55.534,42.813)(55.543,42.810)(55.554,42.805)(55.574,42.797)(55.593,42.790)(55.594,42.789)(55.614,42.780)(55.634,42.771)(55.638,42.770)(55.654,42.762)(55.674,42.753)(55.680,42.750)(55.694,42.743)(55.714,42.733)(55.720,42.730)(55.734,42.722)(55.754,42.711)(55.757,42.710)(55.774,42.700)(55.793,42.690)(55.794,42.689)(55.814,42.677)(55.827,42.670)(55.834,42.665)(55.854,42.653)(55.859,42.650)(55.874,42.640)(55.890,42.630)(55.894,42.627)(55.914,42.614)(55.920,42.610)(55.934,42.600)(55.949,42.590)(55.954,42.586)(55.974,42.571)(55.977,42.570)(55.994,42.557)(56.004,42.550)(56.014,42.542)(56.030,42.530)(56.034,42.526)(56.054,42.510)(56.055,42.510)(56.074,42.494)(56.080,42.490)(56.094,42.478)(56.104,42.470)(56.114,42.461)(56.128,42.450)(56.134,42.444)(56.150,42.430)(56.154,42.426)(56.173,42.410)(56.174,42.408)(56.194,42.390)(56.195,42.390)(56.214,42.371)(56.216,42.370)(56.234,42.352)(56.237,42.350)(56.254,42.332)(56.257,42.330)(56.274,42.312)(56.277,42.310)(56.294,42.292)(56.296,42.290)(56.314,42.271)(56.316,42.270)(56.334,42.250)(56.334,42.250)(56.353,42.230)(56.354,42.228)(56.371,42.210)(56.374,42.206)(56.389,42.190)(56.394,42.183)(56.406,42.170)(56.414,42.160)(56.423,42.150)(56.434,42.136)(56.440,42.130)(56.454,42.112)(56.457,42.110)(56.473,42.090)(56.474,42.088)(56.489,42.070)(56.494,42.063)(56.504,42.050)(56.514,42.037)(56.520,42.030)(56.534,42.011)(56.535,42.010)(56.550,41.990)(56.554,41.984)(56.565,41.970)(56.574,41.957)(56.579,41.950)(56.594,41.930)(56.594,41.929)(56.608,41.910)(56.614,41.900)(56.622,41.890)(56.634,41.871)(56.635,41.870)(56.649,41.850)(56.654,41.841)};
\addplot[black!10,smooth]coordinates{(53.403,37.630)(53.394,37.650)(53.394,37.650)(53.386,37.670)(53.378,37.690)(53.374,37.697)(53.369,37.710)(53.361,37.730)(53.354,37.746)(53.353,37.750)(53.345,37.770)(53.337,37.790)(53.334,37.795)(53.329,37.810)(53.321,37.830)(53.314,37.845)(53.313,37.850)(53.305,37.870)(53.297,37.890)(53.294,37.896)(53.289,37.910)(53.282,37.930)(53.274,37.949)(53.274,37.950)(53.266,37.970)(53.259,37.990)(53.254,38.002)(53.252,38.010)(53.244,38.030)(53.237,38.050)(53.234,38.056)(53.230,38.070)(53.222,38.090)(53.215,38.110)(53.214,38.112)(53.208,38.130)(53.201,38.150)(53.194,38.168)(53.194,38.170)(53.187,38.190)(53.180,38.210)(53.174,38.226)(53.173,38.230)(53.166,38.250)(53.160,38.270)(53.154,38.285)(53.153,38.290)(53.146,38.310)(53.140,38.330)(53.134,38.346)(53.133,38.350)(53.127,38.370)(53.120,38.390)(53.114,38.408)(53.114,38.410)(53.107,38.430)(53.101,38.450)(53.095,38.470)(53.094,38.471)(53.089,38.490)(53.083,38.510)(53.076,38.530)(53.074,38.536)(53.070,38.550)(53.064,38.570)(53.058,38.590)(53.054,38.603)(53.052,38.610)(53.046,38.630)(53.041,38.650)(53.035,38.670)(53.034,38.671)(53.029,38.690)(53.023,38.710)(53.018,38.730)(53.014,38.741)(53.012,38.750)(53.006,38.770)(53.001,38.790)(52.995,38.810)(52.994,38.813)(52.990,38.830)(52.985,38.850)(52.979,38.870)(52.974,38.888)(52.974,38.890)(52.969,38.910)(52.963,38.930)(52.958,38.950)(52.954,38.964)(52.953,38.970)(52.948,38.990)(52.943,39.010)(52.938,39.030)(52.934,39.043)(52.933,39.050)(52.928,39.070)(52.923,39.090)(52.918,39.110)(52.914,39.124)(52.913,39.130)(52.908,39.150)(52.904,39.170)(52.899,39.190)(52.894,39.209)(52.894,39.210)(52.890,39.230)(52.885,39.250)(52.880,39.270)(52.876,39.290)(52.874,39.296)(52.871,39.310)(52.867,39.330)(52.862,39.350)(52.858,39.370)(52.854,39.387)(52.854,39.390)(52.849,39.410)(52.845,39.430)(52.841,39.450)(52.837,39.470)(52.834,39.481)(52.833,39.490)(52.829,39.510)(52.825,39.530)(52.820,39.550)(52.816,39.570)(52.814,39.580)(52.813,39.590)(52.809,39.610)(52.805,39.630)(52.801,39.650)(52.797,39.670)(52.794,39.683)(52.793,39.690)(52.790,39.710)(52.786,39.730)(52.782,39.750)(52.778,39.770)(52.775,39.790)(52.774,39.792)(52.771,39.810)(52.768,39.830)(52.764,39.850)(52.761,39.870)(52.757,39.890)(52.754,39.907)(52.754,39.910)(52.751,39.930)(52.747,39.950)(52.744,39.970)(52.741,39.990)(52.738,40.010)(52.734,40.030)(52.734,40.030)(52.731,40.050)(52.728,40.070)(52.725,40.090)(52.722,40.110)(52.719,40.130)(52.716,40.150)(52.714,40.161)(52.713,40.170)(52.710,40.190)(52.707,40.210)(52.705,40.230)(52.702,40.250)(52.699,40.270)(52.696,40.290)(52.694,40.304)(52.694,40.310)(52.691,40.330)(52.688,40.350)(52.686,40.370)(52.683,40.390)(52.681,40.410)(52.678,40.430)(52.676,40.450)(52.674,40.460)(52.673,40.470)(52.671,40.490)(52.669,40.510)(52.666,40.530)(52.664,40.550)(52.662,40.570)(52.659,40.590)(52.657,40.610)(52.655,40.630)(52.654,40.636)(52.653,40.650)(52.651,40.670)(52.649,40.690)(52.647,40.710)(52.645,40.730)(52.643,40.750)(52.641,40.770)(52.639,40.790)(52.637,40.810)(52.635,40.830)(52.634,40.842)(52.634,40.850)(52.632,40.870)(52.630,40.890)(52.629,40.910)(52.627,40.930)(52.625,40.950)(52.624,40.970)(52.622,40.990)(52.621,41.010)(52.619,41.030)(52.618,41.050)(52.616,41.070)(52.615,41.090)(52.614,41.099)(52.614,41.110)(52.612,41.130)(52.611,41.150)(52.610,41.170)(52.609,41.190)(52.608,41.210)(52.606,41.230)(52.605,41.250)(52.604,41.270)(52.603,41.290)(52.602,41.310)(52.601,41.330)(52.600,41.350)(52.600,41.370)(52.599,41.390)(52.598,41.410)(52.597,41.430)(52.596,41.450)(52.596,41.470)(52.595,41.490)(52.595,41.510)(52.594,41.513)(52.594,41.530)(52.593,41.550)(52.593,41.570)(52.592,41.590)(52.592,41.610)(52.592,41.630)(52.591,41.650)(52.591,41.670)(52.591,41.690)(52.590,41.710)(52.590,41.730)(52.590,41.750)(52.590,41.770)(52.590,41.790)(52.590,41.810)(52.590,41.830)(52.590,41.850)(52.590,41.870)(52.590,41.890)(52.590,41.910)(52.590,41.930)(52.591,41.950)(52.591,41.970)(52.591,41.990)(52.592,42.010)(52.592,42.030)(52.592,42.050)(52.593,42.070)(52.593,42.090)(52.594,42.110)(52.594,42.122)(52.595,42.130)(52.595,42.150)(52.596,42.170)(52.597,42.190)(52.598,42.210)(52.598,42.230)(52.599,42.250)(52.600,42.270)(52.601,42.290)(52.602,42.310)(52.604,42.330)(52.605,42.350)(52.606,42.370)(52.607,42.390)(52.608,42.410)(52.610,42.430)(52.611,42.450)(52.613,42.470)(52.614,42.490)(52.614,42.493)(52.616,42.510)(52.617,42.530)(52.619,42.550)(52.621,42.570)(52.623,42.590)(52.624,42.610)(52.626,42.630)(52.628,42.650)(52.630,42.670)(52.632,42.690)(52.634,42.708)(52.635,42.710)(52.637,42.730)(52.639,42.750)(52.642,42.770)(52.644,42.790)(52.646,42.810)(52.649,42.830)(52.652,42.850)(52.654,42.870)(52.654,42.870)(52.657,42.890)(52.660,42.910)(52.663,42.930)(52.666,42.950)(52.669,42.970)(52.672,42.990)(52.674,43.003)(52.676,43.010)(52.679,43.030)(52.682,43.050)(52.686,43.070)(52.689,43.090)(52.693,43.110)(52.694,43.116)(52.697,43.130)(52.701,43.150)(52.705,43.170)(52.709,43.190)(52.713,43.210)(52.714,43.215)(52.718,43.230)(52.722,43.250)(52.727,43.270)(52.731,43.290)(52.734,43.303)(52.736,43.310)(52.741,43.330)(52.746,43.350)(52.751,43.370)(52.754,43.383)(52.756,43.390)(52.762,43.410)(52.767,43.430)(52.773,43.450)(52.774,43.455)(52.779,43.470)(52.785,43.490)(52.791,43.510)(52.794,43.520)(52.797,43.530)(52.804,43.550)(52.811,43.570)(52.814,43.581)(52.817,43.590)(52.824,43.610)(52.832,43.630)(52.834,43.637)(52.839,43.650)(52.847,43.670)(52.854,43.689)(52.854,43.690)(52.863,43.710)(52.871,43.730)(52.874,43.738)(52.879,43.750)(52.888,43.770)(52.894,43.784)(52.897,43.790)(52.906,43.810)(52.914,43.826)(52.916,43.830)(52.926,43.850)(52.934,43.867)(52.936,43.870)(52.946,43.890)(52.954,43.905)(52.957,43.910)(52.968,43.930)(52.974,43.940)(52.980,43.950)(52.992,43.970)(52.994,43.974)(53.004,43.990)(53.014,44.007)(53.016,44.010)(53.029,44.030)(53.034,44.037)(53.043,44.050)(53.054,44.066)(53.057,44.070)(53.071,44.090)(53.074,44.094)(53.086,44.110)(53.094,44.120)(53.102,44.130)(53.114,44.146)(53.118,44.150)(53.134,44.170)(53.134,44.170)(53.152,44.190)(53.154,44.193)(53.170,44.210)(53.174,44.215)(53.188,44.230)(53.194,44.236)(53.208,44.250)(53.214,44.256)(53.228,44.270)(53.234,44.276)(53.249,44.290)(53.254,44.295)(53.271,44.310)(53.274,44.313)(53.294,44.330)(53.294,44.330)(53.314,44.347)(53.318,44.350)(53.334,44.363)(53.343,44.370)(53.354,44.378)(53.370,44.390)(53.374,44.393)(53.394,44.408)(53.397,44.410)(53.414,44.421)(53.427,44.430)(53.434,44.435)(53.454,44.448)(53.458,44.450)(53.474,44.460)(53.491,44.470)(53.494,44.472)(53.514,44.483)(53.525,44.490)(53.534,44.495)(53.554,44.505)(53.563,44.510)(53.574,44.516)(53.594,44.526)(53.603,44.530)(53.614,44.535)(53.634,44.545)(53.646,44.550)(53.654,44.553)(53.674,44.562)(53.693,44.570)(53.694,44.570)(53.714,44.578)(53.734,44.586)(53.744,44.590)(53.754,44.593)(53.774,44.601)(53.794,44.607)(53.801,44.610)(53.814,44.614)(53.834,44.620)(53.854,44.626)(53.866,44.630)(53.874,44.632)(53.894,44.637)(53.914,44.643)(53.934,44.648)(53.943,44.650)(53.954,44.652)(53.974,44.657)(53.994,44.661)(54.014,44.665)(54.034,44.669)(54.037,44.670)(54.054,44.673)(54.074,44.676)(54.094,44.679)(54.114,44.682)(54.134,44.685)(54.154,44.688)(54.171,44.690)(54.174,44.690)(54.194,44.692)(54.214,44.694)(54.234,44.696)(54.254,44.697)(54.274,44.699)(54.294,44.700)(54.314,44.701)(54.334,44.702)(54.354,44.702)(54.374,44.703)(54.394,44.703)(54.414,44.703)(54.434,44.703)(54.454,44.702)(54.474,44.702)(54.494,44.701)(54.514,44.700)(54.534,44.699)(54.554,44.698)(54.574,44.696)(54.594,44.695)(54.614,44.693)(54.634,44.691)(54.647,44.690)(54.654,44.689)(54.674,44.687)(54.694,44.684)(54.714,44.681)(54.734,44.678)(54.754,44.675)(54.774,44.672)(54.789,44.670)(54.794,44.669)(54.814,44.665)(54.834,44.661)(54.854,44.657)(54.874,44.653)(54.891,44.650)(54.894,44.649)(54.914,44.645)(54.934,44.640)(54.954,44.635)(54.974,44.630)(54.976,44.630)(54.994,44.625)(55.014,44.619)(55.034,44.614)(55.049,44.610)(55.054,44.608)(55.074,44.602)(55.094,44.596)(55.114,44.590)(55.115,44.590)(55.134,44.583)(55.154,44.577)(55.174,44.570)(55.175,44.570)(55.194,44.563)(55.214,44.556)(55.231,44.550)(55.234,44.548)(55.254,44.541)(55.274,44.533)(55.283,44.530)(55.294,44.525)(55.314,44.517)(55.332,44.510)(55.334,44.509)(55.354,44.500)(55.374,44.491)(55.378,44.490)(55.394,44.482)(55.414,44.473)(55.422,44.470)(55.434,44.464)(55.454,44.455)(55.464,44.450)(55.474,44.445)(55.494,44.435)(55.505,44.430)(55.514,44.425)(55.534,44.415)(55.544,44.410)(55.554,44.404)(55.574,44.393)(55.581,44.390)(55.594,44.383)(55.614,44.371)(55.618,44.370)(55.634,44.360)(55.653,44.350)(55.654,44.349)(55.674,44.337)(55.687,44.330)(55.694,44.325)(55.714,44.313)(55.720,44.310)(55.734,44.300)(55.752,44.290)(55.754,44.288)(55.774,44.275)(55.783,44.270)(55.794,44.262)(55.813,44.250)(55.814,44.249)(55.834,44.235)(55.843,44.230)(55.854,44.222)(55.872,44.210)(55.874,44.208)(55.894,44.194)(55.900,44.190)(55.914,44.179)(55.927,44.170)(55.934,44.165)(55.954,44.150)(55.954,44.150)(55.974,44.135)(55.981,44.130)(55.994,44.119)(56.007,44.110)(56.014,44.104)(56.032,44.090)(56.034,44.088)(56.054,44.072)(56.057,44.070)(56.074,44.055)(56.081,44.050)(56.094,44.039)(56.105,44.030)(56.114,44.022)(56.129,44.010)(56.134,44.005)(56.152,43.990)(56.154,43.988)(56.174,43.970)(56.175,43.970)(56.194,43.952)(56.197,43.950)(56.214,43.934)(56.219,43.930)(56.234,43.915)(56.241,43.910)(56.254,43.897)(56.262,43.890)(56.274,43.878)(56.283,43.870)(56.294,43.858)(56.303,43.850)(56.314,43.839)(56.324,43.830)(56.334,43.819)(56.344,43.810)(56.354,43.799)(56.363,43.790)(56.374,43.778)(56.383,43.770)(56.394,43.757)(56.402,43.750)(56.414,43.736)(56.421,43.730)(56.434,43.715)(56.439,43.710)(56.454,43.693)(56.458,43.690)(56.474,43.671)(56.476,43.670)(56.493,43.650)(56.494,43.649)(56.511,43.630)(56.514,43.626)(56.528,43.610)(56.534,43.603)(56.546,43.590)(56.554,43.579)(56.563,43.570)(56.574,43.555)(56.579,43.550)(56.594,43.531)(56.596,43.530)(56.612,43.510)(56.614,43.507)(56.628,43.490)(56.634,43.482)(56.644,43.470)(56.654,43.457)};

%% местонахождение городов
\addplot[ball darkblue,only marks]coordinates{(55.664,37.630)}
node[below,text=black]{Москва};
\addplot[ball darkblue,only marks]coordinates{(51.534,46.031)}
node[above,text=black]{Саратов};
\addplot[ball darkblue,only marks]coordinates{(56.671,39.162)}
node[above,text=black]{Воронеж};
\begin{scope}[font=\footnotesize]
%% начальная точка
%\addplot[darkred,mark=*,mark size=2.5pt]
\addplot[ball darkred]
coordinates{(\phiStart,\lambdaStart)}
node[above]{$(\phi_0,\lambda_0)$}
node[below left]{склад};
%% смещение по phi
\addplot[->,gray,thin,dashed,opacity=0.5]
coordinates{(\phiStart,\lambdaStart) (\phiMin,\lambdaStart)}
node[above,opacity=1,text=darkred]{$(\phi_{\min},\lambda_0)$};;
%% смещение по lambda
\addplot[->,gray,thin,dashed,opacity=0.5]
coordinates{(\phiMin,\lambdaStart) (\phiMin,\lambdaMin)};
%% конечное положение
\addplot[darkred]
coordinates{(\phiMin,\lambdaMin)}
node[below]{$(\phi_{\min},\lambda_{\min})$};
\end{scope}
%% результирующее смещение
\addplot[darkred,->]
coordinates{(\phiStart,\lambdaStart) (\phiMin,\lambdaMin)}
node[sloped,pos=0.5,above]{$\xi$};
\end{axis}
\end{tikzpicture}
\caption{``Рельеф`` целевой функции $r(\phi,\lambda)$ и 
``траектория`` поиска местоположения склада $(\phi,\lambda)$
торговой сети (маркерами обозначены города)}
\label{fig:min1}
\end{figure}


%
% новое положение склада
%
\def\phiStart{54.66658}
\def\lambdaStart{39.49103}
% частный минимум phi
\def\phiMin{55.94734}
% частный минимум lambda
\def\lambdaMin{38.88818}
% epsilon
\def\epsilonOne{1.41555}
%
\item
За новое местоположение склада торговой сети 
принимается положение ``частного`` минимума 
целевой функции на предыдущем шаге итерационного процесса:
\begin{equation*}
\left\{\begin{matrix}[lcl]
\phi_0 = \phi_{\min}&=&\phiStart\\
\lambda_0 = \lambda_{\min}&=&\lambdaStart\\
\end{matrix}\right.
\end{equation*}

\item
Считаем постоянными значения долготы склада 
$\lambda=\lambda_0=\const$
и рассматриваем вспомогательную функцию
только одной переменной $\phi$:
\begin{equation*}
\rho_1(\phi)=f(\phi, \lambda_0)=f(\phi,\lambdaStart)
\end{equation*}

Находим минимум вспомогательной функции 
одной переменной $\rho_1(\phi)$, используя метод 
одномерной минимизации:
\begin{equation*}
\phi_{\min}
=\arg\left(
\min_{\phi_{\inf}\leqslant\phi\leqslant\phi_{\sup}}\rho_1(\phi)
\right)
=\phiMin
\end{equation*}
где $\phi_{\min}$ -- положение ``частного`` минимума
функции $f(\phi, \lambdaStart)$.

Считаем постоянными значения широты склада 
$\phi=\phi_{\min}=\const$ 
и рассматриваем вторую вспомогательную функцию
только одной переменной $\lambda$:
\begin{equation*}
\rho_2(\lambda)=f(\phi_{\min},\lambda)=f(\phiMin,\lambda)
\end{equation*}

Находим минимум функции одной переменной $\rho_2(\lambda)$,
используя метод одномерной минимизации:
\begin{equation*}
\lambda_{\min}
=\arg\left(
\min_{\lambda_{\inf}\leqslant\lambda\leqslant\lambda_{\sup}}\rho_2(\lambda)
\right)
=\lambdaMin
\end{equation*}
где $\lambda_{\min}$ -- положение ``частного`` минимума
функции $f(\phiMin,\lambda)$.

\item
Определяем изменение местоположения склада 
\eqref{eq:GCS:step error} в результате проведенных 
итерационных процессов (рисунок \ref{fig:min2}):
\begin{equation*}
\begin{split}
\xi=\;
&\sqrt{(\phi_{\min}-\phi_0)^2+(\lambda_{\min}-\lambda_0)^2}=\\
=\;&\sqrt{(\phiMin-\phiStart)^2+(\lambdaMin-\lambdaStart)^2}=\\
=\;&\epsilonOne\\
\end{split}
\end{equation*}


Находим значение целевой функции в начальной 
$f(\phi_0,\lambda_0)$ и конечной точки 
$f(\phi_{\min},\lambda_{\min})$ точках 
местоположения склада:
\begin{equation*}
\begin{matrix}[lclcl]
f(\phi_0,\lambda_0)&=&f(\phiStart,\lambdaStart)&=&944.004\\
f(\phi_{\min},\lambda_{\min})&=&f(\phiMin,\lambdaMin)&=&845.572\\
\end{matrix}
\end{equation*}

Сравниваем величину текущего ``шага`` $\xi$ и 
заданную точность расчетов $\epsilon_1$,
а также значения целевой функции $f(\phi,\lambda)$ в начальной
и конечной точки итерационного процесса:
\begin{equation*}
\begin{matrix}[rcl]
\epsilon_1=0.1&<&\xi=\epsilonOne\\
f(\phi_{\min},\lambda_{\min})=845.572&<&f(\phi_0,\lambda_0)=944.004\\
\end{matrix}
\end{equation*}

Критерий остановки итерационного процесса 
\eqref{eq:stop condition} не выполняется,
следовательно, \emph{итерационный процесс продолжаем}!

%
% График: траектория поиска минимума
%
\begin{figure}[H]\centering
\begin{tikzpicture}
[>={Straight Barb[angle=45:1.5mm 1]},shorten >=0pt,shorten <=0pt]
\begin{axis}[enlargelimits=0.2,grid=none,
xlabel={широта $\phi$},ylabel={долгота $\lambda$},
xmin=54.25,xmax=56.75,xtick={54,55,56,57},
ymin=37.25,ymax=39.75,ytick={37,38,39,40},
]
%% изолинии
\addplot[black!100,smooth]coordinates{(55.714,38.150)(55.734,38.145)(55.754,38.149)(55.756,38.150)(55.774,38.158)(55.790,38.170)(55.794,38.173)(55.814,38.190)(55.814,38.190)(55.833,38.210)(55.834,38.211)(55.851,38.230)(55.854,38.233)(55.868,38.250)(55.874,38.258)(55.884,38.270)(55.894,38.284)(55.899,38.290)(55.914,38.310)(55.914,38.310)(55.928,38.330)(55.934,38.339)(55.942,38.350)(55.954,38.368)(55.956,38.370)(55.969,38.390)(55.974,38.398)(55.982,38.410)(55.994,38.429)(55.995,38.430)(56.008,38.450)(56.014,38.461)(56.020,38.470)(56.032,38.490)(56.034,38.493)(56.044,38.510)(56.054,38.527)(56.056,38.530)(56.068,38.550)(56.074,38.561)(56.079,38.570)(56.091,38.590)(56.094,38.596)(56.102,38.610)(56.113,38.630)(56.114,38.633)(56.123,38.650)(56.134,38.670)(56.134,38.671)(56.144,38.690)(56.154,38.710)(56.154,38.710)(56.164,38.730)(56.174,38.750)(56.174,38.751)(56.183,38.770)(56.192,38.790)(56.194,38.795)(56.201,38.810)(56.209,38.830)(56.214,38.843)(56.217,38.850)(56.225,38.870)(56.232,38.890)(56.234,38.896)(56.239,38.910)(56.245,38.930)(56.251,38.950)(56.254,38.963)(56.256,38.970)(56.261,38.990)(56.264,39.010)(56.267,39.030)(56.269,39.050)(56.270,39.070)(56.270,39.090)(56.268,39.110)(56.266,39.130)(56.262,39.150)(56.257,39.170)(56.254,39.177)(56.250,39.190)(56.242,39.210)(56.234,39.225)(56.232,39.230)(56.220,39.250)(56.214,39.258)(56.206,39.270)(56.194,39.285)(56.191,39.290)(56.174,39.308)(56.173,39.310)(56.154,39.327)(56.152,39.330)(56.134,39.344)(56.127,39.350)(56.114,39.358)(56.096,39.370)(56.094,39.371)(56.074,39.381)(56.056,39.390)(56.054,39.390)(56.034,39.397)(56.014,39.403)(55.994,39.407)(55.974,39.410)(55.972,39.410)(55.954,39.410)(55.934,39.410)(55.934,39.410)(55.914,39.407)(55.894,39.403)(55.874,39.397)(55.855,39.390)(55.854,39.389)(55.834,39.380)(55.817,39.370)(55.814,39.368)(55.794,39.354)(55.790,39.350)(55.774,39.337)(55.767,39.330)(55.754,39.317)(55.747,39.310)(55.734,39.295)(55.730,39.290)(55.715,39.270)(55.714,39.268)(55.702,39.250)(55.694,39.237)(55.690,39.230)(55.679,39.210)(55.674,39.201)(55.669,39.190)(55.659,39.170)(55.654,39.158)(55.651,39.150)(55.643,39.130)(55.636,39.110)(55.634,39.106)(55.629,39.090)(55.623,39.070)(55.617,39.050)(55.614,39.039)(55.612,39.030)(55.607,39.010)(55.603,38.990)(55.599,38.970)(55.595,38.950)(55.594,38.945)(55.592,38.930)(55.589,38.910)(55.587,38.890)(55.584,38.870)(55.582,38.850)(55.580,38.830)(55.579,38.810)(55.578,38.790)(55.577,38.770)(55.576,38.750)(55.576,38.730)(55.576,38.710)(55.576,38.690)(55.576,38.670)(55.577,38.650)(55.578,38.630)(55.579,38.610)(55.580,38.590)(55.582,38.570)(55.584,38.550)(55.586,38.530)(55.588,38.510)(55.590,38.490)(55.593,38.470)(55.594,38.461)(55.596,38.450)(55.600,38.430)(55.603,38.410)(55.607,38.390)(55.611,38.370)(55.614,38.356)(55.616,38.350)(55.621,38.330)(55.627,38.310)(55.632,38.290)(55.634,38.282)(55.639,38.270)(55.646,38.250)(55.654,38.230)(55.654,38.228)(55.664,38.210)(55.674,38.190)(55.674,38.189)(55.690,38.170)(55.694,38.164)(55.714,38.150)};
\addplot[black!82,smooth]coordinates{(55.527,37.630)(55.515,37.650)(55.514,37.650)(55.503,37.670)(55.494,37.685)(55.492,37.690)(55.481,37.710)(55.474,37.723)(55.471,37.730)(55.461,37.750)(55.454,37.764)(55.452,37.770)(55.442,37.790)(55.434,37.808)(55.433,37.810)(55.425,37.830)(55.416,37.850)(55.414,37.855)(55.408,37.870)(55.400,37.890)(55.394,37.905)(55.393,37.910)(55.385,37.930)(55.378,37.950)(55.374,37.959)(55.371,37.970)(55.364,37.990)(55.357,38.010)(55.354,38.017)(55.350,38.030)(55.344,38.050)(55.337,38.070)(55.334,38.079)(55.331,38.090)(55.325,38.110)(55.319,38.130)(55.314,38.147)(55.314,38.150)(55.308,38.170)(55.303,38.190)(55.297,38.210)(55.294,38.221)(55.292,38.230)(55.287,38.250)(55.282,38.270)(55.278,38.290)(55.274,38.303)(55.273,38.310)(55.269,38.330)(55.264,38.350)(55.260,38.370)(55.256,38.390)(55.254,38.397)(55.252,38.410)(55.248,38.430)(55.245,38.450)(55.241,38.470)(55.238,38.490)(55.234,38.509)(55.234,38.510)(55.231,38.530)(55.228,38.550)(55.225,38.570)(55.222,38.590)(55.220,38.610)(55.217,38.630)(55.215,38.650)(55.214,38.653)(55.213,38.670)(55.210,38.690)(55.208,38.710)(55.207,38.730)(55.205,38.750)(55.203,38.770)(55.202,38.790)(55.200,38.810)(55.199,38.830)(55.198,38.850)(55.197,38.870)(55.196,38.890)(55.196,38.910)(55.195,38.930)(55.195,38.950)(55.195,38.970)(55.195,38.990)(55.195,39.010)(55.195,39.030)(55.195,39.050)(55.196,39.070)(55.196,39.090)(55.197,39.110)(55.198,39.130)(55.199,39.150)(55.201,39.170)(55.202,39.190)(55.204,39.210)(55.206,39.230)(55.208,39.250)(55.210,39.270)(55.212,39.290)(55.214,39.305)(55.215,39.310)(55.218,39.330)(55.221,39.350)(55.224,39.370)(55.227,39.390)(55.231,39.410)(55.234,39.427)(55.235,39.430)(55.239,39.450)(55.243,39.470)(55.248,39.490)(55.253,39.510)(55.254,39.517)(55.258,39.530)(55.263,39.550)(55.269,39.570)(55.274,39.589)(55.275,39.590)(55.281,39.610)(55.288,39.630)(55.294,39.649)(55.295,39.650)(55.302,39.670)(55.310,39.690)(55.314,39.702)(55.318,39.710)(55.326,39.730)(55.334,39.748)(55.335,39.750)(55.345,39.770)(55.354,39.789)(55.355,39.790)(55.365,39.810)(55.374,39.826)(55.377,39.830)(55.388,39.850)(55.394,39.859)(55.401,39.870)(55.414,39.890)(55.414,39.890)(55.429,39.910)(55.434,39.917)(55.444,39.930)(55.454,39.942)(55.461,39.950)(55.474,39.965)(55.478,39.970)(55.494,39.986)(55.498,39.990)(55.514,40.005)(55.519,40.010)(55.534,40.023)(55.543,40.030)(55.554,40.039)(55.570,40.050)(55.574,40.053)(55.594,40.066)(55.601,40.070)(55.614,40.077)(55.634,40.088)(55.639,40.090)(55.654,40.097)(55.674,40.105)(55.688,40.110)(55.694,40.112)(55.714,40.118)(55.734,40.122)(55.754,40.126)(55.774,40.129)(55.780,40.130)(55.794,40.131)(55.814,40.132)(55.834,40.132)(55.854,40.132)(55.874,40.130)(55.877,40.130)(55.894,40.128)(55.914,40.124)(55.934,40.120)(55.954,40.115)(55.974,40.110)(55.975,40.110)(55.994,40.103)(56.014,40.096)(56.031,40.090)(56.034,40.088)(56.054,40.079)(56.074,40.070)(56.075,40.070)(56.094,40.059)(56.112,40.050)(56.114,40.048)(56.134,40.036)(56.145,40.030)(56.154,40.024)(56.174,40.010)(56.175,40.010)(56.194,39.996)(56.203,39.990)(56.214,39.981)(56.229,39.970)(56.234,39.965)(56.253,39.950)(56.254,39.949)(56.274,39.931)(56.276,39.930)(56.294,39.913)(56.298,39.910)(56.314,39.894)(56.318,39.890)(56.334,39.874)(56.338,39.870)(56.354,39.853)(56.357,39.850)(56.374,39.831)(56.375,39.830)(56.393,39.810)(56.394,39.808)(56.410,39.790)(56.414,39.784)(56.426,39.770)(56.434,39.759)(56.442,39.750)(56.454,39.733)(56.457,39.730)(56.472,39.710)(56.474,39.706)(56.486,39.690)(56.494,39.678)(56.500,39.670)(56.514,39.650)(56.514,39.649)(56.527,39.630)(56.534,39.618)(56.540,39.610)(56.552,39.590)(56.554,39.586)(56.564,39.570)(56.574,39.552)(56.576,39.550)(56.587,39.530)(56.594,39.517)(56.598,39.510)(56.609,39.490)(56.614,39.479)(56.619,39.470)(56.629,39.450)(56.634,39.439)(56.639,39.430)(56.648,39.410)(56.654,39.395)};
\addplot[black!82,smooth]coordinates{(56.654,38.928)(56.647,38.910)(56.638,38.890)(56.634,38.881)(56.629,38.870)(56.620,38.850)(56.614,38.837)(56.611,38.830)(56.602,38.810)(56.594,38.794)(56.592,38.790)(56.582,38.770)(56.574,38.753)(56.573,38.750)(56.563,38.730)(56.554,38.713)(56.553,38.710)(56.542,38.690)(56.534,38.674)(56.532,38.670)(56.522,38.650)(56.514,38.635)(56.511,38.630)(56.501,38.610)(56.494,38.598)(56.490,38.590)(56.479,38.570)(56.474,38.561)(56.468,38.550)(56.458,38.530)(56.454,38.524)(56.446,38.510)(56.435,38.490)(56.434,38.488)(56.424,38.470)(56.414,38.452)(56.413,38.450)(56.402,38.430)(56.394,38.417)(56.390,38.410)(56.379,38.390)(56.374,38.382)(56.367,38.370)(56.355,38.350)(56.354,38.348)(56.343,38.330)(56.334,38.314)(56.332,38.310)(56.320,38.290)(56.314,38.281)(56.308,38.270)(56.296,38.250)(56.294,38.248)(56.283,38.230)(56.274,38.215)(56.271,38.210)(56.259,38.190)(56.254,38.183)(56.246,38.170)(56.234,38.151)(56.233,38.150)(56.221,38.130)(56.214,38.120)(56.208,38.110)(56.195,38.090)(56.194,38.089)(56.182,38.070)(56.174,38.058)(56.169,38.050)(56.156,38.030)(56.154,38.028)(56.142,38.010)(56.134,37.998)(56.129,37.990)(56.115,37.970)(56.114,37.968)(56.101,37.950)(56.094,37.939)(56.088,37.930)(56.074,37.911)(56.074,37.910)(56.059,37.890)(56.054,37.883)(56.045,37.870)(56.034,37.855)(56.031,37.850)(56.016,37.830)(56.014,37.827)(56.001,37.810)(55.994,37.801)(55.986,37.790)(55.974,37.774)(55.971,37.770)(55.955,37.750)(55.954,37.749)(55.939,37.730)(55.934,37.724)(55.923,37.710)(55.914,37.699)(55.907,37.690)(55.894,37.675)(55.890,37.670)(55.874,37.652)(55.872,37.650)(55.854,37.630)(55.854,37.630)};
\addplot[black!64,smooth]coordinates{(55.252,37.630)(55.241,37.650)(55.234,37.661)(55.230,37.670)(55.219,37.690)(55.214,37.698)(55.208,37.710)(55.198,37.730)(55.194,37.736)(55.188,37.750)(55.178,37.770)(55.174,37.777)(55.168,37.790)(55.159,37.810)(55.154,37.820)(55.150,37.830)(55.141,37.850)(55.134,37.864)(55.132,37.870)(55.124,37.890)(55.115,37.910)(55.114,37.911)(55.107,37.930)(55.099,37.950)(55.094,37.961)(55.091,37.970)(55.083,37.990)(55.076,38.010)(55.074,38.013)(55.068,38.030)(55.061,38.050)(55.054,38.069)(55.054,38.070)(55.047,38.090)(55.040,38.110)(55.034,38.127)(55.034,38.130)(55.027,38.150)(55.021,38.170)(55.014,38.190)(55.014,38.190)(55.008,38.210)(55.002,38.230)(54.996,38.250)(54.994,38.256)(54.991,38.270)(54.985,38.290)(54.979,38.310)(54.974,38.328)(54.974,38.330)(54.969,38.350)(54.964,38.370)(54.958,38.390)(54.954,38.406)(54.954,38.410)(54.949,38.430)(54.944,38.450)(54.939,38.470)(54.935,38.490)(54.934,38.492)(54.930,38.510)(54.926,38.530)(54.922,38.550)(54.918,38.570)(54.914,38.587)(54.914,38.590)(54.910,38.610)(54.906,38.630)(54.903,38.650)(54.899,38.670)(54.896,38.690)(54.894,38.698)(54.892,38.710)(54.889,38.730)(54.886,38.750)(54.883,38.770)(54.880,38.790)(54.877,38.810)(54.875,38.830)(54.874,38.831)(54.872,38.850)(54.869,38.870)(54.867,38.890)(54.865,38.910)(54.863,38.930)(54.861,38.950)(54.859,38.970)(54.857,38.990)(54.855,39.010)(54.854,39.015)(54.853,39.030)(54.852,39.050)(54.850,39.070)(54.849,39.090)(54.848,39.110)(54.846,39.130)(54.845,39.150)(54.845,39.170)(54.844,39.190)(54.843,39.210)(54.842,39.230)(54.842,39.250)(54.842,39.270)(54.841,39.290)(54.841,39.310)(54.841,39.330)(54.841,39.350)(54.842,39.370)(54.842,39.390)(54.842,39.410)(54.843,39.430)(54.844,39.450)(54.844,39.470)(54.845,39.490)(54.846,39.510)(54.848,39.530)(54.849,39.550)(54.850,39.570)(54.852,39.590)(54.854,39.610)(54.854,39.616)(54.856,39.630)(54.858,39.650)(54.860,39.670)(54.862,39.690)(54.865,39.710)(54.867,39.730)(54.870,39.750)(54.873,39.770)(54.874,39.779)(54.876,39.790)(54.879,39.810)(54.883,39.830)(54.886,39.850)(54.890,39.870)(54.894,39.890)(54.894,39.892)(54.898,39.910)(54.902,39.930)(54.907,39.950)(54.912,39.970)(54.914,39.981)(54.917,39.990)(54.922,40.010)(54.927,40.030)(54.933,40.050)(54.934,40.056)(54.939,40.070)(54.945,40.090)(54.951,40.110)(54.954,40.121)(54.957,40.130)(54.964,40.150)(54.971,40.170)(54.974,40.178)(54.979,40.190)(54.986,40.210)(54.994,40.230)(55.003,40.250)(55.011,40.270)(55.014,40.276)(55.021,40.290)(55.030,40.310)(55.034,40.319)(55.040,40.330)(55.050,40.350)(55.054,40.358)(55.061,40.370)(55.072,40.390)(55.074,40.394)(55.084,40.410)(55.094,40.427)(55.096,40.430)(55.109,40.450)(55.114,40.458)(55.122,40.470)(55.134,40.487)(55.137,40.490)(55.152,40.510)(55.154,40.513)(55.167,40.530)(55.174,40.538)(55.184,40.550)(55.194,40.561)(55.202,40.570)(55.214,40.583)(55.221,40.590)(55.234,40.603)(55.242,40.610)(55.254,40.621)(55.264,40.630)(55.274,40.639)(55.288,40.650)(55.294,40.655)(55.314,40.670)(55.314,40.670)(55.334,40.684)(55.344,40.690)(55.354,40.697)(55.374,40.708)(55.377,40.710)(55.394,40.719)(55.414,40.729)(55.416,40.730)(55.434,40.738)(55.454,40.746)(55.464,40.750)(55.474,40.753)(55.494,40.760)(55.514,40.766)(55.531,40.770)(55.534,40.770)(55.554,40.775)(55.574,40.778)(55.594,40.781)(55.614,40.783)(55.634,40.784)(55.654,40.785)(55.674,40.785)(55.694,40.784)(55.714,40.782)(55.734,40.780)(55.754,40.778)(55.774,40.775)(55.794,40.771)(55.799,40.770)(55.814,40.766)(55.834,40.761)(55.854,40.755)(55.873,40.750)(55.874,40.749)(55.894,40.742)(55.914,40.735)(55.927,40.730)(55.934,40.727)(55.954,40.718)(55.972,40.710)(55.974,40.709)(55.994,40.699)(56.011,40.690)(56.014,40.688)(56.034,40.677)(56.047,40.670)(56.054,40.665)(56.074,40.653)(56.079,40.650)(56.094,40.640)(56.109,40.630)(56.114,40.626)(56.134,40.612)(56.137,40.610)(56.154,40.597)(56.164,40.590)(56.174,40.581)(56.189,40.570)(56.194,40.565)(56.213,40.550)(56.214,40.548)(56.234,40.531)(56.236,40.530)(56.254,40.512)(56.257,40.510)(56.274,40.493)(56.278,40.490)(56.294,40.474)(56.298,40.470)(56.314,40.453)(56.318,40.450)(56.334,40.432)(56.337,40.430)(56.354,40.410)(56.355,40.410)(56.372,40.390)(56.374,40.387)(56.389,40.370)(56.394,40.364)(56.406,40.350)(56.414,40.339)(56.422,40.330)(56.434,40.314)(56.437,40.310)(56.452,40.290)(56.454,40.287)(56.467,40.270)(56.474,40.260)(56.481,40.250)(56.494,40.231)(56.495,40.230)(56.509,40.210)(56.514,40.202)(56.522,40.190)(56.534,40.171)(56.535,40.170)(56.548,40.150)(56.554,40.139)(56.560,40.130)(56.572,40.110)(56.574,40.106)(56.584,40.090)(56.594,40.071)(56.595,40.070)(56.606,40.050)(56.614,40.035)(56.617,40.030)(56.628,40.010)(56.634,39.997)(56.638,39.990)(56.648,39.970)(56.654,39.957)};
\addplot[black!64,smooth]coordinates{(56.654,38.386)(56.647,38.370)(56.638,38.350)(56.634,38.343)(56.628,38.330)(56.619,38.310)(56.614,38.301)(56.609,38.290)(56.599,38.270)(56.594,38.260)(56.589,38.250)(56.579,38.230)(56.574,38.220)(56.569,38.210)(56.558,38.190)(56.554,38.182)(56.548,38.170)(56.537,38.150)(56.534,38.145)(56.526,38.130)(56.515,38.110)(56.514,38.108)(56.504,38.090)(56.494,38.072)(56.493,38.070)(56.481,38.050)(56.474,38.038)(56.470,38.030)(56.458,38.010)(56.454,38.004)(56.446,37.990)(56.434,37.970)(56.434,37.970)(56.422,37.950)(56.414,37.938)(56.409,37.930)(56.397,37.910)(56.394,37.906)(56.384,37.890)(56.374,37.875)(56.371,37.870)(56.358,37.850)(56.354,37.845)(56.344,37.830)(56.334,37.815)(56.331,37.810)(56.317,37.790)(56.314,37.786)(56.303,37.770)(56.294,37.757)(56.289,37.750)(56.275,37.730)(56.274,37.729)(56.260,37.710)(56.254,37.702)(56.245,37.690)(56.234,37.675)(56.230,37.670)(56.215,37.650)(56.214,37.649)(56.199,37.630)};
\addplot[black!46,smooth]coordinates{(54.749,37.630)(54.738,37.650)(54.734,37.658)(54.728,37.670)(54.719,37.690)(54.714,37.698)(54.709,37.710)(54.699,37.730)(54.694,37.740)(54.690,37.750)(54.680,37.770)(54.674,37.783)(54.671,37.790)(54.662,37.810)(54.654,37.828)(54.653,37.830)(54.645,37.850)(54.636,37.870)(54.634,37.874)(54.628,37.890)(54.619,37.910)(54.614,37.921)(54.611,37.930)(54.603,37.950)(54.595,37.970)(54.594,37.971)(54.587,37.990)(54.579,38.010)(54.574,38.022)(54.571,38.030)(54.564,38.050)(54.556,38.070)(54.554,38.075)(54.549,38.090)(54.542,38.110)(54.535,38.130)(54.534,38.130)(54.528,38.150)(54.521,38.170)(54.514,38.188)(54.514,38.190)(54.507,38.210)(54.500,38.230)(54.494,38.248)(54.494,38.250)(54.487,38.270)(54.481,38.290)(54.475,38.310)(54.474,38.311)(54.468,38.330)(54.462,38.350)(54.456,38.370)(54.454,38.376)(54.450,38.390)(54.445,38.410)(54.439,38.430)(54.434,38.445)(54.433,38.450)(54.428,38.470)(54.422,38.490)(54.417,38.510)(54.414,38.518)(54.411,38.530)(54.406,38.550)(54.401,38.570)(54.396,38.590)(54.394,38.595)(54.391,38.610)(54.386,38.630)(54.381,38.650)(54.376,38.670)(54.374,38.677)(54.372,38.690)(54.367,38.710)(54.362,38.730)(54.358,38.750)(54.354,38.766)(54.354,38.770)(54.349,38.790)(54.345,38.810)(54.341,38.830)(54.337,38.850)(54.334,38.861)(54.333,38.870)(54.329,38.890)(54.325,38.910)(54.321,38.930)(54.317,38.950)(54.314,38.966)(54.314,38.970)(54.310,38.990)(54.307,39.010)(54.303,39.030)(54.300,39.050)(54.297,39.070)(54.294,39.084)(54.294,39.090)(54.290,39.110)(54.287,39.130)(54.284,39.150)(54.282,39.170)(54.279,39.190)(54.276,39.210)(54.274,39.221)(54.273,39.230)(54.271,39.250)(54.268,39.270)(54.266,39.290)(54.263,39.310)(54.261,39.330)(54.259,39.350)(54.257,39.370)(54.254,39.390)(54.254,39.390)(54.252,39.410)(54.251,39.430)(54.249,39.450)(54.247,39.470)(54.245,39.490)(54.243,39.510)(54.242,39.530)(54.240,39.550)(54.239,39.570)(54.238,39.590)(54.236,39.610)(54.235,39.630)(54.234,39.642)(54.234,39.650)(54.233,39.670)(54.232,39.690)(54.231,39.710)(54.230,39.730)(54.230,39.750)(54.229,39.770)(54.228,39.790)(54.228,39.810)(54.227,39.830)(54.227,39.850)(54.227,39.870)(54.227,39.890)(54.226,39.910)(54.226,39.930)(54.227,39.950)(54.227,39.970)(54.227,39.990)(54.227,40.010)(54.228,40.030)(54.228,40.050)(54.229,40.070)(54.229,40.090)(54.230,40.110)(54.231,40.130)(54.232,40.150)(54.233,40.170)(54.234,40.190)(54.234,40.195)(54.235,40.210)(54.237,40.230)(54.238,40.250)(54.240,40.270)(54.241,40.290)(54.243,40.310)(54.245,40.330)(54.247,40.350)(54.249,40.370)(54.251,40.390)(54.253,40.410)(54.254,40.422)(54.255,40.430)(54.258,40.450)(54.260,40.470)(54.263,40.490)(54.266,40.510)(54.269,40.530)(54.272,40.550)(54.274,40.567)(54.275,40.570)(54.278,40.590)(54.281,40.610)(54.285,40.630)(54.289,40.650)(54.292,40.670)(54.294,40.680)(54.296,40.690)(54.300,40.710)(54.305,40.730)(54.309,40.750)(54.313,40.770)(54.314,40.774)(54.318,40.790)(54.323,40.810)(54.328,40.830)(54.333,40.850)(54.334,40.856)(54.338,40.870)(54.343,40.890)(54.349,40.910)(54.354,40.928)(54.355,40.930)(54.361,40.950)(54.367,40.970)(54.373,40.990)(54.374,40.993)(54.380,41.010)(54.386,41.030)(54.393,41.050)(54.394,41.052)(54.401,41.070)(54.408,41.090)(54.414,41.107)(54.416,41.110)(54.423,41.130)(54.431,41.150)(54.434,41.157)(54.440,41.170)(54.448,41.190)(54.454,41.203)(54.457,41.210)(54.466,41.230)(54.474,41.247)(54.476,41.250)(54.486,41.270)(54.494,41.287)(54.496,41.290)(54.506,41.310)(54.514,41.325)(54.517,41.330)(54.528,41.350)(54.534,41.361)(54.540,41.370)(54.552,41.390)(54.554,41.394)(54.564,41.410)(54.574,41.426)(54.577,41.430)(54.590,41.450)(54.594,41.456)(54.604,41.470)(54.614,41.484)(54.618,41.490)(54.633,41.510)(54.634,41.511)(54.649,41.530)(54.654,41.537)(54.665,41.550)(54.674,41.561)(54.682,41.570)(54.694,41.584)(54.700,41.590)(54.714,41.605)(54.719,41.610)(54.734,41.626)(54.738,41.630)(54.754,41.645)(54.759,41.650)(54.774,41.664)(54.781,41.670)(54.794,41.681)(54.804,41.690)(54.814,41.698)(54.829,41.710)(54.834,41.714)(54.854,41.729)(54.856,41.730)(54.874,41.743)(54.885,41.750)(54.894,41.756)(54.914,41.769)(54.916,41.770)(54.934,41.780)(54.951,41.790)(54.954,41.792)(54.974,41.802)(54.990,41.810)(54.994,41.812)(55.014,41.821)(55.034,41.830)(55.035,41.830)(55.054,41.838)(55.074,41.845)(55.088,41.850)(55.094,41.852)(55.114,41.858)(55.134,41.864)(55.154,41.869)(55.158,41.870)(55.174,41.873)(55.194,41.877)(55.214,41.881)(55.234,41.884)(55.254,41.887)(55.274,41.889)(55.284,41.890)(55.294,41.891)(55.314,41.892)(55.334,41.892)(55.354,41.893)(55.374,41.892)(55.394,41.892)(55.414,41.891)(55.429,41.890)(55.434,41.889)(55.454,41.887)(55.474,41.885)(55.494,41.882)(55.514,41.879)(55.534,41.875)(55.554,41.871)(55.561,41.870)(55.574,41.867)(55.594,41.862)(55.614,41.856)(55.634,41.851)(55.638,41.850)(55.654,41.845)(55.674,41.838)(55.694,41.831)(55.698,41.830)(55.714,41.824)(55.734,41.816)(55.750,41.810)(55.754,41.808)(55.774,41.799)(55.794,41.790)(55.795,41.790)(55.814,41.781)(55.834,41.771)(55.837,41.770)(55.854,41.761)(55.874,41.750)(55.875,41.750)(55.894,41.739)(55.910,41.730)(55.914,41.727)(55.934,41.715)(55.943,41.710)(55.954,41.703)(55.974,41.690)(55.975,41.690)(55.994,41.677)(56.005,41.670)(56.014,41.663)(56.033,41.650)(56.034,41.649)(56.054,41.634)(56.060,41.630)(56.074,41.619)(56.087,41.610)(56.094,41.604)(56.112,41.590)(56.114,41.588)(56.134,41.571)(56.136,41.570)(56.154,41.554)(56.160,41.550)(56.174,41.537)(56.182,41.530)(56.194,41.519)(56.204,41.510)(56.214,41.500)(56.226,41.490)(56.234,41.481)(56.247,41.470)(56.254,41.462)(56.267,41.450)(56.274,41.442)(56.286,41.430)(56.294,41.421)(56.306,41.410)(56.314,41.400)(56.324,41.390)(56.334,41.379)(56.342,41.370)(56.354,41.356)(56.360,41.350)(56.374,41.334)(56.378,41.330)(56.394,41.310)(56.395,41.310)(56.411,41.290)(56.414,41.286)(56.428,41.270)(56.434,41.261)(56.444,41.250)(56.454,41.236)(56.459,41.230)(56.474,41.210)(56.475,41.210)(56.489,41.190)(56.494,41.183)(56.504,41.170)(56.514,41.155)(56.519,41.150)(56.533,41.130)(56.534,41.127)(56.547,41.110)(56.554,41.098)(56.560,41.090)(56.574,41.070)(56.574,41.068)(56.587,41.050)(56.594,41.038)(56.599,41.030)(56.612,41.010)(56.614,41.006)(56.624,40.990)(56.634,40.974)(56.637,40.970)(56.649,40.950)(56.654,40.940)};
%\addplot[black!28,smooth]coordinates{(54.273,37.630)(54.264,37.650)(54.255,37.670)(54.254,37.670)(54.246,37.690)(54.236,37.710)(54.234,37.714)(54.227,37.730)(54.218,37.750)(54.214,37.759)(54.210,37.770)(54.201,37.790)(54.194,37.805)(54.192,37.810)(54.184,37.830)(54.175,37.850)(54.174,37.852)(54.167,37.870)(54.159,37.890)(54.154,37.900)(54.151,37.910)(54.143,37.930)(54.135,37.950)(54.134,37.950)(54.127,37.970)(54.119,37.990)(54.114,38.001)(54.111,38.010)(54.103,38.030)(54.096,38.050)(54.094,38.054)(54.088,38.070)(54.081,38.090)(54.074,38.108)(54.074,38.110)(54.066,38.130)(54.059,38.150)(54.054,38.163)(54.052,38.170)(54.045,38.190)(54.038,38.210)(54.034,38.221)(54.031,38.230)(54.025,38.250)(54.018,38.270)(54.014,38.280)(54.011,38.290)(54.005,38.310)(53.998,38.330)(53.994,38.342)(53.992,38.350)(53.985,38.370)(53.979,38.390)(53.974,38.405)(53.973,38.410)(53.967,38.430)(53.961,38.450)(53.955,38.470)(53.954,38.471)(53.949,38.490)(53.943,38.510)(53.937,38.530)(53.934,38.539)(53.931,38.550)(53.926,38.570)(53.920,38.590)(53.914,38.610)(53.914,38.610)(53.909,38.630)(53.904,38.650)(53.898,38.670)(53.894,38.684)(53.893,38.690)(53.888,38.710)(53.882,38.730)(53.877,38.750)(53.874,38.761)(53.872,38.770)(53.867,38.790)(53.862,38.810)(53.857,38.830)(53.854,38.842)(53.853,38.850)(53.848,38.870)(53.843,38.890)(53.839,38.910)(53.834,38.928)(53.834,38.930)(53.830,38.950)(53.825,38.970)(53.821,38.990)(53.816,39.010)(53.814,39.018)(53.812,39.030)(53.808,39.050)(53.804,39.070)(53.799,39.090)(53.795,39.110)(53.794,39.115)(53.791,39.130)(53.787,39.150)(53.784,39.170)(53.780,39.190)(53.776,39.210)(53.774,39.218)(53.772,39.230)(53.769,39.250)(53.765,39.270)(53.761,39.290)(53.758,39.310)(53.754,39.330)(53.754,39.330)(53.751,39.350)(53.748,39.370)(53.744,39.390)(53.741,39.410)(53.738,39.430)(53.735,39.450)(53.734,39.453)(53.732,39.470)(53.729,39.490)(53.726,39.510)(53.723,39.530)(53.720,39.550)(53.717,39.570)(53.715,39.590)(53.714,39.592)(53.712,39.610)(53.709,39.630)(53.707,39.650)(53.704,39.670)(53.702,39.690)(53.699,39.710)(53.697,39.730)(53.695,39.750)(53.694,39.753)(53.693,39.770)(53.690,39.790)(53.688,39.810)(53.686,39.830)(53.684,39.850)(53.682,39.870)(53.680,39.890)(53.678,39.910)(53.677,39.930)(53.675,39.950)(53.674,39.955)(53.673,39.970)(53.672,39.990)(53.670,40.010)(53.668,40.030)(53.667,40.050)(53.666,40.070)(53.664,40.090)(53.663,40.110)(53.662,40.130)(53.661,40.150)(53.659,40.170)(53.658,40.190)(53.657,40.210)(53.656,40.230)(53.656,40.250)(53.655,40.270)(53.654,40.278)(53.654,40.290)(53.653,40.310)(53.653,40.330)(53.652,40.350)(53.652,40.370)(53.651,40.390)(53.651,40.410)(53.650,40.430)(53.650,40.450)(53.650,40.470)(53.650,40.490)(53.650,40.510)(53.650,40.530)(53.650,40.550)(53.650,40.570)(53.650,40.590)(53.650,40.610)(53.650,40.630)(53.651,40.650)(53.651,40.670)(53.652,40.690)(53.652,40.710)(53.653,40.730)(53.653,40.750)(53.654,40.770)(53.654,40.773)(53.655,40.790)(53.656,40.810)(53.657,40.830)(53.658,40.850)(53.659,40.870)(53.660,40.890)(53.662,40.910)(53.663,40.930)(53.664,40.950)(53.666,40.970)(53.668,40.990)(53.669,41.010)(53.671,41.030)(53.673,41.050)(53.674,41.067)(53.675,41.070)(53.677,41.090)(53.679,41.110)(53.681,41.130)(53.683,41.150)(53.685,41.170)(53.688,41.190)(53.690,41.210)(53.693,41.230)(53.694,41.240)(53.696,41.250)(53.698,41.270)(53.701,41.290)(53.704,41.310)(53.707,41.330)(53.711,41.350)(53.714,41.370)(53.714,41.373)(53.717,41.390)(53.721,41.410)(53.724,41.430)(53.728,41.450)(53.732,41.470)(53.734,41.482)(53.736,41.490)(53.740,41.510)(53.744,41.530)(53.748,41.550)(53.753,41.570)(53.754,41.577)(53.757,41.590)(53.762,41.610)(53.767,41.630)(53.772,41.650)(53.774,41.661)(53.777,41.670)(53.782,41.690)(53.787,41.710)(53.793,41.730)(53.794,41.736)(53.798,41.750)(53.804,41.770)(53.810,41.790)(53.814,41.804)(53.816,41.810)(53.822,41.830)(53.829,41.850)(53.834,41.867)(53.835,41.870)(53.842,41.890)(53.849,41.910)(53.854,41.924)(53.856,41.930)(53.864,41.950)(53.871,41.970)(53.874,41.978)(53.879,41.990)(53.887,42.010)(53.894,42.028)(53.895,42.030)(53.903,42.050)(53.912,42.070)(53.914,42.075)(53.921,42.090)(53.930,42.110)(53.934,42.119)(53.939,42.130)(53.949,42.150)(53.954,42.161)(53.959,42.170)(53.969,42.190)(53.974,42.200)(53.980,42.210)(53.990,42.230)(53.994,42.237)(54.001,42.250)(54.013,42.270)(54.014,42.272)(54.025,42.290)(54.034,42.306)(54.037,42.310)(54.050,42.330)(54.054,42.337)(54.062,42.350)(54.074,42.368)(54.076,42.370)(54.090,42.390)(54.094,42.396)(54.104,42.410)(54.114,42.424)(54.119,42.430)(54.134,42.450)(54.134,42.450)(54.150,42.470)(54.154,42.475)(54.167,42.490)(54.174,42.499)(54.184,42.510)(54.194,42.522)(54.202,42.530)(54.214,42.543)(54.220,42.550)(54.234,42.564)(54.240,42.570)(54.254,42.584)(54.260,42.590)(54.274,42.603)(54.281,42.610)(54.294,42.621)(54.304,42.630)(54.314,42.639)(54.327,42.650)(54.334,42.656)(54.352,42.670)(54.354,42.672)(54.374,42.687)(54.378,42.690)(54.394,42.702)(54.406,42.710)(54.414,42.716)(54.434,42.729)(54.436,42.730)(54.454,42.742)(54.468,42.750)(54.474,42.754)(54.494,42.765)(54.502,42.770)(54.514,42.776)(54.534,42.787)(54.540,42.790)(54.554,42.797)(54.574,42.806)(54.582,42.810)(54.594,42.815)(54.614,42.824)(54.629,42.830)(54.634,42.832)(54.654,42.839)(54.674,42.846)(54.684,42.850)(54.694,42.853)(54.714,42.859)(54.734,42.865)(54.751,42.870)(54.754,42.871)(54.774,42.876)(54.794,42.880)(54.814,42.884)(54.834,42.888)(54.842,42.890)(54.854,42.892)(54.874,42.895)(54.894,42.898)(54.914,42.900)(54.934,42.902)(54.954,42.904)(54.974,42.905)(54.994,42.906)(55.014,42.907)(55.034,42.907)(55.054,42.907)(55.074,42.907)(55.094,42.906)(55.114,42.905)(55.134,42.904)(55.154,42.902)(55.174,42.900)(55.194,42.898)(55.214,42.895)(55.234,42.893)(55.253,42.890)(55.254,42.889)(55.274,42.886)(55.294,42.882)(55.314,42.878)(55.334,42.874)(55.351,42.870)(55.354,42.869)(55.374,42.864)(55.394,42.859)(55.414,42.853)(55.426,42.850)(55.434,42.847)(55.454,42.841)(55.474,42.834)(55.488,42.830)(55.494,42.828)(55.514,42.820)(55.534,42.813)(55.543,42.810)(55.554,42.805)(55.574,42.797)(55.593,42.790)(55.594,42.789)(55.614,42.780)(55.634,42.771)(55.638,42.770)(55.654,42.762)(55.674,42.753)(55.680,42.750)(55.694,42.743)(55.714,42.733)(55.720,42.730)(55.734,42.722)(55.754,42.711)(55.757,42.710)(55.774,42.700)(55.793,42.690)(55.794,42.689)(55.814,42.677)(55.827,42.670)(55.834,42.665)(55.854,42.653)(55.859,42.650)(55.874,42.640)(55.890,42.630)(55.894,42.627)(55.914,42.614)(55.920,42.610)(55.934,42.600)(55.949,42.590)(55.954,42.586)(55.974,42.571)(55.977,42.570)(55.994,42.557)(56.004,42.550)(56.014,42.542)(56.030,42.530)(56.034,42.526)(56.054,42.510)(56.055,42.510)(56.074,42.494)(56.080,42.490)(56.094,42.478)(56.104,42.470)(56.114,42.461)(56.128,42.450)(56.134,42.444)(56.150,42.430)(56.154,42.426)(56.173,42.410)(56.174,42.408)(56.194,42.390)(56.195,42.390)(56.214,42.371)(56.216,42.370)(56.234,42.352)(56.237,42.350)(56.254,42.332)(56.257,42.330)(56.274,42.312)(56.277,42.310)(56.294,42.292)(56.296,42.290)(56.314,42.271)(56.316,42.270)(56.334,42.250)(56.334,42.250)(56.353,42.230)(56.354,42.228)(56.371,42.210)(56.374,42.206)(56.389,42.190)(56.394,42.183)(56.406,42.170)(56.414,42.160)(56.423,42.150)(56.434,42.136)(56.440,42.130)(56.454,42.112)(56.457,42.110)(56.473,42.090)(56.474,42.088)(56.489,42.070)(56.494,42.063)(56.504,42.050)(56.514,42.037)(56.520,42.030)(56.534,42.011)(56.535,42.010)(56.550,41.990)(56.554,41.984)(56.565,41.970)(56.574,41.957)(56.579,41.950)(56.594,41.930)(56.594,41.929)(56.608,41.910)(56.614,41.900)(56.622,41.890)(56.634,41.871)(56.635,41.870)(56.649,41.850)(56.654,41.841)};
%\addplot[black!10,smooth]coordinates{(53.403,37.630)(53.394,37.650)(53.394,37.650)(53.386,37.670)(53.378,37.690)(53.374,37.697)(53.369,37.710)(53.361,37.730)(53.354,37.746)(53.353,37.750)(53.345,37.770)(53.337,37.790)(53.334,37.795)(53.329,37.810)(53.321,37.830)(53.314,37.845)(53.313,37.850)(53.305,37.870)(53.297,37.890)(53.294,37.896)(53.289,37.910)(53.282,37.930)(53.274,37.949)(53.274,37.950)(53.266,37.970)(53.259,37.990)(53.254,38.002)(53.252,38.010)(53.244,38.030)(53.237,38.050)(53.234,38.056)(53.230,38.070)(53.222,38.090)(53.215,38.110)(53.214,38.112)(53.208,38.130)(53.201,38.150)(53.194,38.168)(53.194,38.170)(53.187,38.190)(53.180,38.210)(53.174,38.226)(53.173,38.230)(53.166,38.250)(53.160,38.270)(53.154,38.285)(53.153,38.290)(53.146,38.310)(53.140,38.330)(53.134,38.346)(53.133,38.350)(53.127,38.370)(53.120,38.390)(53.114,38.408)(53.114,38.410)(53.107,38.430)(53.101,38.450)(53.095,38.470)(53.094,38.471)(53.089,38.490)(53.083,38.510)(53.076,38.530)(53.074,38.536)(53.070,38.550)(53.064,38.570)(53.058,38.590)(53.054,38.603)(53.052,38.610)(53.046,38.630)(53.041,38.650)(53.035,38.670)(53.034,38.671)(53.029,38.690)(53.023,38.710)(53.018,38.730)(53.014,38.741)(53.012,38.750)(53.006,38.770)(53.001,38.790)(52.995,38.810)(52.994,38.813)(52.990,38.830)(52.985,38.850)(52.979,38.870)(52.974,38.888)(52.974,38.890)(52.969,38.910)(52.963,38.930)(52.958,38.950)(52.954,38.964)(52.953,38.970)(52.948,38.990)(52.943,39.010)(52.938,39.030)(52.934,39.043)(52.933,39.050)(52.928,39.070)(52.923,39.090)(52.918,39.110)(52.914,39.124)(52.913,39.130)(52.908,39.150)(52.904,39.170)(52.899,39.190)(52.894,39.209)(52.894,39.210)(52.890,39.230)(52.885,39.250)(52.880,39.270)(52.876,39.290)(52.874,39.296)(52.871,39.310)(52.867,39.330)(52.862,39.350)(52.858,39.370)(52.854,39.387)(52.854,39.390)(52.849,39.410)(52.845,39.430)(52.841,39.450)(52.837,39.470)(52.834,39.481)(52.833,39.490)(52.829,39.510)(52.825,39.530)(52.820,39.550)(52.816,39.570)(52.814,39.580)(52.813,39.590)(52.809,39.610)(52.805,39.630)(52.801,39.650)(52.797,39.670)(52.794,39.683)(52.793,39.690)(52.790,39.710)(52.786,39.730)(52.782,39.750)(52.778,39.770)(52.775,39.790)(52.774,39.792)(52.771,39.810)(52.768,39.830)(52.764,39.850)(52.761,39.870)(52.757,39.890)(52.754,39.907)(52.754,39.910)(52.751,39.930)(52.747,39.950)(52.744,39.970)(52.741,39.990)(52.738,40.010)(52.734,40.030)(52.734,40.030)(52.731,40.050)(52.728,40.070)(52.725,40.090)(52.722,40.110)(52.719,40.130)(52.716,40.150)(52.714,40.161)(52.713,40.170)(52.710,40.190)(52.707,40.210)(52.705,40.230)(52.702,40.250)(52.699,40.270)(52.696,40.290)(52.694,40.304)(52.694,40.310)(52.691,40.330)(52.688,40.350)(52.686,40.370)(52.683,40.390)(52.681,40.410)(52.678,40.430)(52.676,40.450)(52.674,40.460)(52.673,40.470)(52.671,40.490)(52.669,40.510)(52.666,40.530)(52.664,40.550)(52.662,40.570)(52.659,40.590)(52.657,40.610)(52.655,40.630)(52.654,40.636)(52.653,40.650)(52.651,40.670)(52.649,40.690)(52.647,40.710)(52.645,40.730)(52.643,40.750)(52.641,40.770)(52.639,40.790)(52.637,40.810)(52.635,40.830)(52.634,40.842)(52.634,40.850)(52.632,40.870)(52.630,40.890)(52.629,40.910)(52.627,40.930)(52.625,40.950)(52.624,40.970)(52.622,40.990)(52.621,41.010)(52.619,41.030)(52.618,41.050)(52.616,41.070)(52.615,41.090)(52.614,41.099)(52.614,41.110)(52.612,41.130)(52.611,41.150)(52.610,41.170)(52.609,41.190)(52.608,41.210)(52.606,41.230)(52.605,41.250)(52.604,41.270)(52.603,41.290)(52.602,41.310)(52.601,41.330)(52.600,41.350)(52.600,41.370)(52.599,41.390)(52.598,41.410)(52.597,41.430)(52.596,41.450)(52.596,41.470)(52.595,41.490)(52.595,41.510)(52.594,41.513)(52.594,41.530)(52.593,41.550)(52.593,41.570)(52.592,41.590)(52.592,41.610)(52.592,41.630)(52.591,41.650)(52.591,41.670)(52.591,41.690)(52.590,41.710)(52.590,41.730)(52.590,41.750)(52.590,41.770)(52.590,41.790)(52.590,41.810)(52.590,41.830)(52.590,41.850)(52.590,41.870)(52.590,41.890)(52.590,41.910)(52.590,41.930)(52.591,41.950)(52.591,41.970)(52.591,41.990)(52.592,42.010)(52.592,42.030)(52.592,42.050)(52.593,42.070)(52.593,42.090)(52.594,42.110)(52.594,42.122)(52.595,42.130)(52.595,42.150)(52.596,42.170)(52.597,42.190)(52.598,42.210)(52.598,42.230)(52.599,42.250)(52.600,42.270)(52.601,42.290)(52.602,42.310)(52.604,42.330)(52.605,42.350)(52.606,42.370)(52.607,42.390)(52.608,42.410)(52.610,42.430)(52.611,42.450)(52.613,42.470)(52.614,42.490)(52.614,42.493)(52.616,42.510)(52.617,42.530)(52.619,42.550)(52.621,42.570)(52.623,42.590)(52.624,42.610)(52.626,42.630)(52.628,42.650)(52.630,42.670)(52.632,42.690)(52.634,42.708)(52.635,42.710)(52.637,42.730)(52.639,42.750)(52.642,42.770)(52.644,42.790)(52.646,42.810)(52.649,42.830)(52.652,42.850)(52.654,42.870)(52.654,42.870)(52.657,42.890)(52.660,42.910)(52.663,42.930)(52.666,42.950)(52.669,42.970)(52.672,42.990)(52.674,43.003)(52.676,43.010)(52.679,43.030)(52.682,43.050)(52.686,43.070)(52.689,43.090)(52.693,43.110)(52.694,43.116)(52.697,43.130)(52.701,43.150)(52.705,43.170)(52.709,43.190)(52.713,43.210)(52.714,43.215)(52.718,43.230)(52.722,43.250)(52.727,43.270)(52.731,43.290)(52.734,43.303)(52.736,43.310)(52.741,43.330)(52.746,43.350)(52.751,43.370)(52.754,43.383)(52.756,43.390)(52.762,43.410)(52.767,43.430)(52.773,43.450)(52.774,43.455)(52.779,43.470)(52.785,43.490)(52.791,43.510)(52.794,43.520)(52.797,43.530)(52.804,43.550)(52.811,43.570)(52.814,43.581)(52.817,43.590)(52.824,43.610)(52.832,43.630)(52.834,43.637)(52.839,43.650)(52.847,43.670)(52.854,43.689)(52.854,43.690)(52.863,43.710)(52.871,43.730)(52.874,43.738)(52.879,43.750)(52.888,43.770)(52.894,43.784)(52.897,43.790)(52.906,43.810)(52.914,43.826)(52.916,43.830)(52.926,43.850)(52.934,43.867)(52.936,43.870)(52.946,43.890)(52.954,43.905)(52.957,43.910)(52.968,43.930)(52.974,43.940)(52.980,43.950)(52.992,43.970)(52.994,43.974)(53.004,43.990)(53.014,44.007)(53.016,44.010)(53.029,44.030)(53.034,44.037)(53.043,44.050)(53.054,44.066)(53.057,44.070)(53.071,44.090)(53.074,44.094)(53.086,44.110)(53.094,44.120)(53.102,44.130)(53.114,44.146)(53.118,44.150)(53.134,44.170)(53.134,44.170)(53.152,44.190)(53.154,44.193)(53.170,44.210)(53.174,44.215)(53.188,44.230)(53.194,44.236)(53.208,44.250)(53.214,44.256)(53.228,44.270)(53.234,44.276)(53.249,44.290)(53.254,44.295)(53.271,44.310)(53.274,44.313)(53.294,44.330)(53.294,44.330)(53.314,44.347)(53.318,44.350)(53.334,44.363)(53.343,44.370)(53.354,44.378)(53.370,44.390)(53.374,44.393)(53.394,44.408)(53.397,44.410)(53.414,44.421)(53.427,44.430)(53.434,44.435)(53.454,44.448)(53.458,44.450)(53.474,44.460)(53.491,44.470)(53.494,44.472)(53.514,44.483)(53.525,44.490)(53.534,44.495)(53.554,44.505)(53.563,44.510)(53.574,44.516)(53.594,44.526)(53.603,44.530)(53.614,44.535)(53.634,44.545)(53.646,44.550)(53.654,44.553)(53.674,44.562)(53.693,44.570)(53.694,44.570)(53.714,44.578)(53.734,44.586)(53.744,44.590)(53.754,44.593)(53.774,44.601)(53.794,44.607)(53.801,44.610)(53.814,44.614)(53.834,44.620)(53.854,44.626)(53.866,44.630)(53.874,44.632)(53.894,44.637)(53.914,44.643)(53.934,44.648)(53.943,44.650)(53.954,44.652)(53.974,44.657)(53.994,44.661)(54.014,44.665)(54.034,44.669)(54.037,44.670)(54.054,44.673)(54.074,44.676)(54.094,44.679)(54.114,44.682)(54.134,44.685)(54.154,44.688)(54.171,44.690)(54.174,44.690)(54.194,44.692)(54.214,44.694)(54.234,44.696)(54.254,44.697)(54.274,44.699)(54.294,44.700)(54.314,44.701)(54.334,44.702)(54.354,44.702)(54.374,44.703)(54.394,44.703)(54.414,44.703)(54.434,44.703)(54.454,44.702)(54.474,44.702)(54.494,44.701)(54.514,44.700)(54.534,44.699)(54.554,44.698)(54.574,44.696)(54.594,44.695)(54.614,44.693)(54.634,44.691)(54.647,44.690)(54.654,44.689)(54.674,44.687)(54.694,44.684)(54.714,44.681)(54.734,44.678)(54.754,44.675)(54.774,44.672)(54.789,44.670)(54.794,44.669)(54.814,44.665)(54.834,44.661)(54.854,44.657)(54.874,44.653)(54.891,44.650)(54.894,44.649)(54.914,44.645)(54.934,44.640)(54.954,44.635)(54.974,44.630)(54.976,44.630)(54.994,44.625)(55.014,44.619)(55.034,44.614)(55.049,44.610)(55.054,44.608)(55.074,44.602)(55.094,44.596)(55.114,44.590)(55.115,44.590)(55.134,44.583)(55.154,44.577)(55.174,44.570)(55.175,44.570)(55.194,44.563)(55.214,44.556)(55.231,44.550)(55.234,44.548)(55.254,44.541)(55.274,44.533)(55.283,44.530)(55.294,44.525)(55.314,44.517)(55.332,44.510)(55.334,44.509)(55.354,44.500)(55.374,44.491)(55.378,44.490)(55.394,44.482)(55.414,44.473)(55.422,44.470)(55.434,44.464)(55.454,44.455)(55.464,44.450)(55.474,44.445)(55.494,44.435)(55.505,44.430)(55.514,44.425)(55.534,44.415)(55.544,44.410)(55.554,44.404)(55.574,44.393)(55.581,44.390)(55.594,44.383)(55.614,44.371)(55.618,44.370)(55.634,44.360)(55.653,44.350)(55.654,44.349)(55.674,44.337)(55.687,44.330)(55.694,44.325)(55.714,44.313)(55.720,44.310)(55.734,44.300)(55.752,44.290)(55.754,44.288)(55.774,44.275)(55.783,44.270)(55.794,44.262)(55.813,44.250)(55.814,44.249)(55.834,44.235)(55.843,44.230)(55.854,44.222)(55.872,44.210)(55.874,44.208)(55.894,44.194)(55.900,44.190)(55.914,44.179)(55.927,44.170)(55.934,44.165)(55.954,44.150)(55.954,44.150)(55.974,44.135)(55.981,44.130)(55.994,44.119)(56.007,44.110)(56.014,44.104)(56.032,44.090)(56.034,44.088)(56.054,44.072)(56.057,44.070)(56.074,44.055)(56.081,44.050)(56.094,44.039)(56.105,44.030)(56.114,44.022)(56.129,44.010)(56.134,44.005)(56.152,43.990)(56.154,43.988)(56.174,43.970)(56.175,43.970)(56.194,43.952)(56.197,43.950)(56.214,43.934)(56.219,43.930)(56.234,43.915)(56.241,43.910)(56.254,43.897)(56.262,43.890)(56.274,43.878)(56.283,43.870)(56.294,43.858)(56.303,43.850)(56.314,43.839)(56.324,43.830)(56.334,43.819)(56.344,43.810)(56.354,43.799)(56.363,43.790)(56.374,43.778)(56.383,43.770)(56.394,43.757)(56.402,43.750)(56.414,43.736)(56.421,43.730)(56.434,43.715)(56.439,43.710)(56.454,43.693)(56.458,43.690)(56.474,43.671)(56.476,43.670)(56.493,43.650)(56.494,43.649)(56.511,43.630)(56.514,43.626)(56.528,43.610)(56.534,43.603)(56.546,43.590)(56.554,43.579)(56.563,43.570)(56.574,43.555)(56.579,43.550)(56.594,43.531)(56.596,43.530)(56.612,43.510)(56.614,43.507)(56.628,43.490)(56.634,43.482)(56.644,43.470)(56.654,43.457)};

%% местонахождение городов
\addplot[ball darkblue,only marks]coordinates{(55.664,37.630)}
node[below,text=black]{Москва};
\addplot[ball darkblue,only marks]coordinates{(51.534,46.031)}
node[above,text=black]{Саратов};
\addplot[ball darkblue,only marks]coordinates{(56.671,39.162)}
node[above,text=black]{Воронеж};
\begin{scope}[font=\footnotesize]
%% начальная точка
%\addplot[darkred,mark=*,mark size=2.5pt]
\addplot[ball darkred]
coordinates{(\phiStart,\lambdaStart)}
node[below left]{$(\phi_0,\lambda_0)$};
%% смещение по phi
\addplot[->,gray,thin,dashed,opacity=0.5]
coordinates{(\phiStart,\lambdaStart) (\phiMin,\lambdaStart)}
node[above,opacity=1,text=darkred]{$(\phi_{\min},\lambda_0)$};;
%% смещение по lambda
\addplot[->,gray,thin,dashed,opacity=0.5]
coordinates{(\phiMin,\lambdaStart) (\phiMin,\lambdaMin)};
%% конечное положение
\addplot[darkred]
coordinates{(\phiMin,\lambdaMin)}
node[below]{$(\phi_{\min},\lambda_{\min})$};
\end{scope}
%% результирующее смещение
\draw[darkred,->]
(axis cs: 52.0,44.0) -- (axis cs: \phiStart,\lambdaStart);
\draw[darkred,->]
(axis cs: \phiStart,\lambdaStart) -- (axis cs: \phiMin,\lambdaMin)
node[sloped,pos=0.5,below]{$\xi$};
\end{axis}
\end{tikzpicture}
\caption{``Рельеф`` целевой функции $r(\phi,\lambda)$ и 
``траектория`` поиска местоположения склада $(\phi,\lambda)$
торговой сети (маркерами обозначены города)}
\label{fig:min2}
\end{figure}


%
% новое положение склада
%
\def\phiStart{55.94734}
\def\lambdaStart{38.88818}
% частный минимум phi
\def\phiMin{55.88973}
% частный минимум lambda
\def\lambdaMin{38.83941}
% epsilon
\def\epsilonOne{0.07548}
%
\item
За новое местоположение склада торговой сети 
принимается положение ``частного`` минимума 
целевой функции на предыдущем шаге итерационного процесса:
\begin{equation*}
\left\{\begin{matrix}[lcl]
\phi_0 = \phi_{\min}&=&\phiStart\\
\lambda_0 = \lambda_{\min}&=&\lambdaStart\\
\end{matrix}\right.
\end{equation*}

\item
Считаем постоянными значения долготы склада 
$\lambda=\lambda_0=\const$
и рассматриваем вспомогательную функцию
только одной переменной $\phi$:
\begin{equation*}
\rho_1(\phi)=f(\phi, \lambda_0)=f(\phi,\lambdaStart)
\end{equation*}

Находим минимум вспомогательной функции 
одной переменной $\rho_1(\phi)$, используя метод 
одномерной минимизации:
\begin{equation*}
\phi_{\min}
=\arg\left(
\min_{\phi_{\inf}\leqslant\phi\leqslant\phi_{\sup}}\rho_1(\phi)
\right)
=\phiMin
\end{equation*}
где $\phi_{\min}$ -- положение ``частного`` минимума
функции $f(\phi, \lambdaStart)$.

Считаем постоянными значения широты склада 
$\phi=\phi_{\min}=\const$ 
и рассматриваем вторую вспомогательную функцию
только одной переменной $\lambda$:
\begin{equation*}
\rho_2(\lambda)=f(\phi_{\min},\lambda)=f(\phiMin,\lambda)
\end{equation*}

Находим минимум функции одной переменной $\rho_2(\lambda)$,
используя метод одномерной минимизации:
\begin{equation*}
\lambda_{\min}
=\arg\left(
\min_{\lambda_{\inf}\leqslant\lambda\leqslant\lambda_{\sup}}\rho_2(\lambda)
\right)
=\lambdaMin
\end{equation*}
где $\lambda_{\min}$ -- положение ``частного`` минимума
функции $f(\phiMin,\lambda)$.

\item
Определяем изменение местоположения склада 
\eqref{eq:GCS:step error} в результате проведенных 
итерационных процессов (рисунок \ref{fig:min3}):
\begin{equation*}
\begin{split}
\xi=\;
&\sqrt{(\phi_{\min}-\phi_0)^2+(\lambda_{\min}-\lambda_0)^2}=\\
=\;&\sqrt{(\phiMin-\phiStart)^2+(\lambdaMin-\lambdaStart)^2}=\\
=\;&\epsilonOne\\
\end{split}
\end{equation*}

Находим значение целевой функции в начальной 
$f(\phi_0,\lambda_0)$ и конечной точки 
$f(\phi_{\min},\lambda_{\min})$ точках 
местоположения склада:
\begin{equation*}
\begin{matrix}[lclcl]
f(\phi_0,\lambda_0)&=&f(\phiStart,\lambdaStart)&=&845.572\\
f(\phi_{\min},\lambda_{\min})&=&f(\phiMin,\lambdaMin)&=&845.314\\
\end{matrix}
\end{equation*}

Сравниваем величину текущего ``шага`` $\xi$ и 
заданную точность расчетов $\epsilon_1$,
а также значения целевой функции $f(\phi,\lambda)$ в начальной
и конечной точки итерационного процесса:
\begin{equation*}
\begin{matrix}[rcl]
\epsilon_1=0.1&>&\xi=\epsilonOne\\
f(\phi_{\min},\lambda_{\min})=845.314&<&f(\phi_0,\lambda_0)=845.572\\
\end{matrix}
\end{equation*}

Критерий остановки итерационного процесса 
\eqref{eq:stop condition} выполняется,
следовательно, \emph{итерационный процесс прекращаем}!

%
% График: траектория поиска минимума
%
\begin{figure}[H]\centering
\begin{tikzpicture}
[>={Straight Barb[angle=45:1.5mm 1]},shorten >=0pt,shorten <=0pt]
\begin{axis}[enlargelimits=0.2,grid=none,
xlabel={широта $\phi$},ylabel={долгота $\lambda$},
xmin=51.25,xmax=56.75,xtick={51,52,53,54,55,56,57},
ymin=36.25,ymax=45.75,ytick={36,38,40,42,44,46},
]
%% изолинии
%% местонахождение городов
\addplot[ball darkblue,only marks]coordinates{(55.664,37.630)}
node[below,text=black]{Москва};
\addplot[ball darkblue,only marks]coordinates{(51.534,46.031)}
node[above,text=black]{Саратов};
\addplot[ball darkblue,only marks]coordinates{(56.671,39.162)}
node[above,text=black]{Воронеж};
\begin{scope}[font=\footnotesize]
%% начальная точка
\addplot[ball darkred]coordinates{(52.0,44.0)}
node[above]{$(\phi_0,\lambda_0)$};
%% 'траектория' поиска минимума
\addplot[gray,thin,dashed,opacity=0.5]coordinates{(52.00000,44.00000)(54.66658,44.00000)(54.66658,39.49103)(55.94734,39.49103)(55.94734,38.88818)(55.88973,38.88818)(55.890,38.839)};
%%
\draw[darkred,->] (axis cs:52.0,44.0) -- (axis cs:54.66658,39.49103);
\draw[darkred,->] (axis cs:54.66658,39.49103) -- (\phiMin,\lambdaMin);
%% конечное положение
\addplot[ball darkred]coordinates{(\phiMin,\lambdaMin)}
node[below,xshift=+10pt]{склад};
\end{scope}
\end{axis}
\end{tikzpicture}
\caption{``Рельеф`` целевой функции $r(\phi,\lambda)$ и 
``траектория`` поиска местоположения склада $(\phi,\lambda)$
торговой сети (маркерами обозначены города)}
\label{fig:min3}
\end{figure}


%\item
%С помощью метода по координатного спуска,
%определим оптимальные географические координаты склада 
%$(\phi_{\min}, \lambda_{\min})$, при которых 
%суммарное расстояние $r(\phi,\lambda)$ от склада до 
%всех магазинов торговой сети в городах Москва, Саратов и Воронеж
%минимально.

\end{enumerate}


\subsubsection{Метод градиентного спуска}
Известны местоположение трех городов торговой сети 
\emph{в декартовой системе координат}: 
\href{https://ru.wikipedia.org/wiki/\%D0\%9D\%D0\%B8\%D0\%BF\%D0\%BF\%D1\%83\%D1\%80}{Ниппур} $(4,2)$,
\href{https://ru.wikipedia.org/wiki/\%D0\%AD\%D1\%80\%D0\%B8\%D0\%B4\%D1\%83}{Эриду} $(1,7)$
\href{https://ru.wikipedia.org/wiki/\%D0\%A8\%D1\%83\%D1\%80\%D1\%83\%D0\%BF\%D0\%BF\%D0\%B0\%D0\%BA}{Шуруппак} $(8,4)$.
% *******************************
%	График функций
%
\begin{figure}[H]\centering
\begin{tikzpicture}
\begin{axis}[
	enlargelimits=true,
	xlabel = {широта ($x$)},	% подпись оси x
	ylabel = {долгота ($y$)},	% подпись оси y
	xmin=0,ymin=0,xmax=10,ymax=10,
]
% Склад
\addplot[ball darkred] coordinates {(5,9)} coordinate (wh)
node[above right]{склад $(x_0,y_0)$};
% города
\addplot[ball darkblue] coordinates {(4,2)} coordinate (c1)
node[below]{Ниппур};
\addplot[ball darkblue] coordinates {(1,7)} coordinate (c2)
node[below]{Эриду};
\addplot[ball darkblue] coordinates {(8,4)} coordinate (c3)
node[below]{Шуруппак};
% расстояние
\begin{scope}[color=darkblue]
\draw (wh) -- (c1) node [sloped,midway,above] {$r_1$};
\draw (wh) -- (c2) node [sloped,midway,above] {$r_2$};
\draw (wh) -- (c3) node [sloped,midway,above] {$r_3$};
\end{scope}
\end{axis}
\end{tikzpicture}
\end{figure}
% *******************************

\begin{enumerate}
\item
Обозначим неизвестные:\\
$x$ и $y$ -- положения склада по горизонтальной
и вертикальной оси координат, соответственно.
\item
Целевая функция -- суммарное расстояние от склада до всех магазинов:
\begin{gather*}
f=r_1 + r_2 + r_3,
\end{gather*}
где $r_1$, $r_2$ и $r_3$ -- расстояние от \alert{склада}
до городов {Ниппур}, {Эриду} и {Шуруппак}, соответственно.
\item
В выбранной декартовой системе координат и 
для нахождения расстояния от склада до каждого 
города воспользуемся теоремой 
\href{https://ru.wikipedia.org/wiki/\%D0\%9F\%D0\%B8\%D1\%84\%D0\%B0\%D0\%B3\%D0\%BE\%D1\%80}{Пифагора Самосского}:
\begin{gather*}
r_1=\sqrt{(x_1-x)^2+(y_1-y)^2}\\
r_2=\sqrt{(x_2-x)^2+(y_2-y)^2}\\
r_3=\sqrt{(x_3-x)^2+(y_3-y)^2},
\end{gather*}
где 
$x_1$ и $y_1$ -- декартовы координаты города Ниппур;
$x_2$ и $y_2$ -- декартовы координаты города Эриду;
$x_3$ и $y_3$ -- декартовы координаты города Шуруппак.

Таким образом, целевая функция -- суммарное расстояние 
от склада до всех городов, с учетом данных задания 
о координатах городов (Ниппур, Эриду и Шуруппак),
запишется в виде:
\begin{gather*}
\begin{split}
f(x,y)=
&\sqrt{(4-x)^2+(2-y)^2}\;+\\
&\sqrt{(1-x)^2+(7-y)^2}\;+\\
&\sqrt{(8-x)^2+(4-y)^2}
\end{split}
\end{gather*}

\item
Определим градиент целевой функции $\nabla{f(x,y)}$:
\begin{gather*}
\nabla{f(x,y)}=\left(\pdiff{f}{x},\,\pdiff{f}{y}\right)
\end{gather*}
Для этого найдем частные производные целевой функции 
от координат $x$ и $y$ положения склада:
\begin{gather*}
\begin{split}
\pdiff{f}{x}=
-&\dfrac{4-x}{\sqrt{(4-x)^2+(2-y)^2}}\\
-&\dfrac{1-x}{\sqrt{(1-x)^2+(7-y)^2}}\\
-&\dfrac{8-x}{\sqrt{(8-x)^2+(4-y)^2}}\\
\end{split}
\end{gather*}

\begin{gather*}
\begin{split}
\pdiff{f}{y}=
-&\dfrac{2-y}{\sqrt{(4-x)^2+(2-y)^2}}\\
-&\dfrac{7-y}{\sqrt{(1-x)^2+(7-y)^2}}\\
-&\dfrac{4-y}{\sqrt{(8-x)^2+(4-y)^2}}\\
\end{split}
\end{gather*}

\item
Выбираем (в общем случае, произвольно)
начальные координаты склада, например, $x_0=5$ и $y_0=9$,
скорость градиентного спуска $\lambda=2$ и
точность расчёта $\epsilon_1=0.25$ (единиц измерения).

\item
Текущее суммарное расстояние от склада до всех городов:
\begin{gather*}
\begin{split}
R_0=f(5,9)=
&\sqrt{(4-5)^2+(2-9)^2}\\
+&\sqrt{(1-5)^2+(7-9)^2}\\
+&\sqrt{(8-5)^2+(4-9)^2}=17.37
\end{split}
\end{gather*}

Определим градиент целевой функции в начальной точке 
положения склада $(x_0,y_0)$:
\begin{gather*}
\begin{split}
\left.\pdiff{f}{x}\right\rvert_{
\begin{smallmatrix}x&=&5\\y&=&9\end{smallmatrix}
}=
-&\dfrac{4-5}{\sqrt{(4-5)^2+(2-9)^2}}\\
-&\dfrac{1-5}{\sqrt{(1-5)^2+(7-9)^2}}\\
-&\dfrac{8-5}{\sqrt{(8-5)^2+(4-9)^2}}=0.52
\end{split}
\end{gather*}
\begin{gather*}
\begin{split}
\left.\pdiff{f}{y}\right\rvert_{
\begin{smallmatrix}x&=&5\\y&=&9\end{smallmatrix}
}=
-&\dfrac{2-9}{\sqrt{(4-5)^2+(2-9)^2}}\\
-&\dfrac{7-9}{\sqrt{(1-5)^2+(7-9)^2}}\\
-&\dfrac{4-9}{\sqrt{(8-5)^2+(4-9)^2}}=2.29
\end{split}
\end{gather*}

Зная градиент целевой функции в начальной точке 
$\nabla f(x_0,y_0)=(0.52, 2.29)$,
определим новые координаты склада:
\begin{gather*}
x_1=x_0 - \lambda\cdot
\left.\pdiff{f}{x}\right\rvert_{
\begin{smallmatrix}x=5\\y=9\end{smallmatrix}
}=5-2\cdot0.52=3.96\\
y_1=y_0 - \lambda\cdot
\left.\pdiff{f}{y}\right\rvert_{
\begin{smallmatrix}x=5\\y=9\end{smallmatrix}
}
=9-2\cdot2.29=4.41
\end{gather*}

\emph{Новые координаты склада} 
$(x_1=3.96; y_1=4.41)$.
% *******************************
%	График функций
%
\begin{figure}[H]\centering
\begin{tikzpicture}[% стрелка
>={Straight Barb[angle=45:2mm 1]},shorten >=2.5pt,
]
\begin{axis}[
	enlargelimits=true,
	xlabel = {широта ($x$)},	% подпись оси x
	ylabel = {долгота ($y$)},	% подпись оси y
	xmin = 0, ymin = 0,
	xmax = 10, ymax = 10,	
]
\addplot[->,ball darkred] coordinates {(5,9) (3.96,4.41)} coordinate (wh)
node[left]{склад};
\draw[darkred] (axis cs: 5,9) node[above]{$(x_0,y_0)$};
% города
\addplot[ball darkblue] coordinates {(4,2)} coordinate (c1)
node[below]{Ниппур};
\addplot[ball darkblue] coordinates {(1,7)} coordinate (c2)
node[above]{Эриду};
\addplot[ball darkblue] coordinates {(8,4)} coordinate (c3)
node[below]{Шуруппак};
\end{axis}
\end{tikzpicture}
\end{figure}
% *******************************

Рассчитаем величину ``шага`` -- расстояния между двумя 
последовательными положениями склада:
\begin{gather*}
\xi=\sqrt{(5-3.96)^2+(9-4.41)^2}=4.71
\end{gather*}

Сравниваем величину текущего ``шага`` $\xi$ и 
заданную точность расчетов $\epsilon_1$:
\begin{gather*}
\xi=4.71>\epsilon_1=0.25
\end{gather*}
Величина текущего ``шага`` $r$ больше заданной 
точности расчетов $\epsilon_1$,
следовательно, \emph{итерационный процесс продолжаем}!

\item
Текущее суммарное расстояние от склада до всех городов:
\begin{gather*}
\begin{split}
R_1=f(3.96,4.41)=
&\sqrt{(4-3.96)^2+(2-4.41)^2}\\
+&\sqrt{(1-3.96)^2+(7-4.41)^2}\\
+&\sqrt{(8-3.96)^2+(4-4.41)^2}=10.41
\end{split}
\end{gather*}

Суммарное расстояние уменьшилось:
\begin{equation*}
R_1=10.41<R_0=17.37.
\end{equation*}

Рассчитаем градиент целевой функции в новой точке 
положения склада\linebreak $x_1=3.96$ и $y_1=4.41$:
\begin{gather*}
\begin{split}
\left.\pdiff{f}{x}\right\rvert_{
\begin{smallmatrix}x_1&=&3.96\\y_1&=&4.41\end{smallmatrix}
}=
-&\dfrac{4-3.96}{\sqrt{(4-3.96)^2+(2-4.41)^2}}\\
-&\dfrac{1-3.96}{\sqrt{(1-3.96)^2+(7-4.41)^2}}\\
-&\dfrac{8-3.96}{\sqrt{(8-3.96)^2+(4-4.41)^2}}=-0.26\\
\end{split}
\end{gather*}
\begin{gather*}
\begin{split}
\left.\pdiff{f}{y}\right\rvert_{
\begin{smallmatrix}x_1&=&3.96\\y_1&=&4.41\end{smallmatrix}
}=
-&\dfrac{2-4.41}{\sqrt{(4-3.96)^2+(2-4.41)^2}}\\
-&\dfrac{7-4.41}{\sqrt{(1-3.96)^2+(7-4.41)^2}}\\
-&\dfrac{4-4.41}{\sqrt{(8-3.96)^2+(4-4.41)^2}}=0.44
\end{split}
\end{gather*}

Зная градиент целевой функции в текущей точке 
$\nabla f(x_1,y_1)=(-0.26,0.44)$,
определим новые координаты склада:
\begin{gather*}
x_2=x_1 - \lambda\cdot
\left.\pdiff{f}{x}\right\rvert_{
\begin{smallmatrix}x=3.96\\y=4.41\end{smallmatrix}
}=
3.96-2\cdot(-0.26)=4.48\\
y_2=y_1 - \lambda\cdot
\left.\pdiff{f}{y}\right\rvert_{
\begin{smallmatrix}x=3.96\\y=4.41\end{smallmatrix}
}=
4.41-2\cdot0.44=3.53\\
\end{gather*}

\emph{Новые координаты склада} 
$(x_2=4.48, y_2=3.53)$.
% *******************************
%	График функций
%
\begin{figure}[H]\centering
\begin{tikzpicture}[% стрелка
>={Straight Barb[angle=45:2mm 1]},shorten >=2.5pt,
]
\begin{axis}[
	enlargelimits=true,
	xlabel = {широта ($x$)},	% подпись оси x
	ylabel = {долгота ($y$)},	% подпись оси y
	xmin = 0, ymin = 0,
	xmax = 10, ymax = 10,	
]
% Склад
\addplot[->,ball darkred] coordinates {(5,9) (3.96,4.41) (4.48,3.53)};
\draw[darkred] (axis cs: 5,9) node[above]{$(x_0,y_0)$};
\draw[darkred] (axis cs: 3.96,4.41) node[left]{$(x_1,y_1)$};
\draw[darkred] (axis cs: 4.48,3.53) node[below right]{склад};
% города
\addplot[ball darkblue] coordinates {(4,2)}
node[below]{Ниппур};
\addplot[ball darkblue] coordinates {(1,7)}
node[above]{Эриду};
\addplot[ball darkblue] coordinates {(8,4)}
node[above]{Шуруппак};
\end{axis}
\end{tikzpicture}
\end{figure}
% *******************************

Рассчитаем величину ``шага`` -- расстояния между 
двумя последовательными положениями склада:
\begin{gather*}
\xi=\sqrt{(3.96-4.48)^2+(4.41-3.53)^2}=1.03
\end{gather*}

Сравниваем величину текущего ``шага`` $\xi$ и 
заданную точность расчетов $\epsilon_1$:
\begin{gather*}
\xi=1.03>\epsilon_1=0.25
\end{gather*}
Величина текущего ``шага`` $\xi$ больше заданной точности 
расчетов $\epsilon_1$, следовательно, 
\emph{итерационный процесс продолжаем}!

\item
Текущее суммарное расстояние от склада до всех городов:
\begin{gather*}
\begin{split}
R_2=f(4.48,3.53)=
&\sqrt{(4-4.48)^2+(2-3.53)^2}\\
+&\sqrt{(1-4.48)^2+(7-3.53)^2}\\
+&\sqrt{(8-4.48)^2+(4-3.53)^2}=10.07
\end{split}
\end{gather*}

Рассчитаем градиент целевой функции в новой точке 
положения склада\linebreak $x_2=4.48$ и $y_2=3.53$:
\begin{gather*}
\begin{split}
\left.\pdiff{f}{x}\right\rvert_{
\begin{smallmatrix}x_2&=&4.48\\y_2&=&3.53\end{smallmatrix}
}=
-&\dfrac{4-4.48}{\sqrt{(4-4.48)^2+(2-3.53)^2}}\\
-&\dfrac{1-4.48}{\sqrt{(1-4.48)^2+(7-3.53)^2}}\\
-&\dfrac{8-4.48}{\sqrt{(8-4.48)^2+(4-3.53)^2}}=0.02
\end{split}
\end{gather*}
\begin{gather*}
\begin{split}
\left.\pdiff{f}{y}\right\rvert_{
\begin{smallmatrix}x_2&=&4.48\\y_2&=&3.53\end{smallmatrix}
}=
-&\dfrac{2-3.53}{\sqrt{(4-4.48)^2+(2-3.53)^2}}\\
-&\dfrac{7-3.53}{\sqrt{(1-4.48)^2+(7-3.53)^2}}\\
-&\dfrac{4-3.53}{\sqrt{(8-4.48)^2+(4-3.53)^2}}=0.11
\end{split}
\end{gather*}

Зная градиент целевой функции в текущей точке 
$\nabla f(x_2,y_2)=(0.02,0.11)$,
определяют новое географическое положение склада:
\begin{gather*}
x_3=x_2 - \lambda\cdot
\left.\pdiff{f}{x}\right\rvert_{
\begin{smallmatrix}x=4.48\\y=3.53\end{smallmatrix}
}=4.48-2\cdot0.02=4.45\\
y_3=y_2 - \lambda\cdot
\left.\pdiff{f}{y}\right\rvert_{
\begin{smallmatrix}x=4.48\\y=3.53\end{smallmatrix}
}=3.53-2\cdot0.11=3.30\\
\end{gather*}

\emph{Новые координаты склада} 
$(x_0=4.45, y_0=3.30)$.
% *******************************
%	График функций
%
\begin{center}
\begin{tikzpicture}[% стрелка
>={Straight Barb[angle=45:2mm 1]},shorten >=2.5pt,
]
\begin{axis}[
	enlargelimits=true,
	xlabel = {широта ($x$)},	% подпись оси x
	ylabel = {долгота ($y$)},	% подпись оси y
	xmin = 0, ymin = 0,
	xmax = 10, ymax = 10,	
]
% склад
\addplot[ball darkred] coordinates {(5,9) (3.96,4.41) (4.48,3.53) (4.45,3.30)};
\draw[darkred] (axis cs: 5,9) node[above]{$(x_0,y_0)$};
\draw[darkred] (axis cs: 3.96,4.41) node[left]{$(x_1,y_1)$};
\draw[darkred] (axis cs: 4.48,3.53) node[right]{$(x_2,y_2)$};
\draw[darkred] (axis cs: 4.45,3.30) node[below]{склад};
% города
\addplot[ball darkblue] coordinates {(4,2)}
node[below]{Ниппур};
\addplot[ball darkblue] coordinates {(1,7)}
node[above]{Эриду};
\addplot[ball darkblue] coordinates {(8,4)}
node[above]{Шуруппак};
\end{axis}
\end{tikzpicture}
\end{center}
% *******************************


Рассчитаем величину ``шага`` $\xi$ -- расстояния между 
двумя последовательными положениями склада:
\begin{gather*}
\xi=\sqrt{(4.48-4.45)^2+(3.53-3.30)^2}=0.23
\end{gather*}

Сравниваем величину текущего ``шага`` $xi$ и 
заданную точность расчетов $\epsilon_1$:
\begin{gather*}
\xi=0.23<\epsilon_1=0.25
\end{gather*}
Величина текущего ``шага`` $\xi$ меньше заданной 
точности расчетов $\epsilon_1$,
поэтому итерационный процесс поиска положения склада 
\emph{прекращаем}!

\item
Определим минимальное расстояние от склада до всех городов:
\begin{gather*}
\begin{split}
R_4=f(4.45,3.30)=
&\sqrt{(4-4.45)^2+(2-3.30)^2}\\
+&\sqrt{(1-4.45)^2+(7-3.30)^2}\\
+&\sqrt{(8-4.45)^2+(4-3.30)^2}=10.05
\end{split}
\end{gather*}
\end{enumerate}

Таким образом, с заданной точностью определены оптимальные 
координаты склада $(x_{\min}=4.45, y_{\min}=3.30)$, 
при которых общее расстояние от всех городов до склада 
будет минимальным и составит $R_{\min}=10.05$:

\end{document}
