\newpage
\section{Интерполирование функций}
%
%	Интерполяция функций полиномами Лагранжа
%
\subsection{Интерполяция функций полиномами Лагранжа}
Пусть на отрезке $x\in[a, b]$ выбрана сетка
$\{x_i\}$ (здесь $i=0, 1, \ldots, n$), в узлах которой 
известны значения функции $y_{i}=f(x_{i})$.
Задача интерполирования алгебраическими многочленами 
состоит в том, чтобы построить многочлен степени $n$
\begin{equation*}
L_{n}(x)
=c_{0} + c_{1}\cdot{x} + c_{2}\cdot{x^2} + \ldots + c_{n}\cdot{x^n}
=\sum\limits_{i=0}^{n}c_i\cdot x^i
\end{equation*}
значения которого в заданных точках $\{x_i\}$, 
совпадают со значениями функции $\{y_i\}$ в этих точках.

Во всех узлах сетки $\{x_i\}$ многочлен $L_{n}(x)$
должен удовлетворять условиям:
\begin{equation*}
\label{inter}
\left\{\begin{matrix}
L_{n}(x_0)&=&y_0\\
L_{n}(x_1)&=&y_1\\
L_{n}(x_2)&=&y_2\\
\hdotsfor{3}\\
L_{n}(x_n)&=&y_n\\
\end{matrix}\right.
\end{equation*}

Интерполяционная формула Лагранжа позволяет 
представить многочлен $L_{n}(x)$ в виде 
линейной комбинации значений функции $y(x)$ 
в узлах интерполирования:
\begin{equation*}
\label{lagrang}
L_{n}(x) = 
c_{0}(x)\cdot{y_0} + 
c_{1}(x)\cdot{y_1} + 
c_{2}(x)\cdot{y_2} + \ldots + 
c_{n}(x)\cdot{y_n}
\end{equation*}
где $c_0(x), c_1(x), c_2(x), \ldots, c_n(x)$ --
неизвестные функции.

Из условий интерполирования:
\begin{equation*}\label{inter2}
\left\{\begin{matrix}
c_0(x_0)\cdot{y_0} + c_1(x_0)\cdot{y_1} + c_2(x_0)\cdot{y_2}
+ \ldots + c_n(x_0)\cdot{y_n}&=&y_0\\
c_0(x_1)\cdot{y_0} + c_1(x_1)\cdot{y_1}  + c_2(x_1)\cdot{y_2}
+ \ldots + c_n(x_1)\cdot{y_n}&=&y_1\\
c_0(x_2)\cdot{y_0} + c_1(x_2)\cdot{y_1} + c_2(x_2)\cdot{y_2}
+ \ldots + c_n(x_2)\cdot{y_n}&=&y_2\\
\hdotsfor{3}\\
c_0(x_n)\cdot{y_0} + c_1(x_n)\cdot{y_1} + c_2(x_n)\cdot{y_2}
+ \ldots + c_n(x_n)\cdot{y_n}&=&y_n\\
\end{matrix}\right.
\end{equation*}

Система уравнений совместна если выполняются условия:
\begin{equation*}
\label{uslovia_c}
c_{i}(x_j)=\left\{\begin{matrix}
1, &x_j=x_{i}\\
0, &x_j\ne{x_{i}}
\end{matrix}\right.
\end{equation*}

Коэффициенты $c_{i}(x)$ можно искать в виде 
многочленов степени $n$:
\begin{equation*}
\label{eq_c}
\left\{\begin{matrix}
c_0(x)&=&\alpha_0\cdot(x-x_1)\cdot(x-x_2)
\cdot(x-x_2)\cdot&\ldots&\cdot(x-x_n)\\
c_1(x)&=&\alpha_1\cdot(x-x_0)\cdot(x-x_2)
\cdot(x-x_3)\cdot&\ldots&\cdot(x-x_n)\\
\hdotsfor{5}\\
c_n(x)&=&\alpha_n\cdot(x-x_0)\cdot(x-x_1)
\cdot(x-x_2)\cdot&\ldots&\cdot(x-x_{n-1})
\end{matrix}\right.
\end{equation*}

Определим неизвестные 
$\alpha_0, \alpha_1, \ldots, \alpha_n$ 
из условия для коэффициентов $c_i(x)$:
\begin{equation*}
\left\{
\begin{matrix}
1&=&\alpha_0\cdot(x_0-x_1)\cdot(x_0-x_2)\cdot(x_0-x_2)\cdot&
\dots&\cdot(x_0-x_n)\\
1&=&\alpha_1\cdot(x_1-x_0)\cdot(x_1-x_2)\cdot(x_1-x_3)\cdot&
\dots&\cdot(x_1-x_n)\\
%\hdotsfor{7}\\
%1&=&\alpha_{i}\cdot(x_{i}-x_{0})\cdot(x_{i}-x_{1})\cdot &\ldots &\cdot(x_{i}-x_{i-1})\cdot(x_{i}-x_{i+1})\cdot &\ldots &\cdot(x_{i}-x_{n})\\
\hdotsfor{5}\\
1&=&\alpha_n\cdot(x_n-x_0)\cdot(x_n-x_1)\cdot(x_n-x_2)\cdot&
\dots&\cdot(x_n-x_{n-1})
\end{matrix}
\right.
\end{equation*}

Таким образом, коэффициенты $c_{i}(x)$ 
интерполяционного многочлена находятся из соотношений:
\begin{equation*}
\left\{\begin{matrix}
c_0(x)&=&\dfrac
{(x-x_1)\cdot(x-x_2)\cdot\dots\cdot(x-x_n)}
{(x_0-x_1)\cdot(x_0-x_2)\cdot \ldots \cdot(x_0-x_n)}\\[1em]
c_1(x)&=&\dfrac
{(x-x_0)\cdot(x-x_2)\cdot\ldots\cdot(x-x_n)}
{(x_1-x_0)\cdot(x_1-x_2)\cdot \ldots \cdot(x_1-x_n)}\\[1em]
\hdotsfor{3}\\[1em]
c_n(x)&=&\dfrac
{(x-x_0)\cdot(x-x_1)\cdot\ldots\cdot(x-x_{n-1})}
{(x_n-x_0)\cdot(x_n-x_1)\cdot \ldots \cdot(x_n-x_{n-1})}
\end{matrix}\right.
\end{equation*}

Или в более компактной форме:
\begin{equation*}
c_i(x)=\dfrac
{\prod\limits_{j \ne i}^n (x - x_j)}
{\prod\limits_{j \ne i}^n (x_i - x_j)}
\end{equation*}

Итак, интерполяционный многочлен Лагранжа имеет вид:
\begin{equation*}
L_{n}(x)=\sum\limits_{i=0}^n\dfrac
{\prod\limits_{j \ne i}^n(x-x_j) }
{\prod\limits_{j \ne i}^n(x_i-x_j)}\cdot{y_i}
\end{equation*}

%
%	Интерполирование таблично заданной функции полином Лагранжа $L_3(x)$
%
\subsection{Пример интерполирование функции полином Лагранжа $L_3(x)$}
Известно множество данных (узлов интерполяции)
$\{x_i\}$ ($i=0,1,2,3$), в которых определены 
значения функции $y_i=f(x_i)$:
\begin{table}[h]
\vspace{-0.5\baselineskip}
\caption{Таблично заданная функциональная зависимость}
\begin{tabular*}{\textwidth}{%
l@{\extracolsep{\fill}}*{4}{r}p{0.25cm}}
\toprule
$i$&$0$&$1$&$2$&$3$\\
\midmidrule
$x_i$&$-0.76$&$-0.09$&$0.22$&$0.55$\\
\addlinespace% дополнительный пробел
$y_i$&$0.08$&$1.84$&$0.40$&$0.96$\\
\bottomrule
\end{tabular*}
\end{table}

Построим интерполяционный полином Лагранжа $L_3(x)$
на основе данных об узлах интерполяции $\{x_i\}$ 
и значений функции в этих точках $\{y_i\}$:
\begin{gather*}
L_{3}(x)=\sum \limits_{i=0}^3\dfrac
{\prod\limits_{j \ne i}^3(x-x_j)}
{\prod\limits_{j \ne i}^3(x_i-x_j)}\cdot{y_i}
\end{gather*}

\begin{enumerate}
\item
Представим полином Лагранжа в развернутом виде:
\begin{gather*}
\begin{matrix}
L_{3}(x)=
&&\dfrac{(x-x_1)(x-x_2)(x-x_3)}{(x_0-x_1)(x_0-x_2)(x_0-x_3)}\cdot y_0&+\\[1em]
&+&\dfrac{(x-x_0)(x-x_2)(x-x_3)}{(x_1-x_0)(x_1-x_2)(x_1-x_3)}\cdot y_1&+\\[1em]
&+&\dfrac{(x-x_0)(x-x_1)(x-x_3)}{(x_2-x_0)(x_2-x_1)(x_2-x_3)}\cdot y_2&+\\[1em]
&+&\dfrac{(x-x_0)(x-x_1)(x-x_2)}{(x_3-x_0)(x_3-x_1)(x_3-x_2)}\cdot y_3&
\end{matrix}
\end{gather*}

\item
Воспользуемся численными данными об узлах интерполяции 
$\{x_i\}$ и известными значениями интерпретируемой функции 
в этих узлах $\{y_i\}$:
\begin{gather*}
\begin{matrix}
L_{3}(x)=
&&\dfrac{(x-(-0.09))(x-0.22)(x-0.55)}{(-0.76-(-0.09))(-0.76-0.22)(-0.76-0.55)}\cdot0.08&+\\[1em]
&+&\dfrac{(x-(-0.76))(x-0.22)(x-0.55)}{(-0.09-(-0.76))(-0.09-0.22)(-0.09-0.55)}\cdot1.84&+\\[1em]
&+&\dfrac{(x-(-0.76))(x-(-0.09))(x-0.55)}{(0.22-(-0.76))(0.22-(-0.09))(0.22-0.55)}\cdot0.40&+\\[1em]
&+&\dfrac{(x-(-0.76))(x-(-0.09))(x-0.22)}{(0.55-(-0.76))(0.55-(-0.09))(0.55-0.22)}\cdot0.96&
\end{matrix}
\end{gather*}

\item
Проведем необходимые арифмитические действия:
\begin{gather*}
\begin{matrix}
L_{3}(x)=
&&\dfrac{(x+0.09)(x-0.22)(x-0.55)}{(-0.67)(-0.98)(-1.31)}\cdot0.08&+\\[1em]
&+&\dfrac{(x+0.76)(x-0.22)(x-0.55)}{(0.67)(-0.31)(-0.64)}\cdot1.84&+\\[1em]
&+&\dfrac{(x+0.76)(x+0.09)(x-0.55)}{(0.98)(0.31)(-0.33)}\cdot0.40&+\\[1em]
&+&\dfrac{(x+0.76)(x+0.09)(x-0.22)}{(1.31)(0.64)(0.33)}\cdot0.96&
\end{matrix}
\end{gather*}

или
\begin{gather*}
\begin{matrix}
L_{3}(x)=
&&\dfrac{(x+0.09)(x-0.22)(x-0.55)}{-0.86}\cdot0.08&+\\[1em]
&+&\dfrac{(x+0.76)(x-0.22)(x-0.55)}{0.13}\cdot1.84&+\\[1em]
&+&\dfrac{(x+0.76)(x+0.09)(x-0.55)}{-0.10}\cdot0.40&+\\[1em]
&+&\dfrac{(x+0.76)(x+0.09)(x-0.22)}{0.28}\cdot0.96&
\end{matrix}
\end{gather*}

Продолжая делать упрощения окончательно получим:
\begin{gather*}
\begin{matrix}
L_{3}(x)=
&&(x+0.09)(x-0.22)(x-0.55)\cdot(-0.09)&+\\
&+&(x+0.76)(x-0.22)(x-0.55)\cdot13.84&+\\
&+&(x+0.76)(x+0.09)(x-0.55)\cdot(-3.99)&+\\
&+&(x+0.76)(x+0.09)(x-0.22)\cdot3.47&
\end{matrix}
\end{gather*}

\item
Запишем выражение для интерполяционный полином Лагранжа
в каноническом виде:
\begin{gather*}
L_{3}(x)=1.36963 - 5.24831\cdot x + 0.9119\cdot x^2 + 13.23\cdot x^3
\end{gather*}

\item
На одном графике представим диаграмму рассеяния 
(разброса) данных функции заданной таблично $y_i=f(x_i)$
(маркеры) и результаты вычислений 
интерполяционного полинома Лагранжа $L_3(x)$
(сплошная линия).
% *******************************
%	График функций
%
\begin{figure}[H]\centering
\begin{tikzpicture}
\begin{axis}[% оси координат
ylabel=$L_3(x)$,
xmin=-0.9,xmax=0.7,xtick={-0.8,-0.4,0,0.4},
ymin=-1, ymax=3,
]
% табличные данные
\addplot[PlotDarkRed,only marks]
coordinates {(-0.76,0.08) (-0.09,1.84) (0.22,0.40) (0.55,0.96)};
% полином Лагранжа
\addplot[PlotDarkRed,mark=none,domain=-0.8:0.6,samples=100] 
{1.36963 - 5.24831*x + 0.9119*x^2 + 13.23*x^3}
node[pos=0.7,right] {$L_3(x)$};
\end{axis}
\end{tikzpicture}
\caption{График таблично заданной функции $y_i=f(x_i)$ (маркеры) 
и интерполяционного полинома Лагранжа $L_3(x)$
(сплошная линия)}
\end{figure}
% *******************************
\end{enumerate}

%\end{document}